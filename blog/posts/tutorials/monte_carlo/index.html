<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="chicken">
<meta name="dcterms.date" content="2026-01-27">
<meta name="description" content="Run monte carlo simulations using the expected goals model to predict the winners of today’s games">

<title>Simulating today’s hockey games – chickenstats-blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<link href="../../../../images/site/logos/favicon.png" rel="icon" type="image/png">
<script src="../../../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-4d9afe2b8d18ee9fa5d0d57b5ed4214d.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap-769e7323b9f7c7d06710148a90bb255c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../site_libs/bootstrap/bootstrap-dark-90d641dea7af9210e1bb0e057a1a81ed.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../../../site_libs/bootstrap/bootstrap-769e7323b9f7c7d06710148a90bb255c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="../../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-65XFF92N5R"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-65XFF92N5R', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"interstitial",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<meta property="og:title" content="Simulating today’s hockey games – chickenstats-blog">
<meta property="og:description" content="Run monte carlo simulations using the expected goals model to predict the winners of today’s games">
<meta property="og:image" content="https://blog.chickenstats.com/blog/posts/tutorials/monte_carlo/charts/2026-01-24_NSH.png">
<meta property="og:site_name" content="chickenstats-blog">
<meta property="og:image:height" content="3045">
<meta property="og:image:width" content="4160">
<meta name="twitter:title" content="Simulating today’s hockey games – chickenstats-blog">
<meta name="twitter:description" content="Run monte carlo simulations using the expected goals model to predict the winners of today’s games">
<meta name="twitter:image" content="https://blog.chickenstats.com/blog/posts/tutorials/monte_carlo/charts/2026-01-24_NSH.png">
<meta name="twitter:image-height" content="3045">
<meta name="twitter:image-width" content="4160">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-md " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">chickenstats-blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://chickenstats.com/"> 
<span class="menu-text">docs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../about.html"> 
<span class="menu-text">about</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../blog/index.html"> 
<span class="menu-text">blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../projects.html"> 
<span class="menu-text">projects</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/chickenandstats/chickenstats-blog"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro"><strong>Intro</strong></a></li>
  <li><a href="#housekeeping" id="toc-housekeeping" class="nav-link" data-scroll-target="#housekeeping"><strong>Housekeeping</strong></a>
  <ul class="collapse">
  <li><a href="#import-dependencies" id="toc-import-dependencies" class="nav-link" data-scroll-target="#import-dependencies">Import dependencies</a></li>
  <li><a href="#polars-options" id="toc-polars-options" class="nav-link" data-scroll-target="#polars-options">Polars options</a></li>
  <li><a href="#folder-structure" id="toc-folder-structure" class="nav-link" data-scroll-target="#folder-structure">Folder structure</a></li>
  <li><a href="#chickenstats-matplotlib-style" id="toc-chickenstats-matplotlib-style" class="nav-link" data-scroll-target="#chickenstats-matplotlib-style">Chickenstats matplotlib style</a></li>
  </ul></li>
  <li><a href="#scrape-data" id="toc-scrape-data" class="nav-link" data-scroll-target="#scrape-data"><strong>Scrape data</strong></a>
  <ul class="collapse">
  <li><a href="#schedule" id="toc-schedule" class="nav-link" data-scroll-target="#schedule">Schedule</a></li>
  <li><a href="#standings-and-team-names" id="toc-standings-and-team-names" class="nav-link" data-scroll-target="#standings-and-team-names">Standings and team names</a></li>
  <li><a href="#game-ids" id="toc-game-ids" class="nav-link" data-scroll-target="#game-ids">Game IDs</a></li>
  <li><a href="#latest-date" id="toc-latest-date" class="nav-link" data-scroll-target="#latest-date">Latest date</a></li>
  <li><a href="#checking-to-see-if-youve-already-scraped-the-data" id="toc-checking-to-see-if-youve-already-scraped-the-data" class="nav-link" data-scroll-target="#checking-to-see-if-youve-already-scraped-the-data">Checking to see if you’ve already scraped the data</a></li>
  <li><a href="#combine-scraped-and-saved-data" id="toc-combine-scraped-and-saved-data" class="nav-link" data-scroll-target="#combine-scraped-and-saved-data">Combine scraped and saved data</a></li>
  </ul></li>
  <li><a href="#munge-the-data" id="toc-munge-the-data" class="nav-link" data-scroll-target="#munge-the-data"><strong>Munge the data</strong></a>
  <ul class="collapse">
  <li><a href="#add-home-games-to-the-data-set" id="toc-add-home-games-to-the-data-set" class="nav-link" data-scroll-target="#add-home-games-to-the-data-set">Add Home games to the data set</a></li>
  <li><a href="#aggregate-strength-state" id="toc-aggregate-strength-state" class="nav-link" data-scroll-target="#aggregate-strength-state">Aggregate strength state</a></li>
  <li><a href="#prep-overall-nhl-stats" id="toc-prep-overall-nhl-stats" class="nav-link" data-scroll-target="#prep-overall-nhl-stats">Prep overall NHL stats</a></li>
  <li><a href="#prep-team-stats" id="toc-prep-team-stats" class="nav-link" data-scroll-target="#prep-team-stats">Prep team stats</a></li>
  <li><a href="#prep-todays-games" id="toc-prep-todays-games" class="nav-link" data-scroll-target="#prep-todays-games">Prep today’s games</a></li>
  </ul></li>
  <li><a href="#simulating-the-actual-games" id="toc-simulating-the-actual-games" class="nav-link" data-scroll-target="#simulating-the-actual-games">Simulating the actual games</a>
  <ul class="collapse">
  <li><a href="#random-float" id="toc-random-float" class="nav-link" data-scroll-target="#random-float">Random float</a></li>
  <li><a href="#simulating-an-individual-game" id="toc-simulating-an-individual-game" class="nav-link" data-scroll-target="#simulating-an-individual-game">Simulating an individual game</a></li>
  <li><a href="#predict-an-entire-game" id="toc-predict-an-entire-game" class="nav-link" data-scroll-target="#predict-an-entire-game">Predict an entire game</a></li>
  <li><a href="#simulating-multiple-games" id="toc-simulating-multiple-games" class="nav-link" data-scroll-target="#simulating-multiple-games">Simulating multiple games</a></li>
  </ul></li>
  <li><a href="#assessing-results" id="toc-assessing-results" class="nav-link" data-scroll-target="#assessing-results">Assessing results</a>
  <ul class="collapse">
  <li><a href="#process-winners" id="toc-process-winners" class="nav-link" data-scroll-target="#process-winners">Process winners</a></li>
  <li><a href="#assessing-predictions" id="toc-assessing-predictions" class="nav-link" data-scroll-target="#assessing-predictions">Assessing predictions</a></li>
  </ul></li>
  <li><a href="#charts" id="toc-charts" class="nav-link" data-scroll-target="#charts">Charts</a>
  <ul class="collapse">
  <li><a href="#color-dictionary" id="toc-color-dictionary" class="nav-link" data-scroll-target="#color-dictionary">Color dictionary</a></li>
  <li><a href="#plotting-a-single-game" id="toc-plotting-a-single-game" class="nav-link" data-scroll-target="#plotting-a-single-game">Plotting a single game</a></li>
  <li><a href="#plotting-todays-games" id="toc-plotting-todays-games" class="nav-link" data-scroll-target="#plotting-todays-games">Plotting today’s games</a></li>
  </ul></li>
  <li><a href="#assessing-predictions-1" id="toc-assessing-predictions-1" class="nav-link" data-scroll-target="#assessing-predictions-1">Assessing predictions</a>
  <ul class="collapse">
  <li><a href="#downloading-the-data-from-github" id="toc-downloading-the-data-from-github" class="nav-link" data-scroll-target="#downloading-the-data-from-github">Downloading the data from GitHub</a></li>
  </ul></li>
  <li><a href="#checking-the-results" id="toc-checking-the-results" class="nav-link" data-scroll-target="#checking-the-results">Checking the results</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Simulating today’s hockey games</h1>
  <div class="quarto-categories">
    <div class="quarto-category">tutorials</div>
  </div>
  </div>

<div>
  <div class="description">
    Run monte carlo simulations using the expected goals model to predict the winners of today’s games
  </div>
</div>


<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>chicken </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 27, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro"><strong>Intro</strong></h2>
<p>Use the <code>chickenstats</code> library to scrape play-by-play data, aggregate to the team level, then run monte carlo simulations to predict the winners of today’s games.</p>
<p>Parts of this tutorial are optional and will be clearly marked as such. For help, or any questions, please don’t hesitate to reach out to <a href="mailto:chicken@chickenandstats.com">chicken@chickenandstats.com</a> or <a href="https://bsky.app/profile/chickenandstats.com"><span class="citation" data-cites="chickenandstats.com">@chickenandstats.com</span></a> on Blue Sky.</p>
<hr>
<p><a href="./charts/2026-01-24_NSH.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="./charts/2026-01-24_NSH.png" class="img-fluid"></a></p>
<hr>
</section>
<section id="housekeeping" class="level2">
<h2 class="anchored" data-anchor-id="housekeeping"><strong>Housekeeping</strong></h2>
<section id="import-dependencies" class="level3">
<h3 class="anchored" data-anchor-id="import-dependencies">Import dependencies</h3>
<p>Import the dependencies we’ll need for the guide</p>
<div id="6f215692-ae9c-4e0b-85d5-578cfc5c78a2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> chickenstats.chicken_nhl <span class="im">import</span> Scraper, Season</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> chickenstats.chicken_nhl._helpers <span class="im">import</span> charts_directory</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> chickenstats.chicken_nhl.team <span class="im">import</span> NHL_COLORS</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> monte_carlo <span class="im">import</span> (</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    aggregate_strength_states,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    prep_nhl_stats,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    prep_team_stats,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    prep_todays_games,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    simulate_game,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    predict_game,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    predict_games,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    process_winners,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    assess_predictions,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="polars-options" class="level3">
<h3 class="anchored" data-anchor-id="polars-options">Polars options</h3>
<p>Set different polars options. This cell is optional</p>
<div id="dcfff26a-5c68-477a-a30a-93eec4b609e5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pl.Config.set_tbl_cols(<span class="op">-</span><span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>polars.config.Config</code></pre>
</div>
</div>
</section>
<section id="folder-structure" class="level3">
<h3 class="anchored" data-anchor-id="folder-structure">Folder structure</h3>
<div id="7b47ea99-e882-4900-9f63-f106d92b3957" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>charts_directory()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="chickenstats-matplotlib-style" class="level3">
<h3 class="anchored" data-anchor-id="chickenstats-matplotlib-style">Chickenstats matplotlib style</h3>
<p>chickenstats.utilities includes a custom style package - this activates it. This cell is also optional</p>
<div id="e31f505d-3205-45d2-af66-46c04b4ee717" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"chickenstats"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="scrape-data" class="level2">
<h2 class="anchored" data-anchor-id="scrape-data"><strong>Scrape data</strong></h2>
<section id="schedule" class="level3">
<h3 class="anchored" data-anchor-id="schedule">Schedule</h3>
<p>Scrape the schedule using the <code>Season</code> object</p>
<div id="1630dce0-ac8e-4505-8f85-38304c119534" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>season <span class="op">=</span> Season(<span class="dv">2025</span>, backend<span class="op">=</span><span class="st">"polars"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a7db15a6-ebab-4ec8-b108-afa8bae5ac1e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>schedule <span class="op">=</span> season.schedule()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9b6d48882e074531841c510d1068de30","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
</section>
<section id="standings-and-team-names" class="level3">
<h3 class="anchored" data-anchor-id="standings-and-team-names">Standings and team names</h3>
<p>Scrape the standings and create team name dictionaries to use later</p>
<div id="08540267-c5a8-4687-862c-534d50dcc1b1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>standings <span class="op">=</span> season.standings</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="28f2e82f-6cef-4c6a-a529-31a61e9f3221" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>standings.head(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 57)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">team</th>
<th data-quarto-table-cell-role="th">team_name</th>
<th data-quarto-table-cell-role="th">conference</th>
<th data-quarto-table-cell-role="th">division</th>
<th data-quarto-table-cell-role="th">games_played</th>
<th data-quarto-table-cell-role="th">points</th>
<th data-quarto-table-cell-role="th">points_pct</th>
<th data-quarto-table-cell-role="th">wins</th>
<th data-quarto-table-cell-role="th">regulation_wins</th>
<th data-quarto-table-cell-role="th">shootout_wins</th>
<th data-quarto-table-cell-role="th">losses</th>
<th data-quarto-table-cell-role="th">ot_losses</th>
<th data-quarto-table-cell-role="th">shootout_losses</th>
<th data-quarto-table-cell-role="th">ties</th>
<th data-quarto-table-cell-role="th">win_pct</th>
<th data-quarto-table-cell-role="th">regulation_win_pct</th>
<th data-quarto-table-cell-role="th">streak_code</th>
<th data-quarto-table-cell-role="th">streak_count</th>
<th data-quarto-table-cell-role="th">goals_for</th>
<th data-quarto-table-cell-role="th">goals_against</th>
<th data-quarto-table-cell-role="th">goals_for_pct</th>
<th data-quarto-table-cell-role="th">goal_differential</th>
<th data-quarto-table-cell-role="th">goal_differential_pct</th>
<th data-quarto-table-cell-role="th">home_games_played</th>
<th data-quarto-table-cell-role="th">home_points</th>
<th data-quarto-table-cell-role="th">home_goals_for</th>
<th data-quarto-table-cell-role="th">home_goals_against</th>
<th data-quarto-table-cell-role="th">home_goal_differential</th>
<th data-quarto-table-cell-role="th">home_wins</th>
<th data-quarto-table-cell-role="th">home_losses</th>
<th data-quarto-table-cell-role="th">home_ot_losses</th>
<th data-quarto-table-cell-role="th">home_ties</th>
<th data-quarto-table-cell-role="th">home_regulation_wins</th>
<th data-quarto-table-cell-role="th">road_games_played</th>
<th data-quarto-table-cell-role="th">road_points</th>
<th data-quarto-table-cell-role="th">road_goals_for</th>
<th data-quarto-table-cell-role="th">road_goals_against</th>
<th data-quarto-table-cell-role="th">road_goal_differential</th>
<th data-quarto-table-cell-role="th">road_wins</th>
<th data-quarto-table-cell-role="th">road_losses</th>
<th data-quarto-table-cell-role="th">road_ot_losses</th>
<th data-quarto-table-cell-role="th">road_ties</th>
<th data-quarto-table-cell-role="th">road_regulation_wins</th>
<th data-quarto-table-cell-role="th">l10_points</th>
<th data-quarto-table-cell-role="th">l10_goals_for</th>
<th data-quarto-table-cell-role="th">l10_goals_against</th>
<th data-quarto-table-cell-role="th">l10_goal_differential</th>
<th data-quarto-table-cell-role="th">l10_wins</th>
<th data-quarto-table-cell-role="th">l10_losses</th>
<th data-quarto-table-cell-role="th">l10_ot_losses</th>
<th data-quarto-table-cell-role="th">l10_ties</th>
<th data-quarto-table-cell-role="th">l10_regulation_wins</th>
<th data-quarto-table-cell-role="th">team_logo</th>
<th data-quarto-table-cell-role="th">wildcard_sequence</th>
<th data-quarto-table-cell-role="th">waivers_sequence</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>str</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>i64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>str</td>
<td>i64</td>
<td>i64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>20252026</td>
<td>"2026-02-05"</td>
<td>"COL"</td>
<td>"Colorado Avalanche"</td>
<td>"Western"</td>
<td>"Central"</td>
<td>55</td>
<td>83</td>
<td>0.754545</td>
<td>37</td>
<td>34</td>
<td>1</td>
<td>9</td>
<td>9</td>
<td>null</td>
<td>0</td>
<td>0.672727</td>
<td>0.618182</td>
<td>"W"</td>
<td>1</td>
<td>212</td>
<td>138</td>
<td>3.854545</td>
<td>74</td>
<td>1.345455</td>
<td>28</td>
<td>46</td>
<td>117</td>
<td>66</td>
<td>51</td>
<td>21</td>
<td>3</td>
<td>4</td>
<td>0</td>
<td>21</td>
<td>27</td>
<td>37</td>
<td>95</td>
<td>72</td>
<td>23</td>
<td>16</td>
<td>6</td>
<td>5</td>
<td>0</td>
<td>13</td>
<td>9</td>
<td>30</td>
<td>35</td>
<td>-5</td>
<td>4</td>
<td>5</td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>0</td>
<td>32</td>
</tr>
<tr class="even">
<td>20252026</td>
<td>"2026-02-05"</td>
<td>"CAR"</td>
<td>"Carolina Hurricanes"</td>
<td>"Eastern"</td>
<td>"Metropolitan"</td>
<td>57</td>
<td>78</td>
<td>0.684211</td>
<td>36</td>
<td>26</td>
<td>4</td>
<td>15</td>
<td>6</td>
<td>null</td>
<td>0</td>
<td>0.631579</td>
<td>0.45614</td>
<td>"W"</td>
<td>3</td>
<td>197</td>
<td>163</td>
<td>3.45614</td>
<td>34</td>
<td>0.596491</td>
<td>31</td>
<td>44</td>
<td>118</td>
<td>94</td>
<td>24</td>
<td>21</td>
<td>8</td>
<td>2</td>
<td>0</td>
<td>15</td>
<td>26</td>
<td>34</td>
<td>79</td>
<td>69</td>
<td>10</td>
<td>15</td>
<td>7</td>
<td>4</td>
<td>0</td>
<td>11</td>
<td>18</td>
<td>39</td>
<td>21</td>
<td>18</td>
<td>8</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>7</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>0</td>
<td>30</td>
</tr>
<tr class="odd">
<td>20252026</td>
<td>"2026-02-05"</td>
<td>"MIN"</td>
<td>"Minnesota Wild"</td>
<td>"Western"</td>
<td>"Central"</td>
<td>58</td>
<td>78</td>
<td>0.672414</td>
<td>34</td>
<td>21</td>
<td>4</td>
<td>14</td>
<td>10</td>
<td>null</td>
<td>0</td>
<td>0.586207</td>
<td>0.362069</td>
<td>"W"</td>
<td>5</td>
<td>196</td>
<td>169</td>
<td>3.37931</td>
<td>27</td>
<td>0.465517</td>
<td>30</td>
<td>41</td>
<td>97</td>
<td>91</td>
<td>6</td>
<td>17</td>
<td>6</td>
<td>7</td>
<td>0</td>
<td>9</td>
<td>28</td>
<td>37</td>
<td>99</td>
<td>78</td>
<td>21</td>
<td>17</td>
<td>8</td>
<td>3</td>
<td>0</td>
<td>12</td>
<td>17</td>
<td>46</td>
<td>33</td>
<td>13</td>
<td>8</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>0</td>
<td>28</td>
</tr>
<tr class="even">
<td>20252026</td>
<td>"2026-02-05"</td>
<td>"DAL"</td>
<td>"Dallas Stars"</td>
<td>"Western"</td>
<td>"Central"</td>
<td>57</td>
<td>77</td>
<td>0.675439</td>
<td>34</td>
<td>28</td>
<td>4</td>
<td>14</td>
<td>9</td>
<td>null</td>
<td>0</td>
<td>0.596491</td>
<td>0.491228</td>
<td>"W"</td>
<td>6</td>
<td>193</td>
<td>160</td>
<td>3.385965</td>
<td>33</td>
<td>0.578947</td>
<td>26</td>
<td>35</td>
<td>85</td>
<td>72</td>
<td>13</td>
<td>16</td>
<td>7</td>
<td>3</td>
<td>0</td>
<td>13</td>
<td>31</td>
<td>42</td>
<td>108</td>
<td>88</td>
<td>20</td>
<td>18</td>
<td>7</td>
<td>6</td>
<td>0</td>
<td>15</td>
<td>14</td>
<td>32</td>
<td>27</td>
<td>5</td>
<td>7</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>5</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>0</td>
<td>29</td>
</tr>
<tr class="odd">
<td>20252026</td>
<td>"2026-02-05"</td>
<td>"TBL"</td>
<td>"Tampa Bay Lightning"</td>
<td>"Eastern"</td>
<td>"Atlantic"</td>
<td>54</td>
<td>76</td>
<td>0.703704</td>
<td>36</td>
<td>27</td>
<td>4</td>
<td>14</td>
<td>4</td>
<td>null</td>
<td>0</td>
<td>0.666667</td>
<td>0.5</td>
<td>"W"</td>
<td>4</td>
<td>193</td>
<td>139</td>
<td>3.574074</td>
<td>54</td>
<td>1.0</td>
<td>26</td>
<td>34</td>
<td>85</td>
<td>70</td>
<td>15</td>
<td>17</td>
<td>9</td>
<td>0</td>
<td>0</td>
<td>11</td>
<td>28</td>
<td>42</td>
<td>108</td>
<td>69</td>
<td>39</td>
<td>19</td>
<td>5</td>
<td>4</td>
<td>0</td>
<td>16</td>
<td>17</td>
<td>35</td>
<td>24</td>
<td>11</td>
<td>8</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>0</td>
<td>31</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="c2a69376-83cb-4ea2-995b-3e8f78b22910" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>team_names <span class="op">=</span> standings.sort(by<span class="op">=</span><span class="st">"team_name"</span>)[<span class="st">"team_name"</span>].<span class="bu">str</span>.to_uppercase().to_list()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>team_codes <span class="op">=</span> standings.sort(by<span class="op">=</span><span class="st">"team_name"</span>)[<span class="st">"team"</span>].<span class="bu">str</span>.to_uppercase().to_list()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>team_names_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(team_codes, team_names, strict<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>home_teams <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(schedule[<span class="st">"game_id"</span>].to_list(), schedule[<span class="st">"home_team"</span>].to_list(), strict<span class="op">=</span><span class="va">False</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="game-ids" class="level3">
<h3 class="anchored" data-anchor-id="game-ids">Game IDs</h3>
<p>Create a list of game IDs to scrape</p>
<div id="53b7b4b3-e238-4c7e-952b-207675307e52" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>conds <span class="op">=</span> pl.col(<span class="st">"game_state"</span>) <span class="op">==</span> <span class="st">"OFF"</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>game_ids <span class="op">=</span> schedule.<span class="bu">filter</span>(conds)[<span class="st">"game_id"</span>].unique().to_list()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="latest-date" class="level3">
<h3 class="anchored" data-anchor-id="latest-date">Latest date</h3>
<p>Important! If you don’t set this, it will just pull from the last completed game</p>
<div id="e9e5dd48-3fd8-4cbb-bd77-0ec465fb613b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>conds <span class="op">=</span> pl.col(<span class="st">"game_state"</span>) <span class="op">==</span> <span class="st">"OFF"</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>dt_format <span class="op">=</span> <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>latest_date_dt <span class="op">=</span> schedule.<span class="bu">filter</span>(conds)[<span class="st">"game_date"</span>].<span class="bu">str</span>.to_datetime(<span class="bu">format</span><span class="op">=</span>dt_format).<span class="bu">max</span>()  <span class="co"># In YYYY-MM-DD format</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>latest_date <span class="op">=</span> latest_date_dt.strftime(dt_format)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>latest_date <span class="op">=</span> <span class="st">"2026-01-24"</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>latest_date_dt <span class="op">=</span> dt.date(year<span class="op">=</span><span class="bu">int</span>(latest_date[:<span class="dv">4</span>]), month<span class="op">=</span><span class="bu">int</span>(latest_date[<span class="dv">5</span>:<span class="dv">7</span>]), day<span class="op">=</span><span class="bu">int</span>(latest_date[<span class="dv">8</span>:<span class="dv">10</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="checking-to-see-if-youve-already-scraped-the-data" class="level3">
<h3 class="anchored" data-anchor-id="checking-to-see-if-youve-already-scraped-the-data">Checking to see if you’ve already scraped the data</h3>
<p>Check to see if you’ve already scraped, so you’re only getting the game_ids that you need</p>
<div id="b22d308f-b4ff-45d7-ae64-5f9a859e2099" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data_directory <span class="op">=</span> Path.cwd() <span class="op">/</span> <span class="st">"data"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>stats_file <span class="op">=</span> data_directory <span class="op">/</span> <span class="st">"team_stats.csv"</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> data_directory.exists():</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    data_directory.mkdir()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> stats_file.exists():</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    team_stats <span class="op">=</span> pl.read_csv(source<span class="op">=</span>stats_file, infer_schema_length<span class="op">=</span><span class="dv">2000</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    saved_game_ids <span class="op">=</span> team_stats[<span class="st">"game_id"</span>].to_list()</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    game_ids <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> game_ids <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> saved_game_ids]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b0ab6a3b-42c4-4e22-ae71-f24d7a716ad9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> game_ids:</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    scraper <span class="op">=</span> Scraper(game_ids, backend<span class="op">=</span><span class="st">"polars"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    pbp <span class="op">=</span> scraper.play_by_play</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    scraped_team_stats <span class="op">=</span> scraper.team_stats</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"641658d62a92440d8307ed527e253e5f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e70d18435319484788a13a3616df8c2a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
</section>
<section id="combine-scraped-and-saved-data" class="level3">
<h3 class="anchored" data-anchor-id="combine-scraped-and-saved-data">Combine scraped and saved data</h3>
<p>Combine the scraped data and the saved data, then save the new file, but only if there are game_ids</p>
<div id="c81fc305-c589-4d33-940c-53bb556ae8a9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> game_ids:</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    team_stats <span class="op">=</span> pl.concat(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        [team_stats.with_columns(pl.col(<span class="st">"bsf_adj_percent"</span>).cast(pl.Float64)), scraped_team_stats], strict<span class="op">=</span><span class="va">False</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># Quick, don't ask</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    team_stats.write_csv(stats_file)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a3ce7295-2cb0-4dfa-90e4-03e774209c49" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>team_stats.head(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 141)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">session</th>
<th data-quarto-table-cell-role="th">game_id</th>
<th data-quarto-table-cell-role="th">game_date</th>
<th data-quarto-table-cell-role="th">team</th>
<th data-quarto-table-cell-role="th">opp_team</th>
<th data-quarto-table-cell-role="th">strength_state</th>
<th data-quarto-table-cell-role="th">toi</th>
<th data-quarto-table-cell-role="th">gf</th>
<th data-quarto-table-cell-role="th">ga</th>
<th data-quarto-table-cell-role="th">gf_adj</th>
<th data-quarto-table-cell-role="th">ga_adj</th>
<th data-quarto-table-cell-role="th">hdgf</th>
<th data-quarto-table-cell-role="th">hdga</th>
<th data-quarto-table-cell-role="th">xgf</th>
<th data-quarto-table-cell-role="th">xga</th>
<th data-quarto-table-cell-role="th">xgf_adj</th>
<th data-quarto-table-cell-role="th">xga_adj</th>
<th data-quarto-table-cell-role="th">sf</th>
<th data-quarto-table-cell-role="th">sa</th>
<th data-quarto-table-cell-role="th">sf_adj</th>
<th data-quarto-table-cell-role="th">sa_adj</th>
<th data-quarto-table-cell-role="th">hdsf</th>
<th data-quarto-table-cell-role="th">hdsa</th>
<th data-quarto-table-cell-role="th">ff</th>
<th data-quarto-table-cell-role="th">fa</th>
<th data-quarto-table-cell-role="th">ff_adj</th>
<th data-quarto-table-cell-role="th">fa_adj</th>
<th data-quarto-table-cell-role="th">hdff</th>
<th data-quarto-table-cell-role="th">hdfa</th>
<th data-quarto-table-cell-role="th">cf</th>
<th data-quarto-table-cell-role="th">ca</th>
<th data-quarto-table-cell-role="th">cf_adj</th>
<th data-quarto-table-cell-role="th">ca_adj</th>
<th data-quarto-table-cell-role="th">bsf</th>
<th data-quarto-table-cell-role="th">bsa</th>
<th data-quarto-table-cell-role="th">bsf_adj</th>
<th data-quarto-table-cell-role="th">bsa_adj</th>
<th data-quarto-table-cell-role="th">msf</th>
<th data-quarto-table-cell-role="th">msa</th>
<th data-quarto-table-cell-role="th">msf_adj</th>
<th data-quarto-table-cell-role="th">msa_adj</th>
<th data-quarto-table-cell-role="th">hdmsf</th>
<th data-quarto-table-cell-role="th">hdmsa</th>
<th data-quarto-table-cell-role="th">teammate_block</th>
<th data-quarto-table-cell-role="th">hf</th>
<th data-quarto-table-cell-role="th">ht</th>
<th data-quarto-table-cell-role="th">give</th>
<th data-quarto-table-cell-role="th">take</th>
<th data-quarto-table-cell-role="th">ozf</th>
<th data-quarto-table-cell-role="th">nzf</th>
<th data-quarto-table-cell-role="th">dzf</th>
<th data-quarto-table-cell-role="th">fow</th>
<th data-quarto-table-cell-role="th">fol</th>
<th data-quarto-table-cell-role="th">ozfw</th>
<th data-quarto-table-cell-role="th">ozfl</th>
<th data-quarto-table-cell-role="th">nzfw</th>
<th data-quarto-table-cell-role="th">nzfl</th>
<th data-quarto-table-cell-role="th">dzfw</th>
<th data-quarto-table-cell-role="th">dzfl</th>
<th data-quarto-table-cell-role="th">pent0</th>
<th data-quarto-table-cell-role="th">pent2</th>
<th data-quarto-table-cell-role="th">pent4</th>
<th data-quarto-table-cell-role="th">pent5</th>
<th data-quarto-table-cell-role="th">pent10</th>
<th data-quarto-table-cell-role="th">pend0</th>
<th data-quarto-table-cell-role="th">pend2</th>
<th data-quarto-table-cell-role="th">pend4</th>
<th data-quarto-table-cell-role="th">pend5</th>
<th data-quarto-table-cell-role="th">pend10</th>
<th data-quarto-table-cell-role="th">gf_p60</th>
<th data-quarto-table-cell-role="th">ga_p60</th>
<th data-quarto-table-cell-role="th">gf_adj_p60</th>
<th data-quarto-table-cell-role="th">ga_adj_p60</th>
<th data-quarto-table-cell-role="th">hdgf_p60</th>
<th data-quarto-table-cell-role="th">hdga_p60</th>
<th data-quarto-table-cell-role="th">xgf_p60</th>
<th data-quarto-table-cell-role="th">xga_p60</th>
<th data-quarto-table-cell-role="th">xgf_adj_p60</th>
<th data-quarto-table-cell-role="th">xga_adj_p60</th>
<th data-quarto-table-cell-role="th">sf_p60</th>
<th data-quarto-table-cell-role="th">sa_p60</th>
<th data-quarto-table-cell-role="th">sf_adj_p60</th>
<th data-quarto-table-cell-role="th">sa_adj_p60</th>
<th data-quarto-table-cell-role="th">hdsf_p60</th>
<th data-quarto-table-cell-role="th">hdsa_p60</th>
<th data-quarto-table-cell-role="th">ff_p60</th>
<th data-quarto-table-cell-role="th">fa_p60</th>
<th data-quarto-table-cell-role="th">ff_adj_p60</th>
<th data-quarto-table-cell-role="th">fa_adj_p60</th>
<th data-quarto-table-cell-role="th">hdff_p60</th>
<th data-quarto-table-cell-role="th">hdfa_p60</th>
<th data-quarto-table-cell-role="th">cf_p60</th>
<th data-quarto-table-cell-role="th">ca_p60</th>
<th data-quarto-table-cell-role="th">cf_adj_p60</th>
<th data-quarto-table-cell-role="th">ca_adj_p60</th>
<th data-quarto-table-cell-role="th">bsf_p60</th>
<th data-quarto-table-cell-role="th">bsa_p60</th>
<th data-quarto-table-cell-role="th">bsf_adj_p60</th>
<th data-quarto-table-cell-role="th">bsa_adj_p60</th>
<th data-quarto-table-cell-role="th">msf_p60</th>
<th data-quarto-table-cell-role="th">msa_p60</th>
<th data-quarto-table-cell-role="th">msf_adj_p60</th>
<th data-quarto-table-cell-role="th">msa_adj_p60</th>
<th data-quarto-table-cell-role="th">hdmsf_p60</th>
<th data-quarto-table-cell-role="th">hdmsa_p60</th>
<th data-quarto-table-cell-role="th">teammate_block_p60</th>
<th data-quarto-table-cell-role="th">hf_p60</th>
<th data-quarto-table-cell-role="th">ht_p60</th>
<th data-quarto-table-cell-role="th">give_p60</th>
<th data-quarto-table-cell-role="th">take_p60</th>
<th data-quarto-table-cell-role="th">pent0_p60</th>
<th data-quarto-table-cell-role="th">pent2_p60</th>
<th data-quarto-table-cell-role="th">pent4_p60</th>
<th data-quarto-table-cell-role="th">pent5_p60</th>
<th data-quarto-table-cell-role="th">pent10_p60</th>
<th data-quarto-table-cell-role="th">pend0_p60</th>
<th data-quarto-table-cell-role="th">pend2_p60</th>
<th data-quarto-table-cell-role="th">pend4_p60</th>
<th data-quarto-table-cell-role="th">pend5_p60</th>
<th data-quarto-table-cell-role="th">pend10_p60</th>
<th data-quarto-table-cell-role="th">gf_percent</th>
<th data-quarto-table-cell-role="th">gf_adj_percent</th>
<th data-quarto-table-cell-role="th">hdgf_percent</th>
<th data-quarto-table-cell-role="th">xgf_percent</th>
<th data-quarto-table-cell-role="th">xgf_adj_percent</th>
<th data-quarto-table-cell-role="th">sf_percent</th>
<th data-quarto-table-cell-role="th">sf_adj_percent</th>
<th data-quarto-table-cell-role="th">hdsf_percent</th>
<th data-quarto-table-cell-role="th">ff_percent</th>
<th data-quarto-table-cell-role="th">ff_adj_percent</th>
<th data-quarto-table-cell-role="th">hdff_percent</th>
<th data-quarto-table-cell-role="th">cf_percent</th>
<th data-quarto-table-cell-role="th">cf_adj_percent</th>
<th data-quarto-table-cell-role="th">bsf_percent</th>
<th data-quarto-table-cell-role="th">bsf_adj_percent</th>
<th data-quarto-table-cell-role="th">msf_percent</th>
<th data-quarto-table-cell-role="th">msf_adj_percent</th>
<th data-quarto-table-cell-role="th">hdmsf_percent</th>
<th data-quarto-table-cell-role="th">hf_percent</th>
<th data-quarto-table-cell-role="th">take_percent</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>i64</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>20252026</td>
<td>"R"</td>
<td>2025020813</td>
<td>"2026-01-24"</td>
<td>"CAR"</td>
<td>"OTT"</td>
<td>"5v4"</td>
<td>5.5</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.266756</td>
<td>0.175814</td>
<td>0.311799</td>
<td>0.153621</td>
<td>1</td>
<td>1</td>
<td>1.200956</td>
<td>1.200956</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>1.205802</td>
<td>2.411605</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>1.205802</td>
<td>2.411605</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>1</td>
<td>0.0</td>
<td>0.854207</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>0</td>
<td>5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.910065</td>
<td>1.917967</td>
<td>3.40144</td>
<td>1.67587</td>
<td>10.909091</td>
<td>10.909091</td>
<td>13.101342</td>
<td>13.101342</td>
<td>10.909091</td>
<td>0.0</td>
<td>10.909091</td>
<td>21.818182</td>
<td>13.154208</td>
<td>26.308416</td>
<td>10.909091</td>
<td>0.0</td>
<td>10.909091</td>
<td>21.818182</td>
<td>13.154208</td>
<td>26.308416</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>10.909091</td>
<td>0.0</td>
<td>9.31862</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>10.909091</td>
<td>0.0</td>
<td>10.909091</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>10.909091</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.602743</td>
<td>0.66993</td>
<td>0.5</td>
<td>0.5</td>
<td>1.0</td>
<td>0.333333</td>
<td>0.333333</td>
<td>1.0</td>
<td>0.333333</td>
<td>0.333333</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>NaN</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>20252026</td>
<td>"R"</td>
<td>2025020103</td>
<td>"2025-10-21"</td>
<td>"FLA"</td>
<td>"BOS"</td>
<td>"4v5"</td>
<td>9.3</td>
<td>0</td>
<td>1</td>
<td>0.0</td>
<td>0.868644</td>
<td>0</td>
<td>1</td>
<td>0.337972</td>
<td>0.40907</td>
<td>0.388038</td>
<td>0.357434</td>
<td>2</td>
<td>3</td>
<td>1.78708</td>
<td>2.569967</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>6</td>
<td>2.6342</td>
<td>5.125241</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>9</td>
<td>2.6342</td>
<td>5.125241</td>
<td>0</td>
<td>3</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>3</td>
<td>1.205802</td>
<td>2.56262</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>5</td>
<td>1</td>
<td>3</td>
<td>3</td>
<td>6</td>
<td>0</td>
<td>5</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>6.451613</td>
<td>0.0</td>
<td>5.604155</td>
<td>0.0</td>
<td>6.451613</td>
<td>2.180462</td>
<td>2.639159</td>
<td>2.503471</td>
<td>2.306027</td>
<td>12.903226</td>
<td>19.354839</td>
<td>11.529549</td>
<td>16.580431</td>
<td>0.0</td>
<td>6.451613</td>
<td>19.354839</td>
<td>38.709677</td>
<td>16.994839</td>
<td>33.066069</td>
<td>0.0</td>
<td>12.903226</td>
<td>19.354839</td>
<td>58.064516</td>
<td>16.994839</td>
<td>33.066069</td>
<td>0.0</td>
<td>19.354839</td>
<td>0.0</td>
<td>0.0</td>
<td>6.451613</td>
<td>19.354839</td>
<td>7.77937</td>
<td>16.533035</td>
<td>0.0</td>
<td>6.451613</td>
<td>0.0</td>
<td>19.354839</td>
<td>6.451613</td>
<td>6.451613</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.452414</td>
<td>0.520526</td>
<td>0.4</td>
<td>0.410159</td>
<td>0.0</td>
<td>0.333333</td>
<td>0.339483</td>
<td>0.0</td>
<td>0.25</td>
<td>0.339483</td>
<td>0.0</td>
<td>NaN</td>
<td>0.25</td>
<td>0.319975</td>
<td>0.0</td>
<td>0.75</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>20252026</td>
<td>"R"</td>
<td>2025020849</td>
<td>"2026-01-29"</td>
<td>"NYR"</td>
<td>"NYI"</td>
<td>"5v4"</td>
<td>5.366667</td>
<td>1</td>
<td>0</td>
<td>0.868644</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.217852</td>
<td>0.0</td>
<td>0.190353</td>
<td>0.0</td>
<td>2</td>
<td>0</td>
<td>1.713311</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1.708414</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>1.708414</td>
<td>0.0</td>
<td>2</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>4</td>
<td>3</td>
<td>4</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>11.180124</td>
<td>0.0</td>
<td>9.711549</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.435613</td>
<td>0.0</td>
<td>2.128175</td>
<td>0.0</td>
<td>22.360248</td>
<td>0.0</td>
<td>19.155032</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>22.360248</td>
<td>0.0</td>
<td>19.100276</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>44.720497</td>
<td>0.0</td>
<td>19.100276</td>
<td>0.0</td>
<td>22.360248</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>33.540373</td>
<td>22.360248</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>NaN</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>NaN</td>
<td>1.0</td>
<td>1.0</td>
<td>NaN</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>20252026</td>
<td>"R"</td>
<td>2025020247</td>
<td>"2025-11-09"</td>
<td>"OTT"</td>
<td>"UTA"</td>
<td>"5vE"</td>
<td>2.766667</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.594731</td>
<td>0.609058</td>
<td>0.594731</td>
<td>0.609058</td>
<td>0</td>
<td>4</td>
<td>0.0</td>
<td>4.0</td>
<td>0</td>
<td>3</td>
<td>1</td>
<td>8</td>
<td>1.0</td>
<td>8.0</td>
<td>0</td>
<td>3</td>
<td>2</td>
<td>9</td>
<td>1.0</td>
<td>8.0</td>
<td>1</td>
<td>1</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>4</td>
<td>1.0</td>
<td>4.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>12.897772</td>
<td>13.208493</td>
<td>12.897772</td>
<td>13.208493</td>
<td>0.0</td>
<td>86.746988</td>
<td>0.0</td>
<td>86.746988</td>
<td>0.0</td>
<td>65.060241</td>
<td>21.686747</td>
<td>173.493976</td>
<td>21.686747</td>
<td>173.493976</td>
<td>0.0</td>
<td>65.060241</td>
<td>43.373494</td>
<td>195.180723</td>
<td>21.686747</td>
<td>173.493976</td>
<td>21.686747</td>
<td>21.686747</td>
<td>0.0</td>
<td>0.0</td>
<td>21.686747</td>
<td>86.746988</td>
<td>21.686747</td>
<td>86.746988</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>21.686747</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.494049</td>
<td>0.494049</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.111111</td>
<td>0.111111</td>
<td>0.0</td>
<td>0.181818</td>
<td>0.111111</td>
<td>0.5</td>
<td>NaN</td>
<td>0.2</td>
<td>0.2</td>
<td>NaN</td>
<td>0.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td>20252026</td>
<td>"R"</td>
<td>2025020092</td>
<td>"2025-10-19"</td>
<td>"UTA"</td>
<td>"BOS"</td>
<td>"5vE"</td>
<td>1.183333</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>0.0</td>
<td>0.0</td>
<td>2</td>
<td>1</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>101.408451</td>
<td>50.704225</td>
<td>0.0</td>
<td>0.0</td>
<td>101.408451</td>
<td>50.704225</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>50.704225</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.666667</td>
<td>NaN</td>
<td>0.666667</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="munge-the-data" class="level2">
<h2 class="anchored" data-anchor-id="munge-the-data"><strong>Munge the data</strong></h2>
<p>Cleaning the data and prepping for analysis</p>
<section id="add-home-games-to-the-data-set" class="level3">
<h3 class="anchored" data-anchor-id="add-home-games-to-the-data-set">Add Home games to the data set</h3>
<p>Check to see if team is the home team, adding a dummy column</p>
<div id="4e762530-a9bd-4576-a893-513c4e78add4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>home_map <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(schedule[<span class="st">"game_id"</span>], schedule[<span class="st">"home_team"</span>], strict<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>team_stats <span class="op">=</span> team_stats.with_columns(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    is_home<span class="op">=</span>pl.when(pl.col(<span class="st">"game_id"</span>).replace_strict(home_map, return_dtype<span class="op">=</span><span class="bu">str</span>) <span class="op">==</span> pl.col(<span class="st">"team"</span>))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    .then(pl.lit(<span class="dv">1</span>))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    .otherwise(pl.lit(<span class="dv">0</span>))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="aggregate-strength-state" class="level3">
<h3 class="anchored" data-anchor-id="aggregate-strength-state">Aggregate strength state</h3>
<p>Add a column to aggregate strength states (e.g., powerplay for 5v4, 5v3, and 4v3)</p>
<div id="5efb48b3-445e-4446-9329-8d4e624508a1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>team_stats <span class="op">=</span> aggregate_strength_states(team_stats)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="prep-overall-nhl-stats" class="level3">
<h3 class="anchored" data-anchor-id="prep-overall-nhl-stats">Prep overall NHL stats</h3>
<p>Function to calculate the goals scored and allowed above the expected goals model, at the overall NHL season level, adjusted for score and venue</p>
<div id="6e4c350d-5ac1-4e07-a519-4ea58124020a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>nhl_stats <span class="op">=</span> prep_nhl_stats(team_stats)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b3ddc4ce-189a-4a1c-b3d8-c2cbbcccb579" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>nhl_stats.head(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 81)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">session</th>
<th data-quarto-table-cell-role="th">is_home</th>
<th data-quarto-table-cell-role="th">strength_state2</th>
<th data-quarto-table-cell-role="th">toi</th>
<th data-quarto-table-cell-role="th">gf</th>
<th data-quarto-table-cell-role="th">ga</th>
<th data-quarto-table-cell-role="th">gf_adj</th>
<th data-quarto-table-cell-role="th">ga_adj</th>
<th data-quarto-table-cell-role="th">hdgf</th>
<th data-quarto-table-cell-role="th">hdga</th>
<th data-quarto-table-cell-role="th">xgf</th>
<th data-quarto-table-cell-role="th">xga</th>
<th data-quarto-table-cell-role="th">xgf_adj</th>
<th data-quarto-table-cell-role="th">xga_adj</th>
<th data-quarto-table-cell-role="th">sf</th>
<th data-quarto-table-cell-role="th">sa</th>
<th data-quarto-table-cell-role="th">sf_adj</th>
<th data-quarto-table-cell-role="th">sa_adj</th>
<th data-quarto-table-cell-role="th">hdsf</th>
<th data-quarto-table-cell-role="th">hdsa</th>
<th data-quarto-table-cell-role="th">ff</th>
<th data-quarto-table-cell-role="th">fa</th>
<th data-quarto-table-cell-role="th">ff_adj</th>
<th data-quarto-table-cell-role="th">fa_adj</th>
<th data-quarto-table-cell-role="th">hdff</th>
<th data-quarto-table-cell-role="th">hdfa</th>
<th data-quarto-table-cell-role="th">cf</th>
<th data-quarto-table-cell-role="th">ca</th>
<th data-quarto-table-cell-role="th">cf_adj</th>
<th data-quarto-table-cell-role="th">ca_adj</th>
<th data-quarto-table-cell-role="th">bsf</th>
<th data-quarto-table-cell-role="th">bsa</th>
<th data-quarto-table-cell-role="th">bsf_adj</th>
<th data-quarto-table-cell-role="th">bsa_adj</th>
<th data-quarto-table-cell-role="th">msf</th>
<th data-quarto-table-cell-role="th">msa</th>
<th data-quarto-table-cell-role="th">msf_adj</th>
<th data-quarto-table-cell-role="th">msa_adj</th>
<th data-quarto-table-cell-role="th">hdmsf</th>
<th data-quarto-table-cell-role="th">hdmsa</th>
<th data-quarto-table-cell-role="th">teammate_block</th>
<th data-quarto-table-cell-role="th">hf</th>
<th data-quarto-table-cell-role="th">ht</th>
<th data-quarto-table-cell-role="th">give</th>
<th data-quarto-table-cell-role="th">take</th>
<th data-quarto-table-cell-role="th">ozf</th>
<th data-quarto-table-cell-role="th">nzf</th>
<th data-quarto-table-cell-role="th">dzf</th>
<th data-quarto-table-cell-role="th">fow</th>
<th data-quarto-table-cell-role="th">fol</th>
<th data-quarto-table-cell-role="th">ozfw</th>
<th data-quarto-table-cell-role="th">ozfl</th>
<th data-quarto-table-cell-role="th">nzfw</th>
<th data-quarto-table-cell-role="th">nzfl</th>
<th data-quarto-table-cell-role="th">dzfw</th>
<th data-quarto-table-cell-role="th">dzfl</th>
<th data-quarto-table-cell-role="th">pent0</th>
<th data-quarto-table-cell-role="th">pent2</th>
<th data-quarto-table-cell-role="th">pent4</th>
<th data-quarto-table-cell-role="th">pent5</th>
<th data-quarto-table-cell-role="th">pent10</th>
<th data-quarto-table-cell-role="th">pend0</th>
<th data-quarto-table-cell-role="th">pend2</th>
<th data-quarto-table-cell-role="th">pend4</th>
<th data-quarto-table-cell-role="th">pend5</th>
<th data-quarto-table-cell-role="th">pend10</th>
<th data-quarto-table-cell-role="th">game_id</th>
<th data-quarto-table-cell-role="th">g_score_ax</th>
<th data-quarto-table-cell-role="th">g_save_ax</th>
<th data-quarto-table-cell-role="th">toi_gp</th>
<th data-quarto-table-cell-role="th">gf_p60</th>
<th data-quarto-table-cell-role="th">ga_p60</th>
<th data-quarto-table-cell-role="th">gf_adj_p60</th>
<th data-quarto-table-cell-role="th">ga_adj_p60</th>
<th data-quarto-table-cell-role="th">xgf_p60</th>
<th data-quarto-table-cell-role="th">xga_p60</th>
<th data-quarto-table-cell-role="th">xgf_adj_p60</th>
<th data-quarto-table-cell-role="th">xga_adj_p60</th>
<th data-quarto-table-cell-role="th">g_score_ax_p60</th>
<th data-quarto-table-cell-role="th">g_save_ax_p60</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>i32</td>
<td>str</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>u32</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>20252026</td>
<td>"R"</td>
<td>0</td>
<td>"Ev5"</td>
<td>536.35</td>
<td>57</td>
<td>166</td>
<td>57.0</td>
<td>166.0</td>
<td>20</td>
<td>37</td>
<td>69.020614</td>
<td>179.961909</td>
<td>69.020614</td>
<td>179.961909</td>
<td>494</td>
<td>166</td>
<td>494.0</td>
<td>166.0</td>
<td>159</td>
<td>37</td>
<td>794</td>
<td>307</td>
<td>794.0</td>
<td>306.0</td>
<td>228</td>
<td>37</td>
<td>1150</td>
<td>418</td>
<td>794.0</td>
<td>306.0</td>
<td>318</td>
<td>111</td>
<td>0.0</td>
<td>0.0</td>
<td>300</td>
<td>141</td>
<td>300.0</td>
<td>140.0</td>
<td>69</td>
<td>0</td>
<td>38</td>
<td>67</td>
<td>94</td>
<td>109</td>
<td>24</td>
<td>262</td>
<td>29</td>
<td>211</td>
<td>274</td>
<td>228</td>
<td>262</td>
<td>0</td>
<td>12</td>
<td>17</td>
<td>0</td>
<td>211</td>
<td>0</td>
<td>23</td>
<td>0</td>
<td>3</td>
<td>6</td>
<td>0</td>
<td>332</td>
<td>4</td>
<td>2</td>
<td>2</td>
<td>483</td>
<td>-12.020614</td>
<td>13.961909</td>
<td>1.110455</td>
<td>6.376433</td>
<td>18.569964</td>
<td>6.376433</td>
<td>18.569964</td>
<td>7.721146</td>
<td>20.131844</td>
<td>7.721146</td>
<td>20.131844</td>
<td>-1.344713</td>
<td>1.56188</td>
</tr>
<tr class="even">
<td>20252026</td>
<td>"R"</td>
<td>0</td>
<td>"3vE"</td>
<td>2.5</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>1.110907</td>
<td>0.0</td>
<td>1.110907</td>
<td>0</td>
<td>6</td>
<td>0.0</td>
<td>6.0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>8</td>
<td>0.0</td>
<td>8.0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>9</td>
<td>0.0</td>
<td>8.0</td>
<td>0</td>
<td>1</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>2</td>
<td>0.0</td>
<td>2.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>9</td>
<td>0.0</td>
<td>1.110907</td>
<td>0.277778</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>26.661775</td>
<td>0.0</td>
<td>26.661775</td>
<td>0.0</td>
<td>26.661775</td>
</tr>
<tr class="odd">
<td>20252026</td>
<td>"R"</td>
<td>0</td>
<td>"Ev4"</td>
<td>40.0</td>
<td>9</td>
<td>10</td>
<td>9.0</td>
<td>10.0</td>
<td>3</td>
<td>2</td>
<td>8.10169</td>
<td>7.612753</td>
<td>8.10169</td>
<td>7.612753</td>
<td>45</td>
<td>10</td>
<td>45.0</td>
<td>10.0</td>
<td>7</td>
<td>2</td>
<td>78</td>
<td>15</td>
<td>78.0</td>
<td>15.0</td>
<td>12</td>
<td>2</td>
<td>111</td>
<td>22</td>
<td>78.0</td>
<td>15.0</td>
<td>28</td>
<td>7</td>
<td>0.0</td>
<td>0.0</td>
<td>33</td>
<td>5</td>
<td>33.0</td>
<td>5.0</td>
<td>5</td>
<td>0</td>
<td>5</td>
<td>1</td>
<td>4</td>
<td>5</td>
<td>2</td>
<td>34</td>
<td>1</td>
<td>13</td>
<td>34</td>
<td>14</td>
<td>34</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>13</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>8</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>53</td>
<td>0.89831</td>
<td>-2.387247</td>
<td>0.754717</td>
<td>13.5</td>
<td>15.0</td>
<td>13.5</td>
<td>15.0</td>
<td>12.152535</td>
<td>11.419129</td>
<td>12.152535</td>
<td>11.419129</td>
<td>1.347465</td>
<td>-3.580871</td>
</tr>
<tr class="even">
<td>20252026</td>
<td>"R"</td>
<td>0</td>
<td>"powerplay"</td>
<td>4105.033333</td>
<td>514</td>
<td>49</td>
<td>555.923431</td>
<td>51.608182</td>
<td>222</td>
<td>26</td>
<td>632.442075</td>
<td>50.900359</td>
<td>685.593593</td>
<td>47.745515</td>
<td>3541</td>
<td>625</td>
<td>3757.638052</td>
<td>659.030873</td>
<td>1103</td>
<td>119</td>
<td>5362</td>
<td>793</td>
<td>5728.852631</td>
<td>842.420465</td>
<td>1592</td>
<td>150</td>
<td>6988</td>
<td>891</td>
<td>5728.852631</td>
<td>842.420465</td>
<td>1463</td>
<td>98</td>
<td>0.0</td>
<td>0.0</td>
<td>1821</td>
<td>168</td>
<td>1945.086182</td>
<td>158.628621</td>
<td>489</td>
<td>31</td>
<td>163</td>
<td>179</td>
<td>517</td>
<td>823</td>
<td>174</td>
<td>1943</td>
<td>624</td>
<td>1732</td>
<td>2334</td>
<td>1965</td>
<td>1888</td>
<td>55</td>
<td>347</td>
<td>277</td>
<td>99</td>
<td>1633</td>
<td>4</td>
<td>154</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>87</td>
<td>4</td>
<td>2</td>
<td>1</td>
<td>883</td>
<td>-129.670162</td>
<td>-3.862667</td>
<td>4.648962</td>
<td>7.512728</td>
<td>0.716194</td>
<td>8.12549</td>
<td>0.754316</td>
<td>9.243902</td>
<td>0.74397</td>
<td>10.020775</td>
<td>0.697858</td>
<td>-1.895285</td>
<td>-0.056458</td>
</tr>
<tr class="odd">
<td>20252026</td>
<td>"R"</td>
<td>1</td>
<td>"ILLEGAL"</td>
<td>1.9</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>2</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>19</td>
<td>0.0</td>
<td>0.0</td>
<td>0.1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="prep-team-stats" class="level3">
<h3 class="anchored" data-anchor-id="prep-team-stats">Prep team stats</h3>
<p>Function to prep and aggregate team stats to match up with the schedule for predicting the game’s values</p>
<div id="fa825c8d-04c1-4516-95c0-475cc26a22b1" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>team_stats_agg <span class="op">=</span> prep_team_stats(team_stats<span class="op">=</span>team_stats, nhl_stats<span class="op">=</span>nhl_stats, latest_date<span class="op">=</span>latest_date)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="0efe8d9e-55a2-45c2-8c05-c6aae7a014eb" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>team_stats_agg.head(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 98)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">session</th>
<th data-quarto-table-cell-role="th">team</th>
<th data-quarto-table-cell-role="th">is_home</th>
<th data-quarto-table-cell-role="th">strength_state2</th>
<th data-quarto-table-cell-role="th">toi</th>
<th data-quarto-table-cell-role="th">gf</th>
<th data-quarto-table-cell-role="th">ga</th>
<th data-quarto-table-cell-role="th">gf_adj</th>
<th data-quarto-table-cell-role="th">ga_adj</th>
<th data-quarto-table-cell-role="th">hdgf</th>
<th data-quarto-table-cell-role="th">hdga</th>
<th data-quarto-table-cell-role="th">xgf</th>
<th data-quarto-table-cell-role="th">xga</th>
<th data-quarto-table-cell-role="th">xgf_adj</th>
<th data-quarto-table-cell-role="th">xga_adj</th>
<th data-quarto-table-cell-role="th">sf</th>
<th data-quarto-table-cell-role="th">sa</th>
<th data-quarto-table-cell-role="th">sf_adj</th>
<th data-quarto-table-cell-role="th">sa_adj</th>
<th data-quarto-table-cell-role="th">hdsf</th>
<th data-quarto-table-cell-role="th">hdsa</th>
<th data-quarto-table-cell-role="th">ff</th>
<th data-quarto-table-cell-role="th">fa</th>
<th data-quarto-table-cell-role="th">ff_adj</th>
<th data-quarto-table-cell-role="th">fa_adj</th>
<th data-quarto-table-cell-role="th">hdff</th>
<th data-quarto-table-cell-role="th">hdfa</th>
<th data-quarto-table-cell-role="th">cf</th>
<th data-quarto-table-cell-role="th">ca</th>
<th data-quarto-table-cell-role="th">cf_adj</th>
<th data-quarto-table-cell-role="th">ca_adj</th>
<th data-quarto-table-cell-role="th">bsf</th>
<th data-quarto-table-cell-role="th">bsa</th>
<th data-quarto-table-cell-role="th">bsf_adj</th>
<th data-quarto-table-cell-role="th">bsa_adj</th>
<th data-quarto-table-cell-role="th">msf</th>
<th data-quarto-table-cell-role="th">msa</th>
<th data-quarto-table-cell-role="th">msf_adj</th>
<th data-quarto-table-cell-role="th">msa_adj</th>
<th data-quarto-table-cell-role="th">hdmsf</th>
<th data-quarto-table-cell-role="th">hdmsa</th>
<th data-quarto-table-cell-role="th">teammate_block</th>
<th data-quarto-table-cell-role="th">hf</th>
<th data-quarto-table-cell-role="th">ht</th>
<th data-quarto-table-cell-role="th">give</th>
<th data-quarto-table-cell-role="th">take</th>
<th data-quarto-table-cell-role="th">ozf</th>
<th data-quarto-table-cell-role="th">nzf</th>
<th data-quarto-table-cell-role="th">dzf</th>
<th data-quarto-table-cell-role="th">fow</th>
<th data-quarto-table-cell-role="th">fol</th>
<th data-quarto-table-cell-role="th">ozfw</th>
<th data-quarto-table-cell-role="th">ozfl</th>
<th data-quarto-table-cell-role="th">nzfw</th>
<th data-quarto-table-cell-role="th">nzfl</th>
<th data-quarto-table-cell-role="th">dzfw</th>
<th data-quarto-table-cell-role="th">dzfl</th>
<th data-quarto-table-cell-role="th">pent0</th>
<th data-quarto-table-cell-role="th">pent2</th>
<th data-quarto-table-cell-role="th">pent4</th>
<th data-quarto-table-cell-role="th">pent5</th>
<th data-quarto-table-cell-role="th">pent10</th>
<th data-quarto-table-cell-role="th">pend0</th>
<th data-quarto-table-cell-role="th">pend2</th>
<th data-quarto-table-cell-role="th">pend4</th>
<th data-quarto-table-cell-role="th">pend5</th>
<th data-quarto-table-cell-role="th">pend10</th>
<th data-quarto-table-cell-role="th">game_id</th>
<th data-quarto-table-cell-role="th">g_score_ax</th>
<th data-quarto-table-cell-role="th">g_save_ax</th>
<th data-quarto-table-cell-role="th">toi_gp</th>
<th data-quarto-table-cell-role="th">gf_p60</th>
<th data-quarto-table-cell-role="th">ga_p60</th>
<th data-quarto-table-cell-role="th">gf_adj_p60</th>
<th data-quarto-table-cell-role="th">ga_adj_p60</th>
<th data-quarto-table-cell-role="th">xgf_p60</th>
<th data-quarto-table-cell-role="th">xga_p60</th>
<th data-quarto-table-cell-role="th">xgf_adj_p60</th>
<th data-quarto-table-cell-role="th">xga_adj_p60</th>
<th data-quarto-table-cell-role="th">g_score_ax_p60</th>
<th data-quarto-table-cell-role="th">g_save_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_xgf_p60</th>
<th data-quarto-table-cell-role="th">mean_xga_p60</th>
<th data-quarto-table-cell-role="th">mean_xgf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_xga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_gf_p60</th>
<th data-quarto-table-cell-role="th">mean_ga_p60</th>
<th data-quarto-table-cell-role="th">mean_gf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_ga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_g_score_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_g_save_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_toi_gp</th>
<th data-quarto-table-cell-role="th">off_strength</th>
<th data-quarto-table-cell-role="th">def_strength</th>
<th data-quarto-table-cell-role="th">toi_comparison</th>
<th data-quarto-table-cell-role="th">scoring_strength</th>
<th data-quarto-table-cell-role="th">goalie_strength</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>str</td>
<td>i32</td>
<td>str</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>u32</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>20252026</td>
<td>"R"</td>
<td>"CBJ"</td>
<td>1</td>
<td>"4vE"</td>
<td>0.866667</td>
<td>1</td>
<td>0</td>
<td>1.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.61581</td>
<td>0.049193</td>
<td>0.61581</td>
<td>0.049193</td>
<td>1</td>
<td>1</td>
<td>1.0</td>
<td>1.0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1.0</td>
<td>1.0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1.0</td>
<td>1.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0.38419</td>
<td>0.049193</td>
<td>0.866667</td>
<td>69.230769</td>
<td>0.0</td>
<td>69.230769</td>
<td>0.0</td>
<td>42.63297</td>
<td>3.405685</td>
<td>42.63297</td>
<td>3.405685</td>
<td>26.5978</td>
<td>3.405685</td>
<td>11.419129</td>
<td>12.152535</td>
<td>11.419129</td>
<td>12.152535</td>
<td>15.0</td>
<td>13.5</td>
<td>15.0</td>
<td>13.5</td>
<td>3.580871</td>
<td>-1.347465</td>
<td>0.754717</td>
<td>3.733469</td>
<td>0.280245</td>
<td>1.148333</td>
<td>7.427746</td>
<td>-2.527476</td>
</tr>
<tr class="even">
<td>20252026</td>
<td>"R"</td>
<td>"NSH"</td>
<td>1</td>
<td>"4vE"</td>
<td>1.766667</td>
<td>0</td>
<td>1</td>
<td>0.0</td>
<td>1.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.13276</td>
<td>0.0</td>
<td>0.13276</td>
<td>0</td>
<td>2</td>
<td>0.0</td>
<td>2.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>0.0</td>
<td>4.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>0.0</td>
<td>4.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>2</td>
<td>0.0</td>
<td>2.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0.0</td>
<td>-0.86724</td>
<td>0.883333</td>
<td>0.0</td>
<td>33.962264</td>
<td>0.0</td>
<td>33.962264</td>
<td>0.0</td>
<td>4.508823</td>
<td>0.0</td>
<td>4.508823</td>
<td>0.0</td>
<td>-29.453441</td>
<td>11.419129</td>
<td>12.152535</td>
<td>11.419129</td>
<td>12.152535</td>
<td>15.0</td>
<td>13.5</td>
<td>15.0</td>
<td>13.5</td>
<td>3.580871</td>
<td>-1.347465</td>
<td>0.754717</td>
<td>0.0</td>
<td>0.371019</td>
<td>1.170417</td>
<td>0.0</td>
<td>21.858415</td>
</tr>
<tr class="odd">
<td>20252026</td>
<td>"R"</td>
<td>"DAL"</td>
<td>0</td>
<td>"ILLEGAL"</td>
<td>0.383333</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.127778</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.1</td>
<td>NaN</td>
<td>NaN</td>
<td>1.277778</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td>20252026</td>
<td>"R"</td>
<td>"PHI"</td>
<td>0</td>
<td>"ILLEGAL"</td>
<td>0.083333</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.083333</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.1</td>
<td>NaN</td>
<td>NaN</td>
<td>0.833333</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td>20252026</td>
<td>"R"</td>
<td>"NJD"</td>
<td>0</td>
<td>"shorthanded"</td>
<td>120.933333</td>
<td>2</td>
<td>16</td>
<td>1.737288</td>
<td>15.06796</td>
<td>0</td>
<td>6</td>
<td>1.977491</td>
<td>20.020203</td>
<td>2.213706</td>
<td>18.863242</td>
<td>17</td>
<td>116</td>
<td>16.053371</td>
<td>110.466815</td>
<td>6</td>
<td>33</td>
<td>24</td>
<td>171</td>
<td>22.643352</td>
<td>162.09692</td>
<td>6</td>
<td>52</td>
<td>27</td>
<td>213</td>
<td>22.643352</td>
<td>162.09692</td>
<td>3</td>
<td>42</td>
<td>0.0</td>
<td>0.0</td>
<td>7</td>
<td>55</td>
<td>7.463236</td>
<td>52.44747</td>
<td>0</td>
<td>19</td>
<td>0</td>
<td>13</td>
<td>7</td>
<td>19</td>
<td>11</td>
<td>73</td>
<td>18</td>
<td>58</td>
<td>64</td>
<td>85</td>
<td>2</td>
<td>71</td>
<td>6</td>
<td>12</td>
<td>56</td>
<td>2</td>
<td>0</td>
<td>5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>26</td>
<td>-0.476418</td>
<td>3.795282</td>
<td>4.651282</td>
<td>0.992282</td>
<td>7.938258</td>
<td>0.86194</td>
<td>7.475834</td>
<td>0.981115</td>
<td>9.932846</td>
<td>1.098311</td>
<td>9.35883</td>
<td>-0.236371</td>
<td>1.882996</td>
<td>0.755118</td>
<td>9.38011</td>
<td>0.826901</td>
<td>8.675806</td>
<td>0.892854</td>
<td>7.649225</td>
<td>0.836282</td>
<td>7.069986</td>
<td>0.009381</td>
<td>1.60582</td>
<td>5.064586</td>
<td>1.328225</td>
<td>1.078727</td>
<td>0.918393</td>
<td>-25.197613</td>
<td>1.172607</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="prep-todays-games" class="level3">
<h3 class="anchored" data-anchor-id="prep-todays-games">Prep today’s games</h3>
<p>Function to prepare today’s games</p>
<div id="baa28a85-1a67-479c-b5db-7f73b0c296e7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>todays_games <span class="op">=</span> prep_todays_games(schedule<span class="op">=</span>schedule, team_stats<span class="op">=</span>team_stats, nhl_stats<span class="op">=</span>nhl_stats, latest_date<span class="op">=</span>latest_date)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="31882191-3f68-410a-9a83-6123d1dca945" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>todays_games.head(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 128)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">session</th>
<th data-quarto-table-cell-role="th">game_id</th>
<th data-quarto-table-cell-role="th">game_date</th>
<th data-quarto-table-cell-role="th">start_time</th>
<th data-quarto-table-cell-role="th">game_state</th>
<th data-quarto-table-cell-role="th">home_team</th>
<th data-quarto-table-cell-role="th">home_team_id</th>
<th data-quarto-table-cell-role="th">home_score</th>
<th data-quarto-table-cell-role="th">away_team</th>
<th data-quarto-table-cell-role="th">away_team_id</th>
<th data-quarto-table-cell-role="th">away_score</th>
<th data-quarto-table-cell-role="th">venue</th>
<th data-quarto-table-cell-role="th">venue_timezone</th>
<th data-quarto-table-cell-role="th">neutral_site</th>
<th data-quarto-table-cell-role="th">game_date_dt_utc</th>
<th data-quarto-table-cell-role="th">tv_broadcasts</th>
<th data-quarto-table-cell-role="th">home_logo</th>
<th data-quarto-table-cell-role="th">home_logo_dark</th>
<th data-quarto-table-cell-role="th">away_logo</th>
<th data-quarto-table-cell-role="th">away_logo_dark</th>
<th data-quarto-table-cell-role="th">home_5v5_off_strength</th>
<th data-quarto-table-cell-role="th">home_5v5_def_strength</th>
<th data-quarto-table-cell-role="th">home_5v5_scoring_strength</th>
<th data-quarto-table-cell-role="th">home_5v5_goalie_strength</th>
<th data-quarto-table-cell-role="th">home_5v5_toi_comparison</th>
<th data-quarto-table-cell-role="th">home_powerplay_off_strength</th>
<th data-quarto-table-cell-role="th">home_powerplay_scoring_strength</th>
<th data-quarto-table-cell-role="th">home_powerplay_toi_comparison</th>
<th data-quarto-table-cell-role="th">home_shorthanded_def_strength</th>
<th data-quarto-table-cell-role="th">home_shorthanded_goalie_strength</th>
<th data-quarto-table-cell-role="th">home_shorthanded_toi_comparison</th>
<th data-quarto-table-cell-role="th">away_5v5_off_strength</th>
<th data-quarto-table-cell-role="th">away_5v5_def_strength</th>
<th data-quarto-table-cell-role="th">away_5v5_scoring_strength</th>
<th data-quarto-table-cell-role="th">away_5v5_goalie_strength</th>
<th data-quarto-table-cell-role="th">away_5v5_toi_comparison</th>
<th data-quarto-table-cell-role="th">away_powerplay_off_strength</th>
<th data-quarto-table-cell-role="th">away_powerplay_scoring_strength</th>
<th data-quarto-table-cell-role="th">away_powerplay_toi_comparison</th>
<th data-quarto-table-cell-role="th">away_shorthanded_def_strength</th>
<th data-quarto-table-cell-role="th">away_shorthanded_goalie_strength</th>
<th data-quarto-table-cell-role="th">away_shorthanded_toi_comparison</th>
<th data-quarto-table-cell-role="th">mean_home_5v5_xgf_p60</th>
<th data-quarto-table-cell-role="th">mean_home_5v5_xga_p60</th>
<th data-quarto-table-cell-role="th">mean_home_5v5_xgf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_5v5_xga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_5v5_gf_p60</th>
<th data-quarto-table-cell-role="th">mean_home_5v5_ga_p60</th>
<th data-quarto-table-cell-role="th">mean_home_5v5_gf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_5v5_ga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_5v5_g_score_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_home_5v5_g_save_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_home_5v5_toi_gp</th>
<th data-quarto-table-cell-role="th">mean_home_powerplay_xgf_p60</th>
<th data-quarto-table-cell-role="th">mean_home_powerplay_xga_p60</th>
<th data-quarto-table-cell-role="th">mean_home_powerplay_xgf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_powerplay_xga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_powerplay_gf_p60</th>
<th data-quarto-table-cell-role="th">mean_home_powerplay_ga_p60</th>
<th data-quarto-table-cell-role="th">mean_home_powerplay_gf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_powerplay_ga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_powerplay_g_score_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_home_powerplay_g_save_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_home_powerplay_toi_gp</th>
<th data-quarto-table-cell-role="th">mean_home_shorthanded_xgf_p60</th>
<th data-quarto-table-cell-role="th">mean_home_shorthanded_xga_p60</th>
<th data-quarto-table-cell-role="th">mean_home_shorthanded_xgf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_shorthanded_xga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_shorthanded_gf_p60</th>
<th data-quarto-table-cell-role="th">mean_home_shorthanded_ga_p60</th>
<th data-quarto-table-cell-role="th">mean_home_shorthanded_gf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_shorthanded_ga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_home_shorthanded_g_score_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_home_shorthanded_g_save_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_home_shorthanded_toi_gp</th>
<th data-quarto-table-cell-role="th">mean_away_5v5_xgf_p60</th>
<th data-quarto-table-cell-role="th">mean_away_5v5_xga_p60</th>
<th data-quarto-table-cell-role="th">mean_away_5v5_xgf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_5v5_xga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_5v5_gf_p60</th>
<th data-quarto-table-cell-role="th">mean_away_5v5_ga_p60</th>
<th data-quarto-table-cell-role="th">mean_away_5v5_gf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_5v5_ga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_5v5_g_score_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_away_5v5_g_save_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_away_5v5_toi_gp</th>
<th data-quarto-table-cell-role="th">mean_away_powerplay_xgf_p60</th>
<th data-quarto-table-cell-role="th">mean_away_powerplay_xga_p60</th>
<th data-quarto-table-cell-role="th">mean_away_powerplay_xgf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_powerplay_xga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_powerplay_gf_p60</th>
<th data-quarto-table-cell-role="th">mean_away_powerplay_ga_p60</th>
<th data-quarto-table-cell-role="th">mean_away_powerplay_gf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_powerplay_ga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_powerplay_g_score_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_away_powerplay_g_save_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_away_powerplay_toi_gp</th>
<th data-quarto-table-cell-role="th">mean_away_shorthanded_xgf_p60</th>
<th data-quarto-table-cell-role="th">mean_away_shorthanded_xga_p60</th>
<th data-quarto-table-cell-role="th">mean_away_shorthanded_xgf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_shorthanded_xga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_shorthanded_gf_p60</th>
<th data-quarto-table-cell-role="th">mean_away_shorthanded_ga_p60</th>
<th data-quarto-table-cell-role="th">mean_away_shorthanded_gf_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_shorthanded_ga_adj_p60</th>
<th data-quarto-table-cell-role="th">mean_away_shorthanded_g_score_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_away_shorthanded_g_save_ax_p60</th>
<th data-quarto-table-cell-role="th">mean_away_shorthanded_toi_gp</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_shorthanded_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_xga_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_ga_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_shorthanded_xga_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_shorthanded_ga_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_xga_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_ga_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_shorthanded_xga_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_shorthanded_ga_p60</th>
</tr>
<tr class="even">
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>i64</td>
<td>i64</td>
<td>str</td>
<td>i64</td>
<td>i64</td>
<td>str</td>
<td>str</td>
<td>i64</td>
<td>datetime[μs, UTC]</td>
<td>list[struct[5]]</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>20252026</td>
<td>2</td>
<td>2025020810</td>
<td>"2026-01-24"</td>
<td>"13:00"</td>
<td>"OFF"</td>
<td>"NYI"</td>
<td>2</td>
<td>0</td>
<td>"BUF"</td>
<td>7</td>
<td>5</td>
<td>"UBS ARENA"</td>
<td>"America/New_York"</td>
<td>0</td>
<td>2026-01-24 18:00:00 UTC</td>
<td>[{282,"N","CA","SN",107}, {28,"A","US","MSG-B",392}, {409,"H","US","MSGSN",411}]</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>1.032099</td>
<td>1.098022</td>
<td>1.215772</td>
<td>2.5018</td>
<td>0.998547</td>
<td>1.019476</td>
<td>1.519422</td>
<td>1.078344</td>
<td>1.166022</td>
<td>2.812028</td>
<td>0.972322</td>
<td>1.013831</td>
<td>0.959593</td>
<td>1.192254</td>
<td>0.226348</td>
<td>1.002412</td>
<td>1.015596</td>
<td>2.379345</td>
<td>1.059298</td>
<td>0.962996</td>
<td>1.663244</td>
<td>0.847453</td>
<td>2.941164</td>
<td>2.728581</td>
<td>2.816787</td>
<td>2.851487</td>
<td>2.533148</td>
<td>2.485146</td>
<td>2.43756</td>
<td>2.566546</td>
<td>-0.379227</td>
<td>0.28494</td>
<td>48.501035</td>
<td>9.38011</td>
<td>0.755118</td>
<td>8.675806</td>
<td>0.826901</td>
<td>7.649225</td>
<td>0.892854</td>
<td>7.069986</td>
<td>0.836282</td>
<td>-1.60582</td>
<td>-0.009381</td>
<td>5.064586</td>
<td>0.74397</td>
<td>9.243902</td>
<td>0.697858</td>
<td>10.020775</td>
<td>0.686962</td>
<td>7.512728</td>
<td>0.754316</td>
<td>8.12549</td>
<td>0.056458</td>
<td>1.895285</td>
<td>4.648962</td>
<td>2.728581</td>
<td>2.941164</td>
<td>2.851487</td>
<td>2.816787</td>
<td>2.483774</td>
<td>2.535891</td>
<td>2.566546</td>
<td>2.43756</td>
<td>-0.28494</td>
<td>0.379227</td>
<td>48.501035</td>
<td>9.243902</td>
<td>0.74397</td>
<td>10.020775</td>
<td>0.697858</td>
<td>7.512728</td>
<td>0.716194</td>
<td>8.12549</td>
<td>0.754316</td>
<td>-1.895285</td>
<td>-0.056458</td>
<td>4.648962</td>
<td>0.755118</td>
<td>9.38011</td>
<td>0.826901</td>
<td>8.675806</td>
<td>0.892854</td>
<td>7.649225</td>
<td>0.836282</td>
<td>7.069986</td>
<td>0.009381</td>
<td>1.60582</td>
<td>5.064586</td>
<td>48.547351</td>
<td>4.628251</td>
<td>4.788336</td>
<td>2.789734</td>
<td>3.174302</td>
<td>0.664344</td>
<td>8.522113</td>
<td>8.51749</td>
<td>17.541011</td>
<td>11.866671</td>
<td>64.38049</td>
<td>3.174302</td>
<td>2.789734</td>
<td>8.522113</td>
<td>0.664344</td>
<td>11.866671</td>
<td>64.38049</td>
<td>8.51749</td>
<td>17.541011</td>
</tr>
<tr class="even">
<td>20252026</td>
<td>2</td>
<td>2025020811</td>
<td>"2026-01-24"</td>
<td>"12:30"</td>
<td>"OFF"</td>
<td>"NSH"</td>
<td>18</td>
<td>2</td>
<td>"UTA"</td>
<td>68</td>
<td>5</td>
<td>"BRIDGESTONE ARENA"</td>
<td>"US/Central"</td>
<td>0</td>
<td>2026-01-24 18:30:00 UTC</td>
<td>[{282,"N","CA","SN",107}, {284,"N","CA","SN1",113}, … {558,"A","US","Utah16",381}]</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>1.029662</td>
<td>0.983516</td>
<td>2.188479</td>
<td>-0.431273</td>
<td>0.978291</td>
<td>0.817146</td>
<td>0.418178</td>
<td>0.987613</td>
<td>0.86872</td>
<td>2.024623</td>
<td>1.145351</td>
<td>1.072654</td>
<td>0.912573</td>
<td>1.046681</td>
<td>0.277726</td>
<td>1.004538</td>
<td>0.78517</td>
<td>0.944735</td>
<td>1.00629</td>
<td>0.908922</td>
<td>1.070264</td>
<td>1.009018</td>
<td>2.941164</td>
<td>2.728581</td>
<td>2.816787</td>
<td>2.851487</td>
<td>2.533148</td>
<td>2.485146</td>
<td>2.43756</td>
<td>2.566546</td>
<td>-0.379227</td>
<td>0.28494</td>
<td>48.501035</td>
<td>9.38011</td>
<td>0.755118</td>
<td>8.675806</td>
<td>0.826901</td>
<td>7.649225</td>
<td>0.892854</td>
<td>7.069986</td>
<td>0.836282</td>
<td>-1.60582</td>
<td>-0.009381</td>
<td>5.064586</td>
<td>0.74397</td>
<td>9.243902</td>
<td>0.697858</td>
<td>10.020775</td>
<td>0.686962</td>
<td>7.512728</td>
<td>0.754316</td>
<td>8.12549</td>
<td>0.056458</td>
<td>1.895285</td>
<td>4.648962</td>
<td>2.728581</td>
<td>2.941164</td>
<td>2.851487</td>
<td>2.816787</td>
<td>2.483774</td>
<td>2.535891</td>
<td>2.566546</td>
<td>2.43756</td>
<td>-0.28494</td>
<td>0.379227</td>
<td>48.501035</td>
<td>9.243902</td>
<td>0.74397</td>
<td>10.020775</td>
<td>0.697858</td>
<td>7.512728</td>
<td>0.716194</td>
<td>8.12549</td>
<td>0.754316</td>
<td>-1.895285</td>
<td>-0.056458</td>
<td>4.648962</td>
<td>0.755118</td>
<td>9.38011</td>
<td>0.826901</td>
<td>8.675806</td>
<td>0.892854</td>
<td>7.649225</td>
<td>0.836282</td>
<td>7.069986</td>
<td>0.009381</td>
<td>1.60582</td>
<td>5.064586</td>
<td>47.663489</td>
<td>5.046957</td>
<td>5.358185</td>
<td>2.646771</td>
<td>3.008242</td>
<td>1.392119</td>
<td>-1.22224</td>
<td>6.443714</td>
<td>2.350161</td>
<td>6.835096</td>
<td>10.601006</td>
<td>3.008242</td>
<td>2.646771</td>
<td>-1.22224</td>
<td>1.392119</td>
<td>6.835096</td>
<td>10.601006</td>
<td>6.443714</td>
<td>2.350161</td>
</tr>
<tr class="odd">
<td>20252026</td>
<td>2</td>
<td>2025020812</td>
<td>"2026-01-24"</td>
<td>"19:00"</td>
<td>"OFF"</td>
<td>"BOS"</td>
<td>6</td>
<td>4</td>
<td>"MTL"</td>
<td>8</td>
<td>3</td>
<td>"TD GARDEN"</td>
<td>"US/Eastern"</td>
<td>0</td>
<td>2026-01-25 00:00:00 UTC</td>
<td>[{287,"N","CA","SNE",30}, {288,"N","CA","SNO",31}, … {31,"H","US","NESN",405}]</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>0.985353</td>
<td>1.063828</td>
<td>0.149162</td>
<td>2.623023</td>
<td>0.977731</td>
<td>0.945022</td>
<td>-0.130636</td>
<td>1.008577</td>
<td>1.088831</td>
<td>1.718694</td>
<td>1.165002</td>
<td>0.888426</td>
<td>0.943972</td>
<td>-0.718902</td>
<td>1.236217</td>
<td>0.976611</td>
<td>1.072128</td>
<td>-0.141762</td>
<td>1.132869</td>
<td>1.026001</td>
<td>0.702074</td>
<td>1.108745</td>
<td>2.941164</td>
<td>2.728581</td>
<td>2.816787</td>
<td>2.851487</td>
<td>2.533148</td>
<td>2.485146</td>
<td>2.43756</td>
<td>2.566546</td>
<td>-0.379227</td>
<td>0.28494</td>
<td>48.501035</td>
<td>9.38011</td>
<td>0.755118</td>
<td>8.675806</td>
<td>0.826901</td>
<td>7.649225</td>
<td>0.892854</td>
<td>7.069986</td>
<td>0.836282</td>
<td>-1.60582</td>
<td>-0.009381</td>
<td>5.064586</td>
<td>0.74397</td>
<td>9.243902</td>
<td>0.697858</td>
<td>10.020775</td>
<td>0.686962</td>
<td>7.512728</td>
<td>0.754316</td>
<td>8.12549</td>
<td>0.056458</td>
<td>1.895285</td>
<td>4.648962</td>
<td>2.728581</td>
<td>2.941164</td>
<td>2.851487</td>
<td>2.816787</td>
<td>2.483774</td>
<td>2.535891</td>
<td>2.566546</td>
<td>2.43756</td>
<td>-0.28494</td>
<td>0.379227</td>
<td>48.501035</td>
<td>9.243902</td>
<td>0.74397</td>
<td>10.020775</td>
<td>0.697858</td>
<td>7.512728</td>
<td>0.716194</td>
<td>8.12549</td>
<td>0.754316</td>
<td>-1.895285</td>
<td>-0.056458</td>
<td>4.648962</td>
<td>0.755118</td>
<td>9.38011</td>
<td>0.826901</td>
<td>8.675806</td>
<td>0.892854</td>
<td>7.649225</td>
<td>0.836282</td>
<td>7.069986</td>
<td>0.009381</td>
<td>1.60582</td>
<td>5.064586</td>
<td>46.31188</td>
<td>5.663496</td>
<td>6.135677</td>
<td>2.620023</td>
<td>2.695034</td>
<td>0.418081</td>
<td>-4.574184</td>
<td>8.412006</td>
<td>-0.628717</td>
<td>11.697909</td>
<td>-2.311086</td>
<td>2.695034</td>
<td>2.620023</td>
<td>-4.574184</td>
<td>0.418081</td>
<td>11.697909</td>
<td>-2.311086</td>
<td>8.412006</td>
<td>-0.628717</td>
</tr>
<tr class="even">
<td>20252026</td>
<td>2</td>
<td>2025020813</td>
<td>"2026-01-24"</td>
<td>"19:00"</td>
<td>"OFF"</td>
<td>"OTT"</td>
<td>9</td>
<td>1</td>
<td>"CAR"</td>
<td>12</td>
<td>4</td>
<td>"CANADIAN TIRE CENTRE"</td>
<td>"US/Eastern"</td>
<td>0</td>
<td>2026-01-25 00:00:00 UTC</td>
<td>[{284,"N","CA","SN1",113}, {286,"N","CA","CITY",137}, {561,"A","US","FDSNSO",202}]</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>0.991645</td>
<td>0.818598</td>
<td>1.545365</td>
<td>-0.907254</td>
<td>0.968379</td>
<td>0.89586</td>
<td>-0.503662</td>
<td>1.15124</td>
<td>0.725061</td>
<td>-0.22982</td>
<td>1.058032</td>
<td>1.198828</td>
<td>0.966861</td>
<td>2.877418</td>
<td>1.415492</td>
<td>0.993524</td>
<td>0.968843</td>
<td>1.812915</td>
<td>1.140039</td>
<td>0.713705</td>
<td>0.434465</td>
<td>1.074454</td>
<td>2.941164</td>
<td>2.728581</td>
<td>2.816787</td>
<td>2.851487</td>
<td>2.533148</td>
<td>2.485146</td>
<td>2.43756</td>
<td>2.566546</td>
<td>-0.379227</td>
<td>0.28494</td>
<td>48.501035</td>
<td>9.38011</td>
<td>0.755118</td>
<td>8.675806</td>
<td>0.826901</td>
<td>7.649225</td>
<td>0.892854</td>
<td>7.069986</td>
<td>0.836282</td>
<td>-1.60582</td>
<td>-0.009381</td>
<td>5.064586</td>
<td>0.74397</td>
<td>9.243902</td>
<td>0.697858</td>
<td>10.020775</td>
<td>0.686962</td>
<td>7.512728</td>
<td>0.754316</td>
<td>8.12549</td>
<td>0.056458</td>
<td>1.895285</td>
<td>4.648962</td>
<td>2.728581</td>
<td>2.941164</td>
<td>2.851487</td>
<td>2.816787</td>
<td>2.483774</td>
<td>2.535891</td>
<td>2.566546</td>
<td>2.43756</td>
<td>-0.28494</td>
<td>0.379227</td>
<td>48.501035</td>
<td>9.243902</td>
<td>0.74397</td>
<td>10.020775</td>
<td>0.697858</td>
<td>7.512728</td>
<td>0.716194</td>
<td>8.12549</td>
<td>0.754316</td>
<td>-1.895285</td>
<td>-0.056458</td>
<td>4.648962</td>
<td>0.755118</td>
<td>9.38011</td>
<td>0.826901</td>
<td>8.675806</td>
<td>0.892854</td>
<td>7.649225</td>
<td>0.836282</td>
<td>7.069986</td>
<td>0.009381</td>
<td>1.60582</td>
<td>5.064586</td>
<td>46.663215</td>
<td>6.264666</td>
<td>5.607569</td>
<td>2.700687</td>
<td>2.798327</td>
<td>5.112274</td>
<td>-6.57519</td>
<td>5.547136</td>
<td>-0.989171</td>
<td>7.039295</td>
<td>-2.378168</td>
<td>2.798327</td>
<td>2.700687</td>
<td>-6.57519</td>
<td>5.112274</td>
<td>7.039295</td>
<td>-2.378168</td>
<td>5.547136</td>
<td>-0.989171</td>
</tr>
<tr class="odd">
<td>20252026</td>
<td>2</td>
<td>2025020814</td>
<td>"2026-01-24"</td>
<td>"19:00"</td>
<td>"OFF"</td>
<td>"CBJ"</td>
<td>29</td>
<td>8</td>
<td>"TBL"</td>
<td>14</td>
<td>5</td>
<td>"NATIONWIDE ARENA"</td>
<td>"US/Eastern"</td>
<td>0</td>
<td>2026-01-25 00:00:00 UTC</td>
<td>[{581,"A","US","The Spot",211}, {565,"H","US","FDSNOH",286}]</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>"https://assets.nhle.com/logos/…</td>
<td>1.010127</td>
<td>1.054735</td>
<td>0.755682</td>
<td>2.576822</td>
<td>1.030619</td>
<td>1.068771</td>
<td>2.476875</td>
<td>0.822706</td>
<td>1.036681</td>
<td>-0.315558</td>
<td>0.956388</td>
<td>1.185417</td>
<td>0.853779</td>
<td>0.201814</td>
<td>1.910094</td>
<td>0.965921</td>
<td>0.948375</td>
<td>0.145274</td>
<td>1.09516</td>
<td>0.959875</td>
<td>2.335107</td>
<td>1.097917</td>
<td>2.941164</td>
<td>2.728581</td>
<td>2.816787</td>
<td>2.851487</td>
<td>2.533148</td>
<td>2.485146</td>
<td>2.43756</td>
<td>2.566546</td>
<td>-0.379227</td>
<td>0.28494</td>
<td>48.501035</td>
<td>9.38011</td>
<td>0.755118</td>
<td>8.675806</td>
<td>0.826901</td>
<td>7.649225</td>
<td>0.892854</td>
<td>7.069986</td>
<td>0.836282</td>
<td>-1.60582</td>
<td>-0.009381</td>
<td>5.064586</td>
<td>0.74397</td>
<td>9.243902</td>
<td>0.697858</td>
<td>10.020775</td>
<td>0.686962</td>
<td>7.512728</td>
<td>0.754316</td>
<td>8.12549</td>
<td>0.056458</td>
<td>1.895285</td>
<td>4.648962</td>
<td>2.728581</td>
<td>2.941164</td>
<td>2.851487</td>
<td>2.816787</td>
<td>2.483774</td>
<td>2.535891</td>
<td>2.566546</td>
<td>2.43756</td>
<td>-0.28494</td>
<td>0.379227</td>
<td>48.501035</td>
<td>9.243902</td>
<td>0.74397</td>
<td>10.020775</td>
<td>0.697858</td>
<td>7.512728</td>
<td>0.716194</td>
<td>8.12549</td>
<td>0.754316</td>
<td>-1.895285</td>
<td>-0.056458</td>
<td>4.648962</td>
<td>0.755118</td>
<td>9.38011</td>
<td>0.826901</td>
<td>8.675806</td>
<td>0.892854</td>
<td>7.649225</td>
<td>0.836282</td>
<td>7.069986</td>
<td>0.009381</td>
<td>1.60582</td>
<td>5.064586</td>
<td>48.282614</td>
<td>4.574653</td>
<td>4.869315</td>
<td>2.429269</td>
<td>3.565215</td>
<td>3.034386</td>
<td>1.668781</td>
<td>8.900392</td>
<td>41.949684</td>
<td>9.852042</td>
<td>-0.36622</td>
<td>3.565215</td>
<td>2.429269</td>
<td>1.668781</td>
<td>3.034386</td>
<td>9.852042</td>
<td>-0.36622</td>
<td>8.900392</td>
<td>41.949684</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="simulating-the-actual-games" class="level2">
<h2 class="anchored" data-anchor-id="simulating-the-actual-games">Simulating the actual games</h2>
<p>Functions to simulate the games</p>
<section id="random-float" class="level3">
<h3 class="anchored" data-anchor-id="random-float">Random float</h3>
<p>Generate a random floating number between 0 and 1</p>
<p>def random_float() -&gt; float: “““Generate a random floating number between 0 and 1.”“” random_generator = np.random.default_rng()</p>
<pre><code># return random_generator.triangular(left=0.0, mode=0.5, right=1.0)
return random_generator.random()</code></pre>
</section>
<section id="simulating-an-individual-game" class="level3">
<h3 class="anchored" data-anchor-id="simulating-an-individual-game">Simulating an individual game</h3>
<p>Predicts various game values, based on a poissoin distribution</p>
<div id="69f90e3a-b5b7-42a0-bc75-556bd341db2e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>game <span class="op">=</span> todays_games.<span class="bu">filter</span>((pl.col(<span class="st">"away_team"</span>) <span class="op">==</span> <span class="st">"NSH"</span>) <span class="op">|</span> (pl.col(<span class="st">"home_team"</span>) <span class="op">==</span> <span class="st">"NSH"</span>)).to_dicts()[<span class="dv">0</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="7139aa15-32a3-4551-974e-cc9c7e9d9c01" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pl.DataFrame(simulate_game(game))  <span class="co"># Showing it as a dataframe just to make it easy</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 26)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">game_id</th>
<th data-quarto-table-cell-role="th">home_team</th>
<th data-quarto-table-cell-role="th">away_team</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_shorthanded_toi</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_toi</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_toi</th>
<th data-quarto-table-cell-role="th">predicted_away_shorthanded_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_goals</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_goals</th>
<th data-quarto-table-cell-role="th">predicted_home_total_goals</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_goals</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_goals</th>
<th data-quarto-table-cell-role="th">predicted_away_total_goals</th>
<th data-quarto-table-cell-role="th">home_win</th>
<th data-quarto-table-cell-role="th">away_win</th>
<th data-quarto-table-cell-role="th">draw</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2025020811</td>
<td>"NSH"</td>
<td>"UTA"</td>
<td>43.0</td>
<td>2.0</td>
<td>8.0</td>
<td>43.0</td>
<td>8.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>1.0</td>
<td>13.0</td>
<td>2.15</td>
<td>0.433333</td>
<td>2.583333</td>
<td>NaN</td>
<td>1.0</td>
<td>18.0</td>
<td>5.0</td>
<td>0.716667</td>
<td>0.666667</td>
<td>1.383333</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="predict-an-entire-game" class="level3">
<h3 class="anchored" data-anchor-id="predict-an-entire-game">Predict an entire game</h3>
<p>Predict an entire game based on n number of simulations</p>
<div id="f44bb300-e9ea-4e7b-bc79-8bac736ecca3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>predicted_game <span class="op">=</span> predict_game(game, <span class="dv">100</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c340b342ef0447b18a384e3a3c4d3d13","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<div id="4ca3470d-0c48-4f3a-9a17-77613a176127" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>predicted_game.head(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 26)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">game_id</th>
<th data-quarto-table-cell-role="th">home_team</th>
<th data-quarto-table-cell-role="th">away_team</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_shorthanded_toi</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_toi</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_toi</th>
<th data-quarto-table-cell-role="th">predicted_away_shorthanded_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_goals</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_goals</th>
<th data-quarto-table-cell-role="th">predicted_home_total_goals</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_goals</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_goals</th>
<th data-quarto-table-cell-role="th">predicted_away_total_goals</th>
<th data-quarto-table-cell-role="th">home_win</th>
<th data-quarto-table-cell-role="th">away_win</th>
<th data-quarto-table-cell-role="th">draw</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2025020811</td>
<td>"NSH"</td>
<td>"UTA"</td>
<td>49.6</td>
<td>4.0</td>
<td>6.4</td>
<td>49.6</td>
<td>6.4</td>
<td>4.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
<td>8.0</td>
<td>2.48</td>
<td>0.533333</td>
<td>3.013333</td>
<td>NaN</td>
<td>1.0</td>
<td>14.0</td>
<td>4.0</td>
<td>0.826667</td>
<td>0.426667</td>
<td>1.253333</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>2025020811</td>
<td>"NSH"</td>
<td>"UTA"</td>
<td>36.0</td>
<td>3.0</td>
<td>4.0</td>
<td>36.0</td>
<td>4.0</td>
<td>3.0</td>
<td>2.0</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>0.6</td>
<td>0.2</td>
<td>0.8</td>
<td>NaN</td>
<td>2.0</td>
<td>13.0</td>
<td>6.0</td>
<td>1.2</td>
<td>0.4</td>
<td>1.6</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>2025020811</td>
<td>"NSH"</td>
<td>"UTA"</td>
<td>44.262295</td>
<td>7.868852</td>
<td>7.868852</td>
<td>44.262295</td>
<td>7.868852</td>
<td>7.868852</td>
<td>1.0</td>
<td>1.0</td>
<td>2.0</td>
<td>9.0</td>
<td>0.737705</td>
<td>1.180328</td>
<td>1.918033</td>
<td>NaN</td>
<td>5.0</td>
<td>12.0</td>
<td>1.0</td>
<td>3.688525</td>
<td>0.131148</td>
<td>3.819672</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>2025020811</td>
<td>"NSH"</td>
<td>"UTA"</td>
<td>49.52381</td>
<td>5.714286</td>
<td>4.761905</td>
<td>49.52381</td>
<td>4.761905</td>
<td>5.714286</td>
<td>1.0</td>
<td>3.0</td>
<td>1.0</td>
<td>6.0</td>
<td>2.47619</td>
<td>0.571429</td>
<td>3.047619</td>
<td>NaN</td>
<td>5.0</td>
<td>10.0</td>
<td>8.0</td>
<td>4.126984</td>
<td>0.634921</td>
<td>4.761905</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>2025020811</td>
<td>"NSH"</td>
<td>"UTA"</td>
<td>44.0</td>
<td>6.0</td>
<td>9.0</td>
<td>44.0</td>
<td>9.0</td>
<td>6.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>9.0</td>
<td>0.733333</td>
<td>0.9</td>
<td>1.633333</td>
<td>NaN</td>
<td>6.0</td>
<td>11.0</td>
<td>4.0</td>
<td>4.4</td>
<td>0.6</td>
<td>5.0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="simulating-multiple-games" class="level3">
<h3 class="anchored" data-anchor-id="simulating-multiple-games">Simulating multiple games</h3>
<p>Simulating multiple games at once</p>
<div id="01c42272-f1ed-4170-a0f7-4dc7f6cbcef2" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predict_games(predict_game, todays_games, total_simulations<span class="op">=</span><span class="dv">1_000</span>, n_workers<span class="op">=</span><span class="dv">1</span>, disable_progress_bar<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="8db37e08-bb11-4173-997f-4cf813dd821d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>predictions.head(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 26)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">game_id</th>
<th data-quarto-table-cell-role="th">home_team</th>
<th data-quarto-table-cell-role="th">away_team</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_shorthanded_toi</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_toi</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_toi</th>
<th data-quarto-table-cell-role="th">predicted_away_shorthanded_toi</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_goals</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_goals</th>
<th data-quarto-table-cell-role="th">predicted_home_total_goals</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_gf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_xgf_p60</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_goals</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_goals</th>
<th data-quarto-table-cell-role="th">predicted_away_total_goals</th>
<th data-quarto-table-cell-role="th">home_win</th>
<th data-quarto-table-cell-role="th">away_win</th>
<th data-quarto-table-cell-role="th">draw</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2025020810</td>
<td>"NYI"</td>
<td>"BUF"</td>
<td>52.5</td>
<td>2.5</td>
<td>5.0</td>
<td>52.5</td>
<td>5.0</td>
<td>2.5</td>
<td>0.0</td>
<td>2.0</td>
<td>16.0</td>
<td>12.0</td>
<td>1.75</td>
<td>0.5</td>
<td>2.25</td>
<td>7.0</td>
<td>4.0</td>
<td>55.0</td>
<td>12.0</td>
<td>3.5</td>
<td>1.0</td>
<td>4.5</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>2025020810</td>
<td>"NYI"</td>
<td>"BUF"</td>
<td>52.131148</td>
<td>1.967213</td>
<td>5.901639</td>
<td>52.131148</td>
<td>5.901639</td>
<td>1.967213</td>
<td>0.0</td>
<td>3.0</td>
<td>22.0</td>
<td>10.0</td>
<td>2.606557</td>
<td>0.327869</td>
<td>2.934426</td>
<td>9.0</td>
<td>4.0</td>
<td>59.0</td>
<td>6.0</td>
<td>3.47541</td>
<td>0.590164</td>
<td>4.065574</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>2025020810</td>
<td>"NYI"</td>
<td>"BUF"</td>
<td>52.5</td>
<td>4.6875</td>
<td>2.8125</td>
<td>52.5</td>
<td>2.8125</td>
<td>4.6875</td>
<td>0.0</td>
<td>5.0</td>
<td>19.0</td>
<td>9.0</td>
<td>4.375</td>
<td>0.703125</td>
<td>5.078125</td>
<td>9.0</td>
<td>5.0</td>
<td>59.0</td>
<td>15.0</td>
<td>4.375</td>
<td>0.703125</td>
<td>5.078125</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>2025020810</td>
<td>"NYI"</td>
<td>"BUF"</td>
<td>33.0</td>
<td>10.0</td>
<td>2.0</td>
<td>33.0</td>
<td>2.0</td>
<td>10.0</td>
<td>0.0</td>
<td>1.0</td>
<td>22.0</td>
<td>13.0</td>
<td>0.55</td>
<td>2.166667</td>
<td>2.716667</td>
<td>9.0</td>
<td>3.0</td>
<td>66.0</td>
<td>20.0</td>
<td>1.65</td>
<td>0.666667</td>
<td>2.316667</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>2025020810</td>
<td>"NYI"</td>
<td>"BUF"</td>
<td>40.0</td>
<td>1.0</td>
<td>0.0</td>
<td>40.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>11.0</td>
<td>5.0</td>
<td>2.666667</td>
<td>0.083333</td>
<td>2.75</td>
<td>8.0</td>
<td>5.0</td>
<td>59.0</td>
<td>16.0</td>
<td>3.333333</td>
<td>0.0</td>
<td>3.333333</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="assessing-results" class="level2">
<h2 class="anchored" data-anchor-id="assessing-results">Assessing results</h2>
<p>Check to see if the simulation is accurate</p>
<section id="process-winners" class="level3">
<h3 class="anchored" data-anchor-id="process-winners">Process winners</h3>
<p>Aggregate the predictions to “predict” a winner</p>
<div id="6841d6a6-dca0-4b3f-9bba-d18da74d097a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>predicted_winners <span class="op">=</span> process_winners(predictions)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="85808796-3632-4d93-bf4a-468abb5539ce" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>predicted_winners</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (9, 26)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">game_id</th>
<th data-quarto-table-cell-role="th">home_team</th>
<th data-quarto-table-cell-role="th">away_team</th>
<th data-quarto-table-cell-role="th">predicted_winner</th>
<th data-quarto-table-cell-role="th">predicted_home_win</th>
<th data-quarto-table-cell-role="th">predicted_away_win</th>
<th data-quarto-table-cell-role="th">predicted_draw</th>
<th data-quarto-table-cell-role="th">predicted_home_win_percent</th>
<th data-quarto-table-cell-role="th">predicted_away_win_percent</th>
<th data-quarto-table-cell-role="th">predicted_draw_percent</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_total_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_shorthanded_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_total_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_shorthanded_toi_mean</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2025020817</td>
<td>"MIN"</td>
<td>"FLA"</td>
<td>"FLA"</td>
<td>461</td>
<td>536</td>
<td>3</td>
<td>0.461</td>
<td>0.536</td>
<td>0.003</td>
<td>2.075311</td>
<td>0.739172</td>
<td>2.814484</td>
<td>2.773</td>
<td>6.988</td>
<td>44.898838</td>
<td>6.308386</td>
<td>4.402776</td>
<td>2.113866</td>
<td>0.868102</td>
<td>2.981968</td>
<td>2.826</td>
<td>11.836</td>
<td>44.898838</td>
<td>4.402776</td>
<td>6.308386</td>
</tr>
<tr class="even">
<td>2025020814</td>
<td>"CBJ"</td>
<td>"TBL"</td>
<td>"TBL"</td>
<td>306</td>
<td>690</td>
<td>4</td>
<td>0.306</td>
<td>0.69</td>
<td>0.004</td>
<td>1.906553</td>
<td>0.669293</td>
<td>2.575845</td>
<td>2.45</td>
<td>9.007</td>
<td>46.679519</td>
<td>4.449252</td>
<td>4.628229</td>
<td>2.824785</td>
<td>0.760766</td>
<td>3.585551</td>
<td>3.629</td>
<td>9.881</td>
<td>46.679519</td>
<td>4.628229</td>
<td>4.449252</td>
</tr>
<tr class="odd">
<td>2025020813</td>
<td>"OTT"</td>
<td>"CAR"</td>
<td>"CAR"</td>
<td>459</td>
<td>537</td>
<td>4</td>
<td>0.459</td>
<td>0.537</td>
<td>0.004</td>
<td>1.976862</td>
<td>0.557561</td>
<td>2.534423</td>
<td>2.65</td>
<td>5.609</td>
<td>44.872112</td>
<td>5.927584</td>
<td>5.440304</td>
<td>2.062832</td>
<td>0.643848</td>
<td>2.70668</td>
<td>2.756</td>
<td>7.065</td>
<td>44.872112</td>
<td>5.440304</td>
<td>5.927584</td>
</tr>
<tr class="even">
<td>2025020812</td>
<td>"BOS"</td>
<td>"MTL"</td>
<td>"MTL"</td>
<td>397</td>
<td>600</td>
<td>3</td>
<td>0.397</td>
<td>0.6</td>
<td>0.003</td>
<td>1.894879</td>
<td>0.762433</td>
<td>2.657312</td>
<td>2.557</td>
<td>8.452</td>
<td>44.568994</td>
<td>5.414241</td>
<td>6.037765</td>
<td>1.968763</td>
<td>1.177527</td>
<td>3.14629</td>
<td>2.643</td>
<td>11.672</td>
<td>44.568994</td>
<td>6.037765</td>
<td>5.414241</td>
</tr>
<tr class="odd">
<td>2025020811</td>
<td>"NSH"</td>
<td>"UTA"</td>
<td>"UTA"</td>
<td>433</td>
<td>564</td>
<td>3</td>
<td>0.433</td>
<td>0.564</td>
<td>0.003</td>
<td>2.00005</td>
<td>0.517972</td>
<td>2.518022</td>
<td>2.606</td>
<td>6.436</td>
<td>46.140582</td>
<td>4.837774</td>
<td>5.105645</td>
<td>2.318929</td>
<td>0.587029</td>
<td>2.905959</td>
<td>3.018</td>
<td>6.945</td>
<td>46.140582</td>
<td>5.105645</td>
<td>4.837774</td>
</tr>
<tr class="even">
<td>2025020810</td>
<td>"NYI"</td>
<td>"BUF"</td>
<td>"BUF"</td>
<td>372</td>
<td>623</td>
<td>5</td>
<td>0.372</td>
<td>0.623</td>
<td>0.005</td>
<td>2.113746</td>
<td>0.624885</td>
<td>2.738631</td>
<td>2.711</td>
<td>8.495</td>
<td>46.857121</td>
<td>4.435936</td>
<td>4.562943</td>
<td>2.491938</td>
<td>0.903787</td>
<td>3.395725</td>
<td>3.19</td>
<td>11.983</td>
<td>46.857121</td>
<td>4.562943</td>
<td>4.435936</td>
</tr>
<tr class="odd">
<td>2025020818</td>
<td>"EDM"</td>
<td>"WSH"</td>
<td>"EDM"</td>
<td>500</td>
<td>499</td>
<td>1</td>
<td>0.5</td>
<td>0.499</td>
<td>0.001</td>
<td>2.303046</td>
<td>1.020846</td>
<td>3.323892</td>
<td>2.984</td>
<td>12.598</td>
<td>46.357211</td>
<td>4.832619</td>
<td>4.49217</td>
<td>2.356921</td>
<td>0.908569</td>
<td>3.265491</td>
<td>3.058</td>
<td>12.179</td>
<td>46.357211</td>
<td>4.49217</td>
<td>4.832619</td>
</tr>
<tr class="even">
<td>2025020816</td>
<td>"STL"</td>
<td>"LAK"</td>
<td>"LAK"</td>
<td>378</td>
<td>613</td>
<td>9</td>
<td>0.378</td>
<td>0.613</td>
<td>0.009</td>
<td>1.787255</td>
<td>0.412386</td>
<td>2.199641</td>
<td>2.244</td>
<td>5.351</td>
<td>47.567413</td>
<td>4.592821</td>
<td>4.259765</td>
<td>1.969469</td>
<td>0.647448</td>
<td>2.616917</td>
<td>2.494</td>
<td>9.101</td>
<td>47.567413</td>
<td>4.259765</td>
<td>4.592821</td>
</tr>
<tr class="odd">
<td>2025020815</td>
<td>"WPG"</td>
<td>"DET"</td>
<td>"DET"</td>
<td>361</td>
<td>633</td>
<td>6</td>
<td>0.361</td>
<td>0.633</td>
<td>0.006</td>
<td>2.177507</td>
<td>0.577372</td>
<td>2.754879</td>
<td>2.81</td>
<td>8.746</td>
<td>46.495734</td>
<td>3.938766</td>
<td>5.2035</td>
<td>2.535959</td>
<td>0.955715</td>
<td>3.491675</td>
<td>3.274</td>
<td>11.014</td>
<td>46.495734</td>
<td>5.2035</td>
<td>3.938766</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="assessing-predictions" class="level3">
<h3 class="anchored" data-anchor-id="assessing-predictions">Assessing predictions</h3>
<p>Checking to see if the predictions were correct</p>
<div id="046ee19a-5943-4cb1-bbe5-41888423f2fc" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>assessed_predictions <span class="op">=</span> assess_predictions(predicted_winners, schedule)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="262178c5-e820-44d6-98cf-b42e54cb603c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>assessed_predictions</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (9, 28)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">game_id</th>
<th data-quarto-table-cell-role="th">home_team</th>
<th data-quarto-table-cell-role="th">away_team</th>
<th data-quarto-table-cell-role="th">predicted_winner</th>
<th data-quarto-table-cell-role="th">actual_winner</th>
<th data-quarto-table-cell-role="th">prediction_correct</th>
<th data-quarto-table-cell-role="th">predicted_home_win</th>
<th data-quarto-table-cell-role="th">predicted_away_win</th>
<th data-quarto-table-cell-role="th">predicted_draw</th>
<th data-quarto-table-cell-role="th">predicted_home_win_percent</th>
<th data-quarto-table-cell-role="th">predicted_away_win_percent</th>
<th data-quarto-table-cell-role="th">predicted_draw_percent</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_total_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_shorthanded_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_total_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_shorthanded_toi_mean</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>i32</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2025020817</td>
<td>"MIN"</td>
<td>"FLA"</td>
<td>"FLA"</td>
<td>"FLA"</td>
<td>1</td>
<td>461</td>
<td>536</td>
<td>3</td>
<td>0.461</td>
<td>0.536</td>
<td>0.003</td>
<td>2.075311</td>
<td>0.739172</td>
<td>2.814484</td>
<td>2.773</td>
<td>6.988</td>
<td>44.898838</td>
<td>6.308386</td>
<td>4.402776</td>
<td>2.113866</td>
<td>0.868102</td>
<td>2.981968</td>
<td>2.826</td>
<td>11.836</td>
<td>44.898838</td>
<td>4.402776</td>
<td>6.308386</td>
</tr>
<tr class="even">
<td>2025020814</td>
<td>"CBJ"</td>
<td>"TBL"</td>
<td>"TBL"</td>
<td>"CBJ"</td>
<td>0</td>
<td>306</td>
<td>690</td>
<td>4</td>
<td>0.306</td>
<td>0.69</td>
<td>0.004</td>
<td>1.906553</td>
<td>0.669293</td>
<td>2.575845</td>
<td>2.45</td>
<td>9.007</td>
<td>46.679519</td>
<td>4.449252</td>
<td>4.628229</td>
<td>2.824785</td>
<td>0.760766</td>
<td>3.585551</td>
<td>3.629</td>
<td>9.881</td>
<td>46.679519</td>
<td>4.628229</td>
<td>4.449252</td>
</tr>
<tr class="odd">
<td>2025020813</td>
<td>"OTT"</td>
<td>"CAR"</td>
<td>"CAR"</td>
<td>"CAR"</td>
<td>1</td>
<td>459</td>
<td>537</td>
<td>4</td>
<td>0.459</td>
<td>0.537</td>
<td>0.004</td>
<td>1.976862</td>
<td>0.557561</td>
<td>2.534423</td>
<td>2.65</td>
<td>5.609</td>
<td>44.872112</td>
<td>5.927584</td>
<td>5.440304</td>
<td>2.062832</td>
<td>0.643848</td>
<td>2.70668</td>
<td>2.756</td>
<td>7.065</td>
<td>44.872112</td>
<td>5.440304</td>
<td>5.927584</td>
</tr>
<tr class="even">
<td>2025020812</td>
<td>"BOS"</td>
<td>"MTL"</td>
<td>"MTL"</td>
<td>"BOS"</td>
<td>0</td>
<td>397</td>
<td>600</td>
<td>3</td>
<td>0.397</td>
<td>0.6</td>
<td>0.003</td>
<td>1.894879</td>
<td>0.762433</td>
<td>2.657312</td>
<td>2.557</td>
<td>8.452</td>
<td>44.568994</td>
<td>5.414241</td>
<td>6.037765</td>
<td>1.968763</td>
<td>1.177527</td>
<td>3.14629</td>
<td>2.643</td>
<td>11.672</td>
<td>44.568994</td>
<td>6.037765</td>
<td>5.414241</td>
</tr>
<tr class="odd">
<td>2025020811</td>
<td>"NSH"</td>
<td>"UTA"</td>
<td>"UTA"</td>
<td>"UTA"</td>
<td>1</td>
<td>433</td>
<td>564</td>
<td>3</td>
<td>0.433</td>
<td>0.564</td>
<td>0.003</td>
<td>2.00005</td>
<td>0.517972</td>
<td>2.518022</td>
<td>2.606</td>
<td>6.436</td>
<td>46.140582</td>
<td>4.837774</td>
<td>5.105645</td>
<td>2.318929</td>
<td>0.587029</td>
<td>2.905959</td>
<td>3.018</td>
<td>6.945</td>
<td>46.140582</td>
<td>5.105645</td>
<td>4.837774</td>
</tr>
<tr class="even">
<td>2025020810</td>
<td>"NYI"</td>
<td>"BUF"</td>
<td>"BUF"</td>
<td>"BUF"</td>
<td>1</td>
<td>372</td>
<td>623</td>
<td>5</td>
<td>0.372</td>
<td>0.623</td>
<td>0.005</td>
<td>2.113746</td>
<td>0.624885</td>
<td>2.738631</td>
<td>2.711</td>
<td>8.495</td>
<td>46.857121</td>
<td>4.435936</td>
<td>4.562943</td>
<td>2.491938</td>
<td>0.903787</td>
<td>3.395725</td>
<td>3.19</td>
<td>11.983</td>
<td>46.857121</td>
<td>4.562943</td>
<td>4.435936</td>
</tr>
<tr class="odd">
<td>2025020818</td>
<td>"EDM"</td>
<td>"WSH"</td>
<td>"EDM"</td>
<td>"EDM"</td>
<td>1</td>
<td>500</td>
<td>499</td>
<td>1</td>
<td>0.5</td>
<td>0.499</td>
<td>0.001</td>
<td>2.303046</td>
<td>1.020846</td>
<td>3.323892</td>
<td>2.984</td>
<td>12.598</td>
<td>46.357211</td>
<td>4.832619</td>
<td>4.49217</td>
<td>2.356921</td>
<td>0.908569</td>
<td>3.265491</td>
<td>3.058</td>
<td>12.179</td>
<td>46.357211</td>
<td>4.49217</td>
<td>4.832619</td>
</tr>
<tr class="even">
<td>2025020816</td>
<td>"STL"</td>
<td>"LAK"</td>
<td>"LAK"</td>
<td>"LAK"</td>
<td>1</td>
<td>378</td>
<td>613</td>
<td>9</td>
<td>0.378</td>
<td>0.613</td>
<td>0.009</td>
<td>1.787255</td>
<td>0.412386</td>
<td>2.199641</td>
<td>2.244</td>
<td>5.351</td>
<td>47.567413</td>
<td>4.592821</td>
<td>4.259765</td>
<td>1.969469</td>
<td>0.647448</td>
<td>2.616917</td>
<td>2.494</td>
<td>9.101</td>
<td>47.567413</td>
<td>4.259765</td>
<td>4.592821</td>
</tr>
<tr class="odd">
<td>2025020815</td>
<td>"WPG"</td>
<td>"DET"</td>
<td>"DET"</td>
<td>"DET"</td>
<td>1</td>
<td>361</td>
<td>633</td>
<td>6</td>
<td>0.361</td>
<td>0.633</td>
<td>0.006</td>
<td>2.177507</td>
<td>0.577372</td>
<td>2.754879</td>
<td>2.81</td>
<td>8.746</td>
<td>46.495734</td>
<td>3.938766</td>
<td>5.2035</td>
<td>2.535959</td>
<td>0.955715</td>
<td>3.491675</td>
<td>3.274</td>
<td>11.014</td>
<td>46.495734</td>
<td>5.2035</td>
<td>3.938766</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="charts" class="level2">
<h2 class="anchored" data-anchor-id="charts">Charts</h2>
<p>Plotting the results of your simulations</p>
<section id="color-dictionary" class="level3">
<h3 class="anchored" data-anchor-id="color-dictionary">Color dictionary</h3>
<p>Taking the NHL colors and making a dictionary out of them</p>
<div id="30dae089-6cac-4a10-af31-b3f3d7348130" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>color_dict <span class="op">=</span> {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    key: (value[<span class="st">"GOAL"</span>] <span class="cf">if</span> value[<span class="st">"GOAL"</span>] <span class="op">!=</span> <span class="st">"#FFFFFF"</span> <span class="cf">else</span> value[<span class="st">"SHOT"</span>]) <span class="cf">for</span> key, value <span class="kw">in</span> NHL_COLORS.items()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="plotting-a-single-game" class="level3">
<h3 class="anchored" data-anchor-id="plotting-a-single-game">Plotting a single game</h3>
<p>Plotting the results for a single game</p>
<div id="d071dbad-ce31-4543-a87a-ab6328efb31e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>dpi <span class="op">=</span> <span class="dv">650</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">5</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>nrows <span class="op">=</span> <span class="dv">1</span>  <span class="co"># len(assessed_predictions["home_team"].to_list())</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>ncols <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(nrows<span class="op">=</span>nrows, ncols<span class="op">=</span>ncols, figsize<span class="op">=</span>figsize, dpi<span class="op">=</span>dpi, sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, game <span class="kw">in</span> <span class="bu">enumerate</span>(</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    assessed_predictions.<span class="bu">filter</span>((pl.col(<span class="st">"away_team"</span>) <span class="op">==</span> <span class="st">"NSH"</span>) <span class="op">|</span> (pl.col(<span class="st">"home_team"</span>) <span class="op">==</span> <span class="st">"NSH"</span>))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    .sort(<span class="st">"predicted_away_total_goals_mean"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    .to_dicts()</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax = axs[idx]</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    plot_predictions <span class="op">=</span> predictions.<span class="bu">filter</span>(pl.col(<span class="st">"game_id"</span>) <span class="op">==</span> game[<span class="st">"game_id"</span>])</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    venues <span class="op">=</span> [<span class="st">"away"</span>, <span class="st">"home"</span>]</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> venue <span class="kw">in</span> venues:</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>        sns.kdeplot(</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>            data<span class="op">=</span>plot_predictions,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span>plot_predictions[<span class="ss">f"predicted_</span><span class="sc">{</span>venue<span class="sc">}</span><span class="ss">_total_goals"</span>],</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>            bw_adjust<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>            clip_on<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>            fill<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>            alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>            linewidth<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>            hue<span class="op">=</span>plot_predictions[<span class="ss">f"</span><span class="sc">{</span>venue<span class="sc">}</span><span class="ss">_team"</span>],</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>            palette<span class="op">=</span>color_dict,</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>            legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>            ax<span class="op">=</span>ax,</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    sns.despine(left<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(yticks<span class="op">=</span>[], ylabel<span class="op">=</span><span class="st">""</span>, xlabel<span class="op">=</span><span class="st">"predicted total goals"</span>)</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> idx <span class="op">!=</span> (nrows <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>        ax.<span class="bu">set</span>(xticks<span class="op">=</span>[])</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># else:</span></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     ax.set(xlabel="predicted total goals")</span></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"</span><span class="sc">{</span>game[<span class="st">'home_team'</span>]<span class="sc">}</span><span class="ss"> vs. </span><span class="sc">{</span>game[<span class="st">'away_team'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="ss">f"./charts/</span><span class="sc">{</span>latest_date<span class="sc">}</span><span class="ss">_NSH.png"</span>, dpi<span class="op">=</span><span class="dv">650</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>, facecolor<span class="op">=</span><span class="st">"white"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-36-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/cell-36-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-todays-games" class="level3">
<h3 class="anchored" data-anchor-id="plotting-todays-games">Plotting today’s games</h3>
<p>Plotting the predicted goals for all of today’s games</p>
<div id="9131d458-6039-4291-8788-829b8f187057" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>dpi <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>figsize <span class="op">=</span> (<span class="dv">4</span>, <span class="dv">12</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>nrows <span class="op">=</span> <span class="bu">len</span>(assessed_predictions[<span class="st">"home_team"</span>].to_list())</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>ncols <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span>nrows, ncols<span class="op">=</span>ncols, figsize<span class="op">=</span>figsize, dpi<span class="op">=</span>dpi, sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, game <span class="kw">in</span> <span class="bu">enumerate</span>(assessed_predictions.sort(<span class="st">"predicted_home_total_goals_mean"</span>).to_dicts()):</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axs[idx]</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    plot_predictions <span class="op">=</span> predictions.<span class="bu">filter</span>(pl.col(<span class="st">"game_id"</span>) <span class="op">==</span> game[<span class="st">"game_id"</span>])</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    venues <span class="op">=</span> [<span class="st">"away"</span>, <span class="st">"home"</span>]</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> venue <span class="kw">in</span> venues:</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>        sns.kdeplot(</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>            data<span class="op">=</span>plot_predictions,</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span>plot_predictions[<span class="ss">f"predicted_</span><span class="sc">{</span>venue<span class="sc">}</span><span class="ss">_total_goals"</span>],</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>            bw_adjust<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>            clip_on<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>            fill<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>            alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>            linewidth<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>            hue<span class="op">=</span>plot_predictions[<span class="ss">f"</span><span class="sc">{</span>venue<span class="sc">}</span><span class="ss">_team"</span>],</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>            palette<span class="op">=</span>color_dict,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>            legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>            ax<span class="op">=</span>ax,</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    sns.despine(left<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(yticks<span class="op">=</span>[], ylabel<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> idx <span class="op">!=</span> (nrows <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>        ax.<span class="bu">set</span>(xticks<span class="op">=</span>[])</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># else:</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     ax.set(xlabel="predicted total goals")</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"</span><span class="sc">{</span>game[<span class="st">'home_team'</span>]<span class="sc">}</span><span class="ss"> vs. </span><span class="sc">{</span>game[<span class="st">'away_team'</span>]<span class="sc">}</span><span class="ss">"</span>, y<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="ss">f"./charts/</span><span class="sc">{</span>latest_date<span class="sc">}</span><span class="ss">.png"</span>, dpi<span class="op">=</span><span class="dv">650</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>, facecolor<span class="op">=</span><span class="st">"white"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-37-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="assessing-predictions-1" class="level2">
<h2 class="anchored" data-anchor-id="assessing-predictions-1">Assessing predictions</h2>
<p>Seeing how the season long predictions have been playing</p>
<section id="downloading-the-data-from-github" class="level3">
<h3 class="anchored" data-anchor-id="downloading-the-data-from-github">Downloading the data from GitHub</h3>
<p>Downloading the data from the <code>chickenstats</code> repository on GitHub</p>
<div id="7a7e4ef9-3219-438d-ba24-e01ed54c7ec5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>csv_url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/chickenandstats/chickenstats-blog/refs/heads/main/nbs/blog/posts/tutorials/monte_carlo/results/predicted_winners.csv"</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>season_predictions <span class="op">=</span> pl.read_csv(csv_url)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a29e3774-3386-44c8-8679-d98c39e75f0e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>season_predictions.head(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (10, 28)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">game_id</th>
<th data-quarto-table-cell-role="th">home_team</th>
<th data-quarto-table-cell-role="th">away_team</th>
<th data-quarto-table-cell-role="th">predicted_winner</th>
<th data-quarto-table-cell-role="th">actual_winner</th>
<th data-quarto-table-cell-role="th">prediction_correct</th>
<th data-quarto-table-cell-role="th">predicted_home_win</th>
<th data-quarto-table-cell-role="th">predicted_away_win</th>
<th data-quarto-table-cell-role="th">predicted_draw</th>
<th data-quarto-table-cell-role="th">predicted_home_win_percent</th>
<th data-quarto-table-cell-role="th">predicted_away_win_percent</th>
<th data-quarto-table-cell-role="th">predicted_draw_percent</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_total_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_5v5_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_powerplay_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_home_shorthanded_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_total_goals_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_xgf_p60_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_5v5_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_powerplay_toi_mean</th>
<th data-quarto-table-cell-role="th">predicted_away_shorthanded_toi_mean</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>str</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2025020695</td>
<td>"WPG"</td>
<td>"LAK"</td>
<td>"LAK"</td>
<td>"WPG"</td>
<td>0</td>
<td>4060</td>
<td>5892</td>
<td>48</td>
<td>0.406</td>
<td>0.5892</td>
<td>0.0048</td>
<td>1.956666</td>
<td>0.641295</td>
<td>2.597961</td>
<td>2.5485</td>
<td>7.1324</td>
<td>46.105153</td>
<td>5.400488</td>
<td>4.396158</td>
<td>2.202071</td>
<td>0.824131</td>
<td>3.026202</td>
<td>2.8657</td>
<td>11.2256</td>
<td>46.105153</td>
<td>4.396158</td>
<td>5.400488</td>
</tr>
<tr class="even">
<td>2025020530</td>
<td>"DET"</td>
<td>"UTA"</td>
<td>"UTA"</td>
<td>"UTA"</td>
<td>1</td>
<td>4511</td>
<td>5435</td>
<td>54</td>
<td>0.4511</td>
<td>0.5435</td>
<td>0.0054</td>
<td>2.187779</td>
<td>0.527668</td>
<td>2.715447</td>
<td>2.7515</td>
<td>6.9293</td>
<td>47.688887</td>
<td>4.564279</td>
<td>3.723834</td>
<td>2.512217</td>
<td>0.435366</td>
<td>2.947583</td>
<td>3.1607</td>
<td>7.008</td>
<td>47.688887</td>
<td>3.723834</td>
<td>4.564279</td>
</tr>
<tr class="odd">
<td>2025020148</td>
<td>"PIT"</td>
<td>"STL"</td>
<td>"STL"</td>
<td>"PIT"</td>
<td>0</td>
<td>2056</td>
<td>7903</td>
<td>41</td>
<td>0.2056</td>
<td>0.7903</td>
<td>0.0041</td>
<td>1.962572</td>
<td>1.252185</td>
<td>3.214757</td>
<td>2.782</td>
<td>9.6232</td>
<td>42.352182</td>
<td>7.806185</td>
<td>6.377632</td>
<td>3.922311</td>
<td>1.086998</td>
<td>5.00931</td>
<td>5.5547</td>
<td>10.2336</td>
<td>42.352182</td>
<td>6.377632</td>
<td>7.806185</td>
</tr>
<tr class="even">
<td>2025020593</td>
<td>"CAR"</td>
<td>"DET"</td>
<td>"DET"</td>
<td>"CAR"</td>
<td>0</td>
<td>4917</td>
<td>5037</td>
<td>46</td>
<td>0.4917</td>
<td>0.5037</td>
<td>0.0046</td>
<td>2.486878</td>
<td>0.699148</td>
<td>3.186026</td>
<td>3.1919</td>
<td>9.9487</td>
<td>46.735572</td>
<td>4.217244</td>
<td>4.457284</td>
<td>2.362811</td>
<td>0.840152</td>
<td>3.202963</td>
<td>3.0351</td>
<td>11.309</td>
<td>46.735572</td>
<td>4.457284</td>
<td>4.217244</td>
</tr>
<tr class="odd">
<td>2025020427</td>
<td>"OTT"</td>
<td>"NYR"</td>
<td>"NYR"</td>
<td>"NYR"</td>
<td>1</td>
<td>3814</td>
<td>6144</td>
<td>42</td>
<td>0.3814</td>
<td>0.6144</td>
<td>0.0042</td>
<td>1.583031</td>
<td>0.48285</td>
<td>2.065881</td>
<td>1.9963</td>
<td>6.3484</td>
<td>47.649183</td>
<td>4.570142</td>
<td>3.926674</td>
<td>1.909994</td>
<td>0.669286</td>
<td>2.57928</td>
<td>2.4068</td>
<td>10.228</td>
<td>47.649183</td>
<td>3.926674</td>
<td>4.570142</td>
</tr>
<tr class="even">
<td>2025020712</td>
<td>"BOS"</td>
<td>"PIT"</td>
<td>"PIT"</td>
<td>"BOS"</td>
<td>0</td>
<td>3955</td>
<td>5997</td>
<td>48</td>
<td>0.3955</td>
<td>0.5997</td>
<td>0.0048</td>
<td>2.251294</td>
<td>0.423561</td>
<td>2.674854</td>
<td>2.82</td>
<td>5.8083</td>
<td>47.907743</td>
<td>4.377982</td>
<td>3.811276</td>
<td>2.579232</td>
<td>0.621881</td>
<td>3.201113</td>
<td>3.2312</td>
<td>9.8068</td>
<td>47.907743</td>
<td>3.811276</td>
<td>4.377982</td>
</tr>
<tr class="odd">
<td>2025020329</td>
<td>"ANA"</td>
<td>"OTT"</td>
<td>"OTT"</td>
<td>"OTT"</td>
<td>1</td>
<td>3673</td>
<td>6274</td>
<td>53</td>
<td>0.3673</td>
<td>0.6274</td>
<td>0.0053</td>
<td>1.782043</td>
<td>0.533371</td>
<td>2.315414</td>
<td>2.3281</td>
<td>8.1117</td>
<td>45.880385</td>
<td>3.939515</td>
<td>5.5705</td>
<td>2.322641</td>
<td>0.583617</td>
<td>2.906258</td>
<td>3.0382</td>
<td>6.2758</td>
<td>45.880385</td>
<td>5.5705</td>
<td>3.939515</td>
</tr>
<tr class="even">
<td>2025020478</td>
<td>"UTA"</td>
<td>"FLA"</td>
<td>"UTA"</td>
<td>"FLA"</td>
<td>0</td>
<td>5255</td>
<td>4681</td>
<td>64</td>
<td>0.5255</td>
<td>0.4681</td>
<td>0.0064</td>
<td>2.160342</td>
<td>0.722947</td>
<td>2.883289</td>
<td>3.0104</td>
<td>7.2158</td>
<td>43.032919</td>
<td>5.999608</td>
<td>6.071273</td>
<td>1.920013</td>
<td>0.8197</td>
<td>2.739713</td>
<td>2.6752</td>
<td>8.1008</td>
<td>43.032919</td>
<td>6.071273</td>
<td>5.999608</td>
</tr>
<tr class="odd">
<td>2025020665</td>
<td>"CGY"</td>
<td>"SEA"</td>
<td>"CGY"</td>
<td>"SEA"</td>
<td>0</td>
<td>6768</td>
<td>3177</td>
<td>55</td>
<td>0.6768</td>
<td>0.3177</td>
<td>0.0055</td>
<td>2.404052</td>
<td>0.712321</td>
<td>3.116374</td>
<td>3.0099</td>
<td>9.7929</td>
<td>47.894337</td>
<td>4.372837</td>
<td>3.531827</td>
<td>1.704213</td>
<td>0.540618</td>
<td>2.244831</td>
<td>2.1322</td>
<td>9.1522</td>
<td>47.894337</td>
<td>3.531827</td>
<td>4.372837</td>
</tr>
<tr class="even">
<td>2025020319</td>
<td>"TOR"</td>
<td>"CBJ"</td>
<td>"CBJ"</td>
<td>"CBJ"</td>
<td>1</td>
<td>2905</td>
<td>7062</td>
<td>33</td>
<td>0.2905</td>
<td>0.7062</td>
<td>0.0033</td>
<td>1.959842</td>
<td>0.663825</td>
<td>2.623667</td>
<td>2.431</td>
<td>10.4463</td>
<td>48.388112</td>
<td>3.816683</td>
<td>3.615505</td>
<td>2.558635</td>
<td>1.188494</td>
<td>3.747129</td>
<td>3.1704</td>
<td>19.7096</td>
<td>48.388112</td>
<td>3.615505</td>
<td>3.816683</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="checking-the-results" class="level2">
<h2 class="anchored" data-anchor-id="checking-the-results">Checking the results</h2>
<p>Let’s see how the simulation does</p>
<div id="26f8e3b0-bda5-4447-a222-f54a42d9de3b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>season_predictions.select(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"prediction_correct"</span>).<span class="bu">sum</span>().alias(<span class="st">"correct_predictions"</span>),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"game_id"</span>).n_unique().alias(<span class="st">"total games"</span>),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    (pl.col(<span class="st">"prediction_correct"</span>).<span class="bu">sum</span>() <span class="op">/</span> pl.col(<span class="st">"game_id"</span>).n_unique()).alias(<span class="st">"correct_prediction_percent"</span>),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Kind of meh, TBH</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">correct_predictions</th>
<th data-quarto-table-cell-role="th">total games</th>
<th data-quarto-table-cell-role="th">correct_prediction_percent</th>
</tr>
<tr class="even">
<td>i64</td>
<td>u32</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>414</td>
<td>796</td>
<td>0.520101</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"state":{},"version_major":2,"version_minor":0}
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/blog\.chickenstats\.com\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright © 2025-26 chicken and stats</p>
</div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/chickenandstats/chickenstats-blog">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://bsky.app/profile/chickenandstats.com">
      <i class="bi bi-bluesky" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>