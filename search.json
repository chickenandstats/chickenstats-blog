[
  {
    "objectID": "blog/posts/tutorials/rink_maps/index.html",
    "href": "blog/posts/tutorials/rink_maps/index.html",
    "title": "Rink maps",
    "section": "",
    "text": "Use the chickenstats library to scrape play-by-play data and plot shot events using the hockey-rink library.\nParts of this tutorial are optional and will be clearly marked as such. For help, or any questions, please don’t hesitate to reach out to chicken@chickenandstats.com or @chickenandstats.com on Blue Sky."
  },
  {
    "objectID": "blog/posts/tutorials/rink_maps/index.html#intro",
    "href": "blog/posts/tutorials/rink_maps/index.html#intro",
    "title": "Rink maps",
    "section": "",
    "text": "Use the chickenstats library to scrape play-by-play data and plot shot events using the hockey-rink library.\nParts of this tutorial are optional and will be clearly marked as such. For help, or any questions, please don’t hesitate to reach out to chicken@chickenandstats.com or @chickenandstats.com on Blue Sky."
  },
  {
    "objectID": "blog/posts/tutorials/rink_maps/index.html#housekeeping",
    "href": "blog/posts/tutorials/rink_maps/index.html#housekeeping",
    "title": "Rink maps",
    "section": "Housekeeping",
    "text": "Housekeeping\n\nImport dependencies\nImport the dependencies we’ll need for the guide\n\nfrom pathlib import Path\n\nimport matplotlib.pyplot as plt\nimport polars as pl\nimport seaborn as sns\nfrom hockey_rink import NHLRink\n\nfrom chickenstats.chicken_nhl import Scraper, Season\nfrom chickenstats.chicken_nhl._helpers import charts_directory, norm_coords\nfrom chickenstats.chicken_nhl.team import NHL_COLORS\n\n\n\nPolars options\nSets different polars options. This cell is optional\n\npl.Config.set_tbl_cols(-1)\n\npolars.config.Config\n\n\n\n\nFolder structure\n\ncharts_directory()\n\n\n\nChickenstats matplotlib style\nchickenstats.utilities includes a custom style package - this activates it. This cell is also optional\n\nplt.style.use(\"chickenstats\")"
  },
  {
    "objectID": "blog/posts/tutorials/rink_maps/index.html#scrape-data",
    "href": "blog/posts/tutorials/rink_maps/index.html#scrape-data",
    "title": "Rink maps",
    "section": "Scrape data",
    "text": "Scrape data\n\nSchedule and game IDs\nScrape the schedule and standings using the Season object. Then, create a list of game IDs to scrape\n\nseason = Season(2025)\n\n\nschedule = season.schedule()\n\n\n\n\n\n\n\n\nstandings = season.standings\n\n\ngame_ids = schedule.filter(pl.col(\"game_state\") == \"OFF\")[\"game_id\"].to_list()\n\n\n\nPlay-by-play\nScrape the play-by-play data for the list of game IDs. First instantiate the Scraper object, then call the play_by_play attribute\n\nscraper = Scraper(game_ids)\n\n\npbp = scraper.play_by_play\n\n\n\n\n\n\n\n\n\nStats\nAggregate data using the Scraper object’s built-in methods\n\nscraper.prep_stats(level=\"season\")\nstats = scraper.stats\n\n\n\n\n\n\n\n\nscraper.prep_lines(level=\"season\")\nlines = scraper.lines\n\n\n\n\n\n\n\n\nscraper.prep_team_stats(level=\"season\")\nteam_stats = scraper.team_stats"
  },
  {
    "objectID": "blog/posts/tutorials/rink_maps/index.html#scatter-plots",
    "href": "blog/posts/tutorials/rink_maps/index.html#scatter-plots",
    "title": "Rink maps",
    "section": "Scatter plots",
    "text": "Scatter plots\n\nDrawing the rink\nDrawing the rink with the NHLRink class from the hockey-rink library\n\nrink = NHLRink(rotation=90)\n\n\n\nFilter conditions\nSet the team, strength state, minimum TOI, and maximum number of lines to plot, then filter the data\n\nteam = \"NSH\"\nstrength_state = \"5v5\"\ntoi_min = 12\nmax_lines = 3\n\nconditions = (pl.col(\"team\") == team, pl.col(\"strength_state\") == strength_state, pl.col(\"toi\") &gt;= toi_min)\n\nplot_lines = lines.filter(conditions).sort(\"toi\", descending=True).head(max_lines)\n\n\n\nTop-N forward line combos\nPlot the top-N forward line combinations at the chosen strength state, from the prior cell\n\n# Setting overall figures\nfig, axes = plt.subplots(nrows=2, ncols=max_lines, dpi=650, figsize=(16, 8))\n\nfig.tight_layout(pad=1.5)\n\naxes = axes.reshape(-1)\n\nsize_multiplier = 500\n\nfor row, line in enumerate(plot_lines.to_dicts()):\n    ax = axes[row]\n\n    ax_zone = \"dzone\" if row &gt; 5 else \"ozone\"\n\n    rink.draw(ax=ax, display_range=ax_zone)\n\n    shot_events = [\"MISS\", \"SHOT\", \"GOAL\"]\n\n    plot_conditions = (\n        pl.col(\"forwards\") == line[\"forwards\"],\n        pl.col(\"forwards_api_id\") == line[\"forwards_api_id\"],\n        pl.col(\"strength_state\") == strength_state,\n        pl.col(\"event\").is_in(shot_events),\n    )\n\n    plot_data = pbp.filter(plot_conditions).with_columns(pred_goal_size=pl.col(\"pred_goal\") * size_multiplier)\n\n    plot_data = norm_coords(plot_data, \"event_team\", line[\"team\"])\n\n    for shot_event in shot_events:\n        conditions = (pl.col(\"forwards_api_id\") == line[\"forwards_api_id\"], pl.col(\"event\") == shot_event)\n\n        plot_data2 = plot_data.filter(conditions)\n\n        if plot_data2.is_empty():\n            continue\n\n        colors = NHL_COLORS[plot_data2.item(0, \"event_team\")]\n\n        facecolor = colors[shot_event]\n\n        if shot_event == \"MISS\" or shot_event == \"SHOT\":\n            edgecolor = \"#FFFFFF\"\n\n        elif shot_event == \"GOAL\":\n            edgecolor = colors[\"SHOT\"] if facecolor == \"#FFFFFF\" else \"#FFFFFF\"\n\n        rink.plot_fn(\n            sns.scatterplot,\n            data=plot_data2,\n            x=\"norm_coords_x\",\n            y=\"norm_coords_y\",\n            color=facecolor,\n            edgecolor=edgecolor,\n            lw=0.75,\n            s=plot_data2[\"pred_goal_size\"],\n            # sizes=(0, size_multiplier),\n            size_norm=(0, size_multiplier),\n            zorder=100,\n            alpha=0.75,\n            ax=ax,\n        )\n\n    ax.set_title(f\"{line['forwards']}\", x=0.5, y=1.01, ha=\"center\", fontweight=\"bold\", fontsize=10)\n\n\nfor row, line in enumerate(plot_lines.to_dicts()):\n    row = row + max_lines\n\n    ax = axes[row]\n\n    ax_zone = \"dzone\" if row &gt; max_lines - 1 else \"ozone\"\n\n    rink.draw(ax=ax, display_range=ax_zone)\n\n    plot_conditions = (\n        pl.col(\"opp_forwards\") == line[\"forwards\"],\n        pl.col(\"opp_forwards_api_id\") == line[\"forwards_api_id\"],\n        pl.col(\"strength_state\") == strength_state,\n        pl.col(\"event\").is_in(shot_events),\n    )\n\n    plot_data = pbp.filter(plot_conditions).with_columns(pred_goal_size=pl.col(\"pred_goal\") * size_multiplier)\n\n    plot_data = norm_coords(plot_data, \"event_team\", line[\"team\"])\n\n    for shot_event in shot_events:\n        conditions = (pl.col(\"opp_forwards_api_id\") == line[\"forwards_api_id\"], pl.col(\"event\") == shot_event)\n\n        plot_data2 = plot_data.filter(conditions)\n\n        if plot_data2.is_empty():\n            continue\n\n        colors = NHL_COLORS[plot_data2.item(0, \"opp_team\")]\n\n        facecolor = colors[shot_event]\n\n        if shot_event == \"MISS\" or shot_event == \"SHOT\":\n            edgecolor = \"#FFFFFF\"\n\n        elif shot_event == \"GOAL\":\n            edgecolor = colors[\"SHOT\"] if facecolor == \"#FFFFFF\" else \"#FFFFFF\"\n\n        rink.plot_fn(\n            sns.scatterplot,\n            data=plot_data2,\n            x=\"norm_coords_x\",\n            y=\"norm_coords_y\",\n            color=facecolor,\n            edgecolor=edgecolor,\n            lw=0.75,\n            s=plot_data2[\"pred_goal_size\"],\n            # sizes=(0, size_multiplier),\n            size_norm=(0, size_multiplier),\n            zorder=100,\n            alpha=0.75,\n            ax=ax,\n        )\n\n\nfig_title = \"Nashville forward lines aren't converting 5v5 scoring chances\"\n\nfig.suptitle(fig_title, x=0.5, y=1.1, fontweight=\"bold\", fontsize=14)\n\nsubtitle = f\"NSH top-{max_lines} forward line combinations by 5v5 TOI | 5v5 unblocked shot attempts for & against, sized for xG\"\nfig.text(s=subtitle, x=0.5, y=1.05, fontsize=12, ha=\"center\")\n\nattribution = \"Data & xG model @chickenandstats | Viz @chickenandstats\"\nfig.text(s=attribution, x=0.95, y=-0.02, fontsize=12, ha=\"right\", style=\"italic\")\n\nsavepath = Path(f\"./charts/{team.lower()}_forwards_rink_maps.png\")\nfig.savefig(savepath, transparent=False, bbox_inches=\"tight\")"
  },
  {
    "objectID": "blog/posts/tutorials/rink_maps/index.html#contour-plots",
    "href": "blog/posts/tutorials/rink_maps/index.html#contour-plots",
    "title": "Rink maps",
    "section": "Contour plots",
    "text": "Contour plots\n\nDrawing the rink\nDrawing the rink with the NHLRink class from the hockey-rink library\n\nrink = NHLRink(rotation=90)\n\n\n\nFilter conditions\nSet the team, strength state, minimum TOI, and maximum number of players to plot, then filter the data\n\nteam = \"NSH\"\nstrength_states = [\"5v4\", \"5v3\", \"4v3\"]\npositions = [\"L\", \"C\", \"R\", \"L/R\", \"C/R\", \"R/L\", \"R/C\"]\ntoi_min = 5\nmax_players = 6\ngroup_columns = [\"player\", \"api_id\", \"team\"]  # \"strength_state\"]\n\n\nconditions = (\n    pl.col(\"team\") == team,\n    pl.col(\"strength_state\").is_in(strength_states),\n    pl.col(\"position\").is_in(positions),\n    pl.col(\"toi\") &gt;= toi_min,\n)\n\nplot_stats = (\n    stats.filter(conditions)\n    .group_by(group_columns)\n    .agg([pl.col(\"ixg\").sum(), pl.col(\"g\").sum(), pl.col(\"toi\").sum()])\n    .sort(by=\"toi\", descending=True)\n    .head(max_players)\n)\n\n\n\nTop-N forward shooters\nPlot the top-N forwards’ xG using the hockey-rink library and seaborn’s kdeplot\n\ncmap = \"rocket_r\"\nweights = \"pred_goal_p60\"\n\nfig, axes = plt.subplots(nrows=2, ncols=int(max_players / 2), dpi=650, figsize=(12, 8))\n\nfig.tight_layout(pad=1.5)\n\naxes = axes.reshape(-1)\n\nfor row, player in enumerate(plot_stats.to_dicts()):\n    ax = axes[row]\n\n    rink.draw(ax=ax, display_range=\"ozone\")\n\n    shot_events = [\"MISS\", \"SHOT\", \"GOAL\"]\n\n    plot_conditions = (\n        pl.col(\"player_1\") == player[\"player\"],\n        pl.col(\"player_1_api_id\").cast(str) == str(player[\"api_id\"]),\n        pl.col(\"strength_state\").is_in(strength_states),\n        pl.col(\"event\").is_in(shot_events),\n    )\n\n    toi_minutes = plot_stats.filter(pl.col(\"api_id\") == player[\"api_id\"]).item(0, \"toi\")\n\n    plot_data = pbp.filter(plot_conditions).with_columns(pred_goal_p60=(pl.col(\"pred_goal\") / toi_minutes) * 60)\n\n    plot_data = norm_coords(plot_data, \"player_1_api_id\", str(player[\"api_id\"]))\n\n    rink.plot_fn(\n        sns.kdeplot,\n        data=plot_data,\n        x=\"norm_coords_x\",\n        y=\"norm_coords_y\",\n        cmap=cmap,\n        fill=True,\n        levels=12,\n        weights=plot_data[weights],\n        zorder=100,\n        alpha=0.75,\n        ax=ax,\n        legend=True,\n    )\n\n    rink.plot_fn(\n        sns.kdeplot,\n        data=plot_data,\n        x=\"norm_coords_x\",\n        y=\"norm_coords_y\",\n        cmap=cmap,\n        fill=False,\n        levels=12,\n        linewidths=2,\n        weights=plot_data[weights],\n        zorder=110,\n        alpha=1,\n        ax=ax,\n    )\n\n    ax.set_title(f\"{player['player']}\", x=0.5, y=1.01, ha=\"center\", fontweight=\"bold\", fontsize=10)\n\n\nsave_path = Path(f\"./charts/{team}_top_{max_players}_pp.png\")\n\nfig.savefig(save_path, transparent=False, bbox_inches=\"tight\")"
  },
  {
    "objectID": "blog/posts/tutorials/lollipop/index.html",
    "href": "blog/posts/tutorials/lollipop/index.html",
    "title": "Lollipop chart",
    "section": "",
    "text": "Use the chickenstats library to scrape play-by-play data and plot shot events as a lollipop chart, with the length of the stem indicating the predicted goal value.\nParts of this tutorial are optional and will be clearly marked as such. For help, or any questions, please don’t hesitate to reach out to chicken@chickenandstats.com or @chickenandstats.com on Blue Sky."
  },
  {
    "objectID": "blog/posts/tutorials/lollipop/index.html#intro",
    "href": "blog/posts/tutorials/lollipop/index.html#intro",
    "title": "Lollipop chart",
    "section": "",
    "text": "Use the chickenstats library to scrape play-by-play data and plot shot events as a lollipop chart, with the length of the stem indicating the predicted goal value.\nParts of this tutorial are optional and will be clearly marked as such. For help, or any questions, please don’t hesitate to reach out to chicken@chickenandstats.com or @chickenandstats.com on Blue Sky."
  },
  {
    "objectID": "blog/posts/tutorials/lollipop/index.html#housekeeping",
    "href": "blog/posts/tutorials/lollipop/index.html#housekeeping",
    "title": "Lollipop chart",
    "section": "Housekeeping",
    "text": "Housekeeping\n\nImport dependencies\nImport the dependencies we’ll need for the guide\n\nimport matplotlib.pyplot as plt\nimport matplotlib.ticker as ticker\nimport numpy as np\nimport polars as pl\nfrom matplotlib.lines import Line2D\n\nfrom chickenstats.chicken_nhl import Scraper, Season\nfrom chickenstats.chicken_nhl._helpers import charts_directory\nfrom chickenstats.chicken_nhl.team import NHL_COLORS\n\n\n\nPolars options\nSets different polars options. This cell is optional\n\npl.Config.set_tbl_cols(-1)\n\npolars.config.Config\n\n\n\n\nFolder structure\n\ncharts_directory()\n\n\n\nChickenstats matplotlib style\nchickenstats.utilities includes a custom style package - this activates it. This cell is also optional\n\nplt.style.use(\"chickenstats\")"
  },
  {
    "objectID": "blog/posts/tutorials/lollipop/index.html#scrape-data",
    "href": "blog/posts/tutorials/lollipop/index.html#scrape-data",
    "title": "Lollipop chart",
    "section": "Scrape data",
    "text": "Scrape data\n\nSchedule, standings, and team names\nScrape the schedule and standings using the Season object. Then, create some name dictionaries for convenience later\n\nseason = Season(2025)\n\n\nschedule = season.schedule()  # Progress bar renders poorly in ipynb to md conversions\n\n\n\n\n\n\n\n\nstandings = season.standings  # Standings as a dataframe for the team name dictionaries\n\n\nteam_names = standings.sort(by=\"team_name\", descending=False)[\"team_name\"].str.to_uppercase().to_list()\nteam_codes = standings.sort(by=\"team_name\", descending=False)[\"team\"].str.to_uppercase().to_list()\nteam_names_dict = dict(zip(team_codes, team_names, strict=False))  # These are helpful for later\n\n\n\nGame IDs\nSelect the team and games to plot. The default is the most recent game for the Nashville Predators :). Feel free to change for your chosen team code\n\nteam = \"NSH\"\n\nconditions = (pl.col(\"game_state\") == \"OFF\", ((pl.col(\"home_team\") == team) | (pl.col(\"away_team\") == team)))\n\ngame_ids = schedule.filter(conditions)[\"game_id\"].unique().to_list()\ngame_id = game_ids[-1]\n\n\n\nPlay-by-play\nScrape the play-by-play data for the chosen game ID. First instantiate the Scraper object, then call the play_by_play attribute\n\nscraper = Scraper(game_id)\n\n\npbp = scraper.play_by_play"
  },
  {
    "objectID": "blog/posts/tutorials/lollipop/index.html#plotting-the-lollipop-chart",
    "href": "blog/posts/tutorials/lollipop/index.html#plotting-the-lollipop-chart",
    "title": "Lollipop chart",
    "section": "Plotting the lollipop chart",
    "text": "Plotting the lollipop chart\n\nHelper functions\nThis helper function formats numbers for the x-axis\n\ndef numfmt(x: int, pos) -&gt; str:\n    \"\"\"Function to convert the game-time values as minutes, then format them for the x-axis.\n\n    Used within the matplotlib FuncFormatter.\n\n    Parameters:\n        x (int):\n            The game time, in seconds, to convert.\n        pos:\n            Required by the FuncFormatter\n\n    \"\"\"\n    s = str(int(x / 60))\n    return s\n\n\n\nPlotting function\nThis function plots the actual lollipop chart. You can select the strength states, while the team parameter determines which team is in the upper portion of the chart.\nStrength state options include: * 5v5 * even strength * special teams (i.e., powerplay and shorthanded) * empty net * all strength states\n\ndef plot_lollipop(data: pl.DataFrame, ax: plt.axes, team: str | None = None, strengths: str | None = None) -&gt; plt.axes:\n    \"\"\"Function to plot the lollipop chart, with the given in the upper portion.\n\n    Parameters:\n        data (pl.DataFrame):\n            Play-by-play data for a single game scraped using the chickenstats package.\n        ax (plt.axes):\n            The axes on which to plot the lollipop chart.\n        team (str):\n            Three-letter team code to determine which team is in the upper portion of the chart.\n            Default is the home team\n        strengths (str):\n            The strength states to include in the chart. Default is 5v5\n\n    \"\"\"\n    strengths_dict = {\n        \"5v5\": {\"name\": \"5v5\", \"list\": [\"5v5\"]},\n        \"even\": {\"name\": \"even_strength\", \"list\": [\"5v5\", \"4v4\", \"3v3\"]},\n        \"special\": {\"name\": \"special_teams\", \"list\": [\"5v4\", \"5v3\", \"4v5\", \"3v5\"]},\n        \"empty\": {\"name\": \"empty_net\", \"list\": [\"Ev5\", \"Ev4\", \"Ev3\", \"5vE\", \"4vE\", \"3vE\"]},\n        \"all\": {\"name\": \"all\", \"list\": [\"5v5\", \"4v4\", \"3v3\", \"5v4\", \"5v3\", \"4v5\", \"3v5\"]},\n    }\n\n    if not strengths:\n        strengths = \"5v5\"\n\n    strengths = strengths_dict[strengths]\n\n    strengths_list = strengths[\"list\"]\n\n    condition = pl.col(\"strength_state\").is_in(strengths_list)\n\n    df = data.filter(condition)\n\n    if not team:\n        team = df.item(0, \"home_team\")\n\n    ax.set_ylim(-1.05, 1.05)\n    # ax.axhline(y = 0, lw=1, alpha=.8)\n    ax.axhline(y=0.5, lw=1, zorder=-1, alpha=0.25)\n    ax.axhline(y=1, lw=1, zorder=-1, alpha=0.25)\n    ax.axhline(y=-0.5, lw=1, zorder=-1, alpha=0.25)\n    ax.axhline(y=-1, lw=1, zorder=-1, alpha=0.25)\n    ax.set_yticks([1, 0.5, 0, -0.5, -1], labels=[1, 0.5, 0, 0.5, 1])\n\n    max_game_seconds = data[\"game_seconds\"].max()\n\n    ax.set_xlim(-5, max_game_seconds + 35)\n    ax.spines.bottom.set_position(\"zero\")\n\n    ax.xaxis.set_major_locator(ticker.MultipleLocator(1200))\n\n    xfmt = ticker.FuncFormatter(numfmt)\n    ax.xaxis.set_major_formatter(xfmt)\n    ax.xaxis.set_minor_locator(ticker.MultipleLocator(60))\n\n    ax.set_ylabel(\"EXPECTED GOAL VALUE\", fontsize=8)\n\n    events = [\"GOAL\", \"SHOT\", \"MISS\"]\n\n    conditions = (pl.col(\"event_team\") == team, pl.col(\"event\").is_in(events))\n\n    plot_data = df.filter(conditions)\n\n    team_post = 0\n\n    for play in plot_data.to_dicts():\n        colors = NHL_COLORS[play[\"event_team\"]]\n\n        marker = \"o\"\n\n        facecolor = colors[play[\"event\"]]\n        edgecolor = colors[play[\"event\"]]\n\n        if play[\"event\"] == \"GOAL\":\n            z_order = 3\n            alpha = 1\n            hatch = \"\"\n            edgecolor = colors[\"SHOT\"]\n\n        else:\n            hatch = \"\"\n            alpha = 0.65\n            z_order = 2\n\n        if play[\"event\"] == \"MISS\":\n            if \"POST\" in play[\"description\"]:\n                team_post += 1\n                hatch = \"////////\"\n\n            edgecolor = colors[\"SHOT\"]\n\n        ax.scatter(\n            [play[\"game_seconds\"]],\n            [play[\"pred_goal\"]],\n            marker=marker,\n            s=60,\n            color=facecolor,\n            lw=1.15,\n            ec=edgecolor,\n            zorder=z_order,\n            hatch=hatch,\n            alpha=alpha,\n        )\n        if play[\"event\"] == \"MISS\":\n            edgecolor = colors[\"MISS\"]\n\n        ax.plot(\n            [play[\"game_seconds\"], play[\"game_seconds\"]],\n            [0, play[\"pred_goal\"]],\n            lw=1.85,\n            color=edgecolor,\n            zorder=0,\n            alpha=0.65,\n        )\n\n    conditions = (pl.col(\"event_team\") != team, pl.col(\"event\").is_in(events))\n\n    plot_data = df.filter(conditions)\n\n    not_team_post = 0\n\n    for play in plot_data.to_dicts():\n        colors = NHL_COLORS[play[\"event_team\"]]\n\n        marker = \"o\"\n\n        facecolor = colors[play[\"event\"]]\n        edgecolor = colors[play[\"event\"]]\n\n        if play[\"event\"] == \"GOAL\":\n            z_order = 3\n            alpha = 1\n            edgecolor = colors[\"SHOT\"]\n\n        else:\n            alpha = 0.65\n            z_order = 2\n\n        if play[\"event\"] == \"MISS\":\n            if \"POST\" in play[\"description\"]:\n                hatch = \"////////\"\n\n                not_team_post += 1\n\n            edgecolor = colors[\"SHOT\"]\n\n        ax.scatter(\n            [play[\"game_seconds\"]],\n            [play[\"pred_goal\"] * -1],\n            marker=marker,\n            s=60,\n            color=facecolor,\n            lw=1.15,\n            ec=edgecolor,\n            zorder=z_order,\n            alpha=alpha,\n        )\n\n        if play[\"event\"] == \"MISS\":\n            edgecolor = colors[\"MISS\"]\n\n        ax.plot(\n            [play[\"game_seconds\"], play[\"game_seconds\"]],\n            [0, play[\"pred_goal\"] * -1],\n            lw=1.85,\n            color=edgecolor,\n            zorder=0,\n            alpha=0.65,\n        )\n\n    not_team = df.filter(pl.col(\"event_team\") != team, pl.col(\"event_team\").is_not_null()).item(0, \"event_team\")\n\n    # legends\n\n    legend_handles = []\n\n    for event in [\"GOAL\", \"SHOT\", \"MISS\"]:\n        colors = NHL_COLORS[team]\n\n        linecolor = colors[\"SHOT\"]\n        facecolor = colors[event]\n\n        legend_handle = Line2D(\n            [],\n            [],\n            color=linecolor,\n            markeredgecolor=linecolor,\n            markerfacecolor=facecolor,\n            marker=marker,\n            markersize=5,\n            label=event,\n            alpha=0.65,\n        )\n\n        legend_handles.append(legend_handle)\n\n    legend1 = ax.legend(\n        handles=legend_handles,\n        loc=(0.01, 0.8575),\n        ncols=len(legend_handles),\n        fontsize=\"small\",\n        title=team_names_dict[team],\n        title_fontsize=\"small\",\n    )\n    ax.add_artist(legend1)\n\n    legend_handles = []\n\n    for event in [\"GOAL\", \"SHOT\", \"MISS\"]:\n        colors = NHL_COLORS[not_team]\n\n        linecolor = colors[\"SHOT\"]\n        facecolor = colors[event]\n\n        legend_handle = Line2D(\n            [],\n            [],\n            color=linecolor,\n            markeredgecolor=linecolor,\n            markerfacecolor=facecolor,\n            marker=marker,\n            markersize=5,\n            label=event,\n            alpha=0.65,\n        )\n\n        legend_handles.append(legend_handle)\n\n    legend2 = ax.legend(\n        handles=legend_handles,\n        loc=(0.01, 0.0575),\n        ncols=len(legend_handles),\n        fontsize=\"small\",\n        title=team_names_dict[not_team],\n        title_fontsize=\"small\",\n    )\n    ax.add_artist(legend2)\n\n    team_df = df.filter(pl.col(\"event_team\") == team)\n    team_g = team_df[\"goal\"].sum()\n    team_xg = team_df[\"pred_goal\"].sum()\n\n    not_team_df = df.filter(pl.col(\"event_team\") != team)\n    not_team_g = not_team_df[\"goal\"].sum()\n    not_team_xg = not_team_df[\"pred_goal\"].sum()\n\n    ax_title = f\"{team_names_dict[team]} vs. {team_names_dict[not_team]}\"\n    ax.set_title(ax_title, ha=\"left\", x=-0.055, y=1.06)\n\n    strengths_name = strengths[\"name\"].replace(\"_\", \" \").upper()\n    score_subtitle = f\"{team_g}G ({round(team_xg, 2)} xG) - {not_team_g}G ({round(not_team_xg, 2)} xG)\"\n    game_date = df.item(0, \"game_date\")\n\n    ax_subtitle = f\"{score_subtitle} | {strengths_name} |  {game_date}\"\n    ax.text(s=ax_subtitle, ha=\"left\", x=-0.055, y=1.035, transform=ax.transAxes)\n\n    attribution = \"Viz @chickenandstats.com | xG model @chickenandstats.com\"\n    ax.text(s=attribution, ha=\"right\", x=0.99, y=-0.05, transform=ax.transAxes, fontsize=8, fontstyle=\"italic\")\n\n    return ax\n\n\n\nPlot the lollipop chart\nPlot the lollipop for your chosen team and strength state below. To save the figure, ensure you have a charts folder in your working directory\n\nfig, ax = plt.subplots(dpi=650, figsize=(8, 5))\n\nfig.tight_layout()\n\nax = plot_lollipop(data=pbp, team=team, strengths=\"even\", ax=ax)\n\nfig.savefig(f\"./charts/{game_id}.png\", bbox_inches=\"tight\", transparent=False)"
  },
  {
    "objectID": "blog/posts/tutorials/network/index.html",
    "href": "blog/posts/tutorials/network/index.html",
    "title": "Network charts",
    "section": "",
    "text": "Use the chickenstats library to scrape play-by-play data, aggregate statistics, and generate network graphs for forward line combinations\nParts of this tutorial are optional and will be clearly marked as such. For help, or any questions, please don’t hesitate to reach out to chicken@chickenandstats.com or @chickenandstats.com on Blue Sky."
  },
  {
    "objectID": "blog/posts/tutorials/network/index.html#intro",
    "href": "blog/posts/tutorials/network/index.html#intro",
    "title": "Network charts",
    "section": "",
    "text": "Use the chickenstats library to scrape play-by-play data, aggregate statistics, and generate network graphs for forward line combinations\nParts of this tutorial are optional and will be clearly marked as such. For help, or any questions, please don’t hesitate to reach out to chicken@chickenandstats.com or @chickenandstats.com on Blue Sky."
  },
  {
    "objectID": "blog/posts/tutorials/network/index.html#housekeeping",
    "href": "blog/posts/tutorials/network/index.html#housekeeping",
    "title": "Network charts",
    "section": "Housekeeping",
    "text": "Housekeeping\n\nImport dependencies\nImport the dependencies we’ll need for the guide\n\nfrom pathlib import Path\n\nimport matplotlib.pyplot as plt\nfrom matplotlib.offsetbox import OffsetImage, AnnotationBbox\nimport networkx as nx\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\n\nfrom chickenstats.chicken_nhl import Scraper, Season\nfrom chickenstats.chicken_nhl._helpers import charts_directory\nfrom chickenstats.chicken_nhl.team import NHL_COLORS, Team\n\n\n\nPandas options\nSets different pandas options. This cell is optional\n\npd.set_option(\"display.max_columns\", None)\npd.set_option(\"display.max_rows\", 100)\n\n\n\nFolder structure\n\ncharts_directory()\n\n\n\nChickenstats matplotlib style\nchickenstats.utilities includes a custom style package - this activates it. This cell is also optional\n\nplt.style.use(\"chickenstats\")"
  },
  {
    "objectID": "blog/posts/tutorials/network/index.html#scrape-data",
    "href": "blog/posts/tutorials/network/index.html#scrape-data",
    "title": "Network charts",
    "section": "Scrape data",
    "text": "Scrape data\n\nSchedule, standings, and team names\nScrape the schedule and standings using the Season object. Then, create some name dictionaries for convenience later\n\nseason = Season(2025, backend=\"pandas\")\n\n\nschedule = season.schedule()  # Progress bar renders poorly in ipynb to md conversions\n\n\n\n\n\n\n\n\nstandings = season.standings  # Standings as a dataframe for the team name dictionaries\n\n\nteam_names = standings.sort_values(by=\"team_name\").team_name.str.upper().tolist()\nteam_codes = standings.sort_values(by=\"team_name\").team.str.upper().tolist()\nteam_names_dict = dict(zip(team_codes, team_names, strict=False))  # These are helpful for later\n\n\n\nGame IDs\nSelect the team and games to plot. The default are all of the most recent season’s games for the Nashville Predators :). Feel free to change for your chosen team code\n\nteam = \"NSH\"\n\n\nconditions = np.logical_and(\n    np.logical_or(schedule.home_team == team, schedule.away_team == team), schedule.game_state == \"OFF\"\n)\n\ngame_ids = schedule.loc[conditions].game_id.tolist()\nlatest_date = schedule.loc[conditions].game_date.max()\n\n\n\nPlay-by-play\nScrape the play-by-play data for the chosen game ID. First instantiate the Scraper object, then call the play_by_play attribute\n\nscraper = Scraper(game_ids, backend=\"pandas\")\n\n\npbp = scraper.play_by_play.copy(deep=True)\n\n\n\n\n\n\n\n\n\nStats\nAggregate individual statistics after scraping the play-by-play data\n\nscraper.prep_stats(level=\"season\", teammates=True)\n\n\n\n\n\n\n\n\nstats = scraper.stats.copy(deep=True)"
  },
  {
    "objectID": "blog/posts/tutorials/network/index.html#plotting-network-data",
    "href": "blog/posts/tutorials/network/index.html#plotting-network-data",
    "title": "Network charts",
    "section": "Plotting network data",
    "text": "Plotting network data\n\nHelper functions\nCreate and draw the network graphs in a convenient plotting function\n\ndef create_network_graph(data: pd.DataFrame, team: str, strengths: list, toi_min: float) -&gt; nx.Graph:\n    \"\"\"Creates a network for a given team and strength state, with time-on-ice as the weight.\n\n    Parameters:\n        data (pd.DataFrame):\n            Pandas dataframe of individual statistics, aggregated from play-by-play\n            data scraped with chickenstats package\n        team (str):\n            Three-letter team code which determines the coloring used for the chart\n        strengths (list):\n            List of strength states to aggregate for data\n    \"\"\"\n    conds = np.logical_and.reduce(\n        [\n            data.team == team,\n            data.strength_state.isin(strengths),\n            data.toi &gt;= toi_min,\n            data.position.isin([\"C\", \"L\", \"R\", \"L/R\", \"L/C\", \"R/L\", \"R/C\", \"C/L\", \"C/R\"]),\n        ]\n    )\n\n    df = data.loc[conds].reset_index(drop=True)\n\n    players = df.player.sort_values().unique().tolist()\n\n    concat_list = [df.player.copy(deep=True)]\n\n    for player in players:\n        conds = [\n            df.player == player,\n            np.logical_and(\n                df.player != player, np.logical_or(df.forwards.str.contains(player), df.defense.str.contains(player))\n            ),\n        ]\n\n        values = [np.nan, df.toi]\n\n        player_series = pd.Series(np.select(conds, values, 0), name=player)\n\n        concat_list.append(player_series)\n\n    df = pd.concat(concat_list, axis=1).groupby(\"player\", as_index=False).sum()\n\n    df = df.set_index(\"player\", drop=True)\n\n    df = (df - df.min().min()) / (df.max().max() - df.min().min()) * 75\n\n    df = df.reset_index()\n\n    df = df.melt(\n        id_vars=[\"player\"], value_vars=[x for x in df.columns if x != \"player\"], var_name=\"target\", value_name=\"weight\"\n    ).rename(columns={\"player\": \"source\"})\n\n    network_graph = nx.from_pandas_edgelist(df, edge_attr=True)\n\n    return network_graph\n\n\ndef draw_graph(g: nx.Graph, team: str, edge_options: dict, edge_labels: dict | None = None) -&gt; plt.Figure:\n    \"\"\"Draws the graph G with the specified node and edge options.\n\n    Parameters:\n        g (networkx.Graph):\n            The graph to be drawn.\n        team (str):\n            Team code for colors.\n        edge_options (dict):\n            Options for drawing edges.\n        edge_labels (dict, optional):\n            Labels for the edges. Defaults to None.\n    \"\"\"\n    fig, ax = plt.subplots(dpi=650, figsize=(8, 5))\n\n    # Global color properties\n    node_options = {\n        \"node_color\": NHL_COLORS[team][\"GOAL\"],\n        \"node_size\": 1000,\n        \"edgecolors\": NHL_COLORS[team][\"SHOT\"],\n        \"linewidths\": 2,\n    }\n\n    # Define the layout of the graph\n    pos = nx.spring_layout(g, iterations=10, seed=20000)\n\n    # Draw the nodes with the specified options\n    nx.draw_networkx_nodes(g, pos, **node_options)\n\n    # Draw the node labels with specified font properties\n    nx.draw_networkx_labels(\n        g,\n        pos,\n        font_size=8,\n        font_color=NHL_COLORS[team][\"SHOT\"],\n        font_weight=\"bold\",\n        bbox={\"alpha\": 0.5, \"color\": \"white\"},\n    )\n\n    # Draw the edges with the specified options\n    nx.draw_networkx_edges(g, pos, **edge_options)\n\n    # Draw edge labels if they are provided\n    if edge_labels:\n        nx.draw_networkx_edge_labels(\n            g,\n            pos,\n            edge_labels=edge_labels,\n            connectionstyle=\"arc3, rad=0.3\",\n            font_size=12,\n            font_color=NHL_COLORS[team][\"MISS\"],\n            bbox={\"alpha\": 0.5, \"color\": \"white\"},\n        )\n\n    sns.despine(left=True, bottom=True)\n\n    logo = Team(team).logo\n\n    imagebox = OffsetImage(logo, zoom=0.15, alpha=0.15, zorder=-10)\n    imagebox.image.axes = ax\n\n    ab = AnnotationBbox(imagebox, (0.5, 0.5), xycoords=\"axes fraction\", bboxprops={\"lw\": 0}, alpha=0, zorder=-10)\n\n    ax.add_artist(ab)\n\n    return fig\n\n\ndef plot_network(stats: pd.DataFrame, team: str, strengths: list, toi_min: float, edge_labels=None):\n    \"\"\"This function plots and saves the actual matplotlib figures.\n\n    Parameters:\n        stats (pd.DataFrame):\n            Pandas dataframe of individual statistics, aggregated from play-by-play\n            data scraped with chickenstats package\n        team (str):\n            Three-letter team code which determines the coloring used for the chart\n        strengths (list):\n            List of strength states to plot and pass to the network graph function\n        edge_labels (dict, optional):\n            Labels for the edges\n    \"\"\"\n    g = create_network_graph(data=stats, team=team, strengths=strengths, toi_min=toi_min)\n\n    weights = nx.get_edge_attributes(g, \"weight\")\n\n    edge_options = {\n        \"edge_color\": NHL_COLORS[team][\"SHOT\"],\n        #'width': 2.5,\n        \"alpha\": 0.7,\n        \"width\": [weights[edge] / 10 for edge in g.edges()],\n    }\n\n    fig = draw_graph(g=g, edge_options=edge_options, team=team, edge_labels=edge_labels)\n\n    fig_suptitle = f\"{team_names_dict[team].title()} forward line combinations at 5v5\"\n    fig.suptitle(fig_suptitle, x=0.01, y=1.08, fontsize=11, fontweight=\"bold\", horizontalalignment=\"left\")\n\n    subtitle = f\"Width of connecting line indicates time-on-ice | 2025-26 season, as of {latest_date}\"\n    fig.text(s=subtitle, x=0.01, y=1.02, fontsize=10, horizontalalignment=\"left\")\n\n    # Attribution\n    attribution = \"Data & xG model @chickenandstats.com | Viz @chickenandstats.com\"\n    fig.text(s=attribution, x=0.99, y=-0.05, fontsize=8, horizontalalignment=\"right\", style=\"italic\")\n\n    # Save figure\n    save_path = Path(f\"./charts/{team.lower()}_network_graph.png\")\n    fig.savefig(save_path, transparent=False, bbox_inches=\"tight\")"
  },
  {
    "objectID": "blog/posts/tutorials/network/index.html#plotting-the-data",
    "href": "blog/posts/tutorials/network/index.html#plotting-the-data",
    "title": "Network charts",
    "section": "Plotting the data",
    "text": "Plotting the data\n\nNSH network chart\nPlot the network chart with the cell below\n\nplot_network(stats=stats, team=team, strengths=[\"5v5\"], toi_min=15.0)"
  },
  {
    "objectID": "blog/posts/tennessee_titans/titans_qbs/index.html#housekeeping",
    "href": "blog/posts/tennessee_titans/titans_qbs/index.html#housekeeping",
    "title": "How does Cam Ward stack up?",
    "section": "Housekeeping",
    "text": "Housekeeping\n\nImport dependencies and set options\n\n# chickenstats library and utilities\nfrom chickenstats.chicken_nhl._helpers import charts_directory\n\nimport nflreadpy as nfl\n\nimport polars as pl\n\n\n# plotting library and utilities\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# miscellaneous utilities\nfrom pathlib import Path\n\n\npl.Config.set_tbl_cols(-1)\npl.Config.set_tbl_rows(30)\n\npolars.config.Config\n\n\n\n\nCreate directory for charts\n\ncharts_directory()\n\n\n\nchickenstats matplotlib styles\n\nplt.style.use(\"chickenstats\")  # this is available when you import chickenstats.utilities"
  },
  {
    "objectID": "blog/posts/tennessee_titans/titans_qbs/index.html#downloading-and-prepping-data",
    "href": "blog/posts/tennessee_titans/titans_qbs/index.html#downloading-and-prepping-data",
    "title": "How does Cam Ward stack up?",
    "section": "Downloading and prepping data",
    "text": "Downloading and prepping data\n\nPlayer stats\n\nseasons = list(range(2002, 2026))\n\nplayer_stats = nfl.load_player_stats(seasons=seasons)\n\n\nconditions = (pl.col(\"player_id\") != \"0\", pl.col(\"player_name\").is_not_null())\n\nplayer_stats = player_stats.filter(conditions)\n\n\n\nRosters\n\nrosters = nfl.load_rosters_weekly(seasons=seasons)\n\n\nrosters = rosters.filter(pl.col(\"status\") == \"ACT\")\n\n\n\nAdding years of experience\n\ncolumns = (pl.col(\"season\"), pl.col(\"gsis_id\").alias(\"player_id\"), pl.col(\"week\"), pl.col(\"years_exp\"))\n\nmerge_columns = [\"season\", \"player_id\", \"week\"]\n\nplayer_stats = player_stats.join(rosters.select(columns), on=merge_columns)\n\n\n\nAggregating to season level\n\ngroup_columns = [\n    \"player_id\",\n    \"player_name\",\n    \"player_display_name\",\n    \"position\",\n    \"position_group\",\n    \"season\",\n    \"season_type\",\n    \"team\",\n    \"years_exp\",\n]\n\ngroup_columns = (pl.col(x) for x in group_columns)\n\nsum_columns = [\n    \"completions\",\n    \"attempts\",\n    \"passing_yards\",\n    \"passing_tds\",\n    \"passing_interceptions\",\n    \"sacks_suffered\",\n    \"sack_yards_lost\",\n    \"sack_fumbles\",\n    \"sack_fumbles_lost\",\n    \"passing_air_yards\",\n    \"passing_yards_after_catch\",\n    \"passing_first_downs\",\n    \"passing_epa\",\n    \"passing_2pt_conversions\",\n    \"carries\",\n    \"rushing_yards\",\n    \"rushing_tds\",\n    \"rushing_fumbles\",\n    \"rushing_fumbles_lost\",\n    \"rushing_first_downs\",\n    \"rushing_epa\",\n    \"rushing_2pt_conversions\",\n    \"receptions\",\n    \"targets\",\n    \"receiving_yards\",\n    \"receiving_tds\",\n    \"receiving_fumbles\",\n    \"receiving_fumbles_lost\",\n    \"receiving_air_yards\",\n    \"receiving_yards_after_catch\",\n    \"receiving_first_downs\",\n    \"receiving_epa\",\n    \"receiving_2pt_conversions\",\n    \"special_teams_tds\",\n    \"def_tackles_solo\",\n    \"def_tackles_with_assist\",\n    \"def_tackle_assists\",\n    \"def_tackles_for_loss\",\n    \"def_tackles_for_loss_yards\",\n    \"def_fumbles_forced\",\n    \"def_sacks\",\n    \"def_sack_yards\",\n    \"def_qb_hits\",\n    \"def_interceptions\",\n    \"def_interception_yards\",\n    \"def_pass_defended\",\n    \"def_tds\",\n    \"def_fumbles\",\n    \"def_safeties\",\n    \"misc_yards\",\n    \"fumble_recovery_own\",\n    \"fumble_recovery_yards_own\",\n    \"fumble_recovery_opp\",\n    \"fumble_recovery_yards_opp\",\n    \"fumble_recovery_tds\",\n    \"penalties\",\n    \"penalty_yards\",\n    \"punt_returns\",\n    \"punt_return_yards\",\n    \"kickoff_returns\",\n    \"kickoff_return_yards\",\n    \"fg_made\",\n    \"fg_att\",\n    \"fg_missed\",\n    \"fg_blocked\",\n    \"fg_long\",\n    \"fg_made_0_19\",\n    \"fg_made_20_29\",\n    \"fg_made_30_39\",\n    \"fg_made_40_49\",\n    \"fg_made_50_59\",\n    \"fg_made_60_\",\n    \"fg_missed_0_19\",\n    \"fg_missed_20_29\",\n    \"fg_missed_30_39\",\n    \"fg_missed_40_49\",\n    \"fg_missed_50_59\",\n    \"fg_missed_60_\",\n    \"pat_made\",\n    \"pat_att\",\n    \"pat_missed\",\n    \"pat_blocked\",\n    \"pat_pct\",\n    \"gwfg_made\",\n    \"gwfg_att\",\n    \"gwfg_missed\",\n    \"gwfg_blocked\",\n    \"gwfg_distance\",\n    \"fantasy_points\",\n    \"fantasy_points_ppr\",\n]\n\nsum_columns = (pl.col(x).sum().alias(f\"{x}_sum\") for x in sum_columns)\n\nmean_columns = [\"passing_cpoe\", \"target_share\", \"air_yards_share\", \"pacr\", \"racr\", \"wopr\"]\n\nmean_columns = (pl.col(x).mean().alias(f\"{x}_mean\") for x in mean_columns)\n\nagg_columns = (*sum_columns, *mean_columns)\n\n\nplayer_stats = player_stats.group_by(group_columns).agg(agg_columns)\n\n\n\nGetting QB stats\n\nconditions = (\n    pl.col(\"player_id\") != \"0\",\n    pl.col(\"player_name\").is_not_null(),\n    pl.col(\"position\") == \"QB\",\n    pl.col(\"attempts_sum\") &gt;= 1,\n    pl.col(\"season_type\") == \"REG\",\n    pl.col(\"years_exp\") == 0,\n)\n\nqb_stats = player_stats.filter(conditions)\n\n\nqb_stats = qb_stats.with_columns(epa_per_attempt=pl.col(\"passing_epa_sum\") / pl.col(\"attempts_sum\"))"
  },
  {
    "objectID": "blog/posts/tennessee_titans/titans_qbs/index.html#plotting-data",
    "href": "blog/posts/tennessee_titans/titans_qbs/index.html#plotting-data",
    "title": "How does Cam Ward stack up?",
    "section": "Plotting data",
    "text": "Plotting data\n\nSetting team and other values\n\nteam = \"TEN\"\nlight_blue = \"#4B92DB\"\nnavy = \"#002244\"\nred = \"#C60C30\"\ngray = \"#D3D3D3\"\n\n\n\nScatter plot\n\n# Setting overall figures\nfig, ax = plt.subplots(dpi=650, figsize=(8, 5))\n\n# Aesthetics, likes the tight layout and despining axes\nfig.tight_layout()\nsns.despine()\n\n# Setting the x, y, and z values\n\nx_col = \"attempts_sum\"\ny_col = \"passing_epa_sum\"\nsize_col = \"passing_tds_sum\"\n\n# Getting the averages and drawing the average lines\nx_mean = qb_stats.select(pl.col(x_col)).mean().item(0, 0)\ny_mean = qb_stats.select(pl.col(y_col)).mean().item(0, 0)\n\nax.axvline(x=x_mean, zorder=-1, alpha=0.5)\nax.axhline(y=y_mean, zorder=-1, alpha=0.5)\n\n# Setting the size norm so bubbles are consistent across figures\nsize_min = qb_stats.select(pl.col(size_col)).min().item(0, 0)\nsize_max = qb_stats.select(pl.col(size_col)).max().item(0, 0)\n\nsize_norm = (size_min, size_max)\nsizes = (20, 150)\n\n# Filtering data and plotting the non-selected teams first\nplot_data = qb_stats.filter(pl.col(\"team\") != team)\n\n# They all get gray colors\nfacecolor = gray\nedgecolor = \"white\"\n\n# Plotting the non-selected teams' data\nsns.scatterplot(\n    x=plot_data[x_col],\n    y=plot_data[y_col],\n    size=plot_data[size_col],\n    sizes=sizes,\n    size_norm=size_norm,\n    lw=1.5,\n    facecolor=facecolor,\n    edgecolor=edgecolor,\n    alpha=0.5,\n    legend=False,\n)\n\n# Filtering the data and plotting the selected team\nplot_data = qb_stats.filter(pl.col(\"team\") == team)\n\n# Setting the colors\nfacecolor = light_blue\nedgecolor = navy\n\n# Plotting the selected teams' data\nsns.scatterplot(\n    x=plot_data[x_col],\n    y=plot_data[y_col],\n    size=plot_data[size_col],\n    sizes=sizes,\n    size_norm=size_norm,\n    lw=1.5,\n    facecolor=facecolor,\n    edgecolor=edgecolor,\n    alpha=0.5,\n    legend=False,\n)\n\n# Labeling Cam Ward\n\nplayer_list = [\n    \"C.Ward\",\n    \"P.Mahomes\",\n    \"R.Wilson\",\n    \"J.Burrow\",\n    \"D.Prescott\",\n    \"J.Herbert\",\n    \"R.Griffin\",\n    \"M.Ryan\",\n    \"C.Stroud\",\n    \"J.Daniels\",\n    \"B.Roethlisberger\",\n    \"M.Jones\",\n    \"C.Newton\",\n    \"J.Burrow\",\n    \"J.Winston\",\n    \"B.Purdy\",\n    \"B.Nix\",\n    \"B.Mayfield\",\n    \"D.Watson\",\n    \"C.Kessler\",\n    \"M.Penix\",\n    \"D.Lock\",\n    \"A.Luck\",\n    \"K.Allen\",\n    \"K.Cousins\",\n    \"J.Milton\",\n    \"T.Lance\",\n    \"T.Tebow\",\n    \"J.Locker\",\n    \"M.Mariota\",\n    \"W.Levis\",\n    \"R.Smith\",\n    \"Z.Mettenberger\",\n    \"M.Willis\",\n    \"V.Young\",\n    \"B.Young\",\n    \"J.Rosen\",\n    \"D.Carr\",\n    \"B.Bortles\",\n    \"D.Kizer\",\n]\n\nlabel_data = qb_stats.filter(pl.col(\"player_name\").is_in(player_list), pl.col(\"years_exp\") == 0)\n\nx_offset = -50\ny_offset = -15\n\nfor player_data in label_data.iter_rows(named=True):\n    x_position = player_data[x_col] + x_offset\n    y_position = player_data[y_col] + y_offset\n\n    arrow_props = {\"arrowstyle\": \"simple\", \"linewidth\": 0.25, \"color\": \"tab:gray\"}\n\n    # Plotting the annotation\n    ax.annotate(\n        text=f\"{player_data['player_display_name']}\",\n        xy=(player_data[x_col], player_data[y_col]),\n        xytext=(x_position, y_position),\n        fontsize=6,\n        bbox={\"facecolor\": \"white\", \"alpha\": 0.5, \"edgecolor\": \"white\", \"pad\": 0},\n        arrowprops=arrow_props,\n    )\n\n# Iterating through the dataframe to label the bubbles\n# for row, player in plot_data.iterrows():\n#     # Setting x and y positions that are slightly offset from the data they point to\n#     x_position = player.xga_p60 + 0.25\n#     y_position = player.xgf_p60 - 0.25\n\n#     # Annotation options\n#     arrow_props = {\"arrowstyle\": \"simple\", \"linewidth\": 0.25, \"color\": \"tab:gray\"}\n\n#     # Plotting the annotation\n#     ax.annotate(\n#         text=f\"{player.player}\",\n#         xy=(player.xga_p60, player.xgf_p60),\n#         xytext=(x_position, y_position),\n#         fontsize=6,\n#         bbox={\"facecolor\": \"white\", \"alpha\": 0.5, \"edgecolor\": \"white\", \"pad\": 0},\n#         arrowprops=arrow_props,\n#     )\n\n# Setting axis lables\nax.axes.set_xlabel(\"Total Passing Attempts\")\nax.axes.set_ylabel(\"Total Passing EPA\")\n\n# Setting figure suptitle and subtitle\nfig_suptitle = \"Title\"\nfig.suptitle(fig_suptitle, x=0.01, y=1.08, fontsize=11, fontweight=\"bold\", horizontalalignment=\"left\")\n\nsubtitle = \"Total Passing EPA and Attempts, Sized for Passing TDs | NFL Rookie Seasons 2002-25\"\nfig.text(s=subtitle, x=0.01, y=1.02, fontsize=10, horizontalalignment=\"left\")\n\n# Attribution\nattribution = \"Data & EPA model: nflreadpy python package  | Viz @chickenandstats\"\nfig.text(s=attribution, x=0.99, y=-0.05, fontsize=8, horizontalalignment=\"right\", style=\"italic\")\n\n# Save figure\nsavepath = Path(f\"./charts/epa_attempt_attempts_{team}.png\")\n# fig.savefig(savepath, transparent=False, bbox_inches=\"tight\")\n\n\n\n\n\n\n\n\n\nqb_stats.filter(pl.col(\"player_name\").str.contains(\"V.Young\"))\n# qb_stats.sort(\"passing_epa_sum\", descending=True).head(25)[\"player_name\"].unique().to_list()\nqb_stats.filter(pl.col(\"years_exp\") == 0).sort(\"passing_epa_sum\", descending=True).tail(25)\n\n\nshape: (25, 106)\n\n\n\nplayer_id\nplayer_name\nplayer_display_name\nposition\nposition_group\nseason\nseason_type\nteam\nyears_exp\ncompletions_sum\nattempts_sum\npassing_yards_sum\npassing_tds_sum\npassing_interceptions_sum\nsacks_suffered_sum\nsack_yards_lost_sum\nsack_fumbles_sum\nsack_fumbles_lost_sum\npassing_air_yards_sum\npassing_yards_after_catch_sum\npassing_first_downs_sum\npassing_epa_sum\npassing_2pt_conversions_sum\ncarries_sum\nrushing_yards_sum\nrushing_tds_sum\nrushing_fumbles_sum\nrushing_fumbles_lost_sum\nrushing_first_downs_sum\nrushing_epa_sum\nrushing_2pt_conversions_sum\nreceptions_sum\ntargets_sum\nreceiving_yards_sum\nreceiving_tds_sum\nreceiving_fumbles_sum\nreceiving_fumbles_lost_sum\nreceiving_air_yards_sum\nreceiving_yards_after_catch_sum\nreceiving_first_downs_sum\nreceiving_epa_sum\nreceiving_2pt_conversions_sum\nspecial_teams_tds_sum\ndef_tackles_solo_sum\ndef_tackles_with_assist_sum\ndef_tackle_assists_sum\ndef_tackles_for_loss_sum\ndef_tackles_for_loss_yards_sum\ndef_fumbles_forced_sum\ndef_sacks_sum\ndef_sack_yards_sum\ndef_qb_hits_sum\ndef_interceptions_sum\ndef_interception_yards_sum\ndef_pass_defended_sum\ndef_tds_sum\ndef_fumbles_sum\ndef_safeties_sum\nmisc_yards_sum\nfumble_recovery_own_sum\nfumble_recovery_yards_own_sum\nfumble_recovery_opp_sum\nfumble_recovery_yards_opp_sum\nfumble_recovery_tds_sum\npenalties_sum\npenalty_yards_sum\npunt_returns_sum\npunt_return_yards_sum\nkickoff_returns_sum\nkickoff_return_yards_sum\nfg_made_sum\nfg_att_sum\nfg_missed_sum\nfg_blocked_sum\nfg_long_sum\nfg_made_0_19_sum\nfg_made_20_29_sum\nfg_made_30_39_sum\nfg_made_40_49_sum\nfg_made_50_59_sum\nfg_made_60__sum\nfg_missed_0_19_sum\nfg_missed_20_29_sum\nfg_missed_30_39_sum\nfg_missed_40_49_sum\nfg_missed_50_59_sum\nfg_missed_60__sum\npat_made_sum\npat_att_sum\npat_missed_sum\npat_blocked_sum\npat_pct_sum\ngwfg_made_sum\ngwfg_att_sum\ngwfg_missed_sum\ngwfg_blocked_sum\ngwfg_distance_sum\nfantasy_points_sum\nfantasy_points_ppr_sum\npassing_cpoe_mean\ntarget_share_mean\nair_yards_share_mean\npacr_mean\nracr_mean\nwopr_mean\nepa_per_attempt\n\n\nstr\nstr\nstr\nstr\nstr\ni32\nstr\nstr\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\nf64\ni32\ni32\ni32\ni32\ni32\ni32\ni32\nf64\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\nf64\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\nf64\nf64\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\ni32\nf64\ni32\ni32\ni32\ni32\ni32\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\n\n\n\n\n\"00-0035652\"\n\"R.Finley\"\n\"Ryan Finley\"\n\"QB\"\n\"QB\"\n2019\n\"REG\"\n\"CIN\"\n0\n41\n87\n474\n2\n2\n11\n-93\n4\n3\n721\n203\n20\n-52.636759\n0\n10\n77\n0\n0\n0\n5\n0.280104\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n24.66\n24.66\n-15.687838\n0.0\n0.0\n0.65507\nnull\n0.0\n-0.60502\n\n\n\"00-0027950\"\n\"C.Ponder\"\n\"Christian Ponder\"\n\"QB\"\n\"QB\"\n2011\n\"REG\"\n\"MIN\"\n0\n158\n291\n1853\n13\n13\n30\n-164\n5\n2\n2667\n831\n91\n-56.446926\n0\n28\n219\n0\n1\n0\n15\n17.573881\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n2\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n2\n25\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n118.02\n118.02\n-7.464352\n0.0\n0.0\n0.691941\nnull\n0.0\n-0.193976\n\n\n\"00-0026993\"\n\"J.Freeman\"\n\"Josh Freeman\"\n\"QB\"\n\"QB\"\n2009\n\"REG\"\n\"TB\"\n0\n159\n291\n1857\n10\n18\n19\n-102\n5\n1\n2649\n658\n89\n-58.254535\n1\n31\n162\n0\n4\n1\n15\n2.430892\n1\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n5\n7\n0\n0\n0\n3\n15\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n94.58\n94.58\n-4.683177\n0.0\n0.0\n0.733723\n0.0\n0.0\n-0.200187\n\n\n\"00-0030565\"\n\"G.Smith\"\n\"Geno Smith\"\n\"QB\"\n\"QB\"\n2013\n\"REG\"\n\"NYJ\"\n0\n247\n443\n3046\n12\n21\n43\n-315\n4\n3\n3963\n1260\n143\n-59.77581\n0\n72\n366\n6\n4\n1\n28\n14.142214\n0\n1\n1\n13\n0\n0\n0\n13\n0\n1\n1.309993\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n3\n4\n0\n0\n0\n5\n21\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n193.74\n194.74\n-4.97212\n0.002604\n0.002871\n0.874442\n1.0\n0.005916\n-0.134934\n\n\n\"00-0036971\"\n\"T.Lawrence\"\n\"Trevor Lawrence\"\n\"QB\"\n\"QB\"\n2021\n\"REG\"\n\"JAX\"\n0\n359\n602\n3641\n12\n17\n32\n-238\n6\n5\n4738\n1634\n178\n-60.74786\n2\n73\n334\n2\n2\n0\n23\n11.314142\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n2\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n2\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n199.04\n199.04\n-4.281167\n0.0\n0.0\n0.822605\nnull\n0.0\n-0.10091\n\n\n\"00-0031280\"\n\"D.Carr\"\n\"Derek Carr\"\n\"QB\"\n\"QB\"\n2014\n\"REG\"\n\"LV\"\n0\n348\n599\n3270\n21\n12\n24\n-149\n4\n2\n4664\n1462\n165\n-61.50931\n0\n29\n92\n0\n5\n2\n15\n-11.191634\n0\n0\n1\n0\n0\n0\n0\n17\n0\n0\n-0.504618\n0\n0\n1\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n4\n8\n0\n0\n0\n9\n65\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n192.0\n192.0\n-5.982209\n0.001179\n0.002426\n0.730652\n0.0\n0.003467\n-0.102687\n\n\n\"00-0040398\"\n\"B.Cook\"\n\"Brady Cook\"\n\"QB\"\n\"QB\"\n2025\n\"REG\"\n\"NYJ\"\n0\n77\n131\n679\n1\n7\n18\n-118\n2\n1\n794\n385\n30\n-62.011141\n0\n10\n42\n0\n1\n0\n5\n-3.80431\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n2\n3\n0\n0\n0\n1\n10\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n19.36\n19.36\n-8.473645\n0.0\n0.0\n0.903789\nnull\n0.0\n-0.473367\n\n\n\"00-0036945\"\n\"J.Fields\"\n\"Justin Fields\"\n\"QB\"\n\"QB\"\n2021\n\"REG\"\n\"CHI\"\n0\n159\n270\n1870\n7\n10\n36\n-264\n8\n4\n2645\n683\n83\n-64.928772\n0\n72\n420\n2\n4\n1\n26\n6.727855\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n4\n6\n0\n0\n0\n2\n10\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n126.8\n126.8\n-1.590425\n0.0\n0.0\n0.768913\nnull\n0.0\n-0.240477\n\n\n\"00-0026898\"\n\"M.Sanchez\"\n\"Mark Sanchez\"\n\"QB\"\n\"QB\"\n2009\n\"REG\"\n\"NYJ\"\n0\n196\n363\n2444\n12\n20\n26\n-195\n8\n3\n3407\n997\n123\n-71.400733\n2\n36\n106\n3\n2\n0\n18\n7.100561\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n2\n2\n0\n0\n0\n8\n72\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n132.36\n132.36\n-5.202597\n0.0\n0.0\n0.775397\nnull\n0.0\n-0.196696\n\n\n\"00-0039376\"\n\"S.Rattler\"\n\"Spencer Rattler\"\n\"QB\"\n\"QB\"\n2024\n\"REG\"\n\"NO\"\n0\n130\n228\n1317\n4\n5\n22\n-136\n4\n3\n1834\n642\n63\n-75.739327\n0\n18\n146\n0\n1\n0\n8\n13.575403\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n67.28\n67.28\n-10.31886\n0.0\n0.0\n0.750064\nnull\n0.0\n-0.33219\n\n\n\"00-0024408\"\n\"B.Gradkowski\"\n\"Bruce Gradkowski\"\n\"QB\"\n\"QB\"\n2006\n\"REG\"\n\"TB\"\n0\n177\n328\n1661\n9\n9\n25\n-146\n7\n3\n2241\n794\n79\n-84.508159\n0\n41\n161\n0\n4\n3\n14\n-7.189951\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n2\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n3\n4\n0\n0\n0\n2\n25\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n88.54\n88.54\n-4.785349\nNaN\n0.0\n1.13587\nnull\nNaN\n-0.257647\n\n\n\"00-0023436\"\n\"A.Smith\"\n\"Alex Smith\"\n\"QB\"\n\"QB\"\n2005\n\"REG\"\n\"SF\"\n0\n84\n165\n875\n1\n11\n29\n-185\n9\n2\n0\n875\n37\n-85.504377\n0\n30\n103\n0\n2\n1\n5\n-11.978286\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n6\n8\n0\n0\n0\n4\n19\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n21.3\n21.3\nnull\nNaN\nNaN\n0.0\nnull\nNaN\n-0.518208\n\n\n\"00-0033106\"\n\"J.Goff\"\n\"Jared Goff\"\n\"QB\"\n\"QB\"\n2016\n\"REG\"\n\"LA\"\n0\n112\n205\n1089\n5\n7\n26\n-222\n5\n2\n1409\n572\n47\n-86.709483\n0\n8\n16\n1\n0\n0\n2\n0.238419\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n1\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n1\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n53.16\n53.16\n-11.053336\n0.0\n0.0\n0.837851\nnull\n0.0\n-0.422973\n\n\n\"00-0021141\"\n\"J.Harrington\"\n\"Joey Harrington\"\n\"QB\"\n\"QB\"\n2002\n\"REG\"\n\"DET\"\n0\n215\n429\n2294\n12\n16\n8\n-75\n1\n1\n166\n2294\n110\n-86.779541\n0\n7\n4\n0\n1\n0\n1\n-8.771017\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n1\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n106.16\n106.16\nnull\n0.0\nNaN\n24.639077\nnull\nNaN\n-0.202283\n\n\n\"00-0029531\"\n\"R.Lindley\"\n\"Ryan Lindley\"\n\"QB\"\n\"QB\"\n2012\n\"REG\"\n\"ARI\"\n0\n89\n171\n752\n0\n7\n12\n-91\n2\n2\n1406\n262\n38\n-87.941983\n0\n4\n7\n0\n1\n0\n2\n-2.622497\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n1\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n12.78\n12.78\n-12.828982\n0.0\n0.0\n0.574158\nnull\n0.0\n-0.514281\n\n\n\"00-0027659\"\n\"J.Clausen\"\n\"Jimmy Clausen\"\n\"QB\"\n\"QB\"\n2010\n\"REG\"\n\"CAR\"\n0\n157\n299\n1558\n3\n9\n33\n-223\n1\n0\n1974\n813\n73\n-92.992759\n0\n23\n57\n0\n7\n2\n10\n-22.119157\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n1\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n3\n8\n0\n0\n0\n2\n23\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n58.02\n58.02\n-12.385229\n0.0\n0.0\n0.798837\nnull\n0.0\n-0.311013\n\n\n\"00-0020562\"\n\"C.Hutchinson\"\n\"Chad Hutchinson\"\n\"QB\"\n\"QB\"\n2002\n\"REG\"\n\"DAL\"\n0\n127\n250\n1555\n7\n8\n34\n-265\n12\n8\n137\n1555\n63\n-94.5604\n0\n18\n74\n0\n0\n0\n3\n-4.270921\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n1\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n65.6\n65.6\nnull\n0.0\nNaN\n18.174022\nnull\nNaN\n-0.378242\n\n\n\"00-0037013\"\n\"Z.Wilson\"\n\"Zach Wilson\"\n\"QB\"\n\"QB\"\n2021\n\"REG\"\n\"NYJ\"\n0\n213\n383\n2334\n9\n11\n44\n-370\n4\n1\n2885\n1099\n112\n-95.573186\n1\n29\n185\n4\n0\n0\n10\n7.612972\n1\n0\n1\n0\n0\n0\n0\n8\n0\n0\n-0.740859\n0\n0\n1\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n3\n3\n0\n0\n0\n1\n10\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n151.86\n151.86\n-9.820057\n0.003497\n0.004558\n0.896501\n0.0\n0.008436\n-0.249538\n\n\n\"00-0027948\"\n\"B.Gabbert\"\n\"Blaine Gabbert\"\n\"QB\"\n\"QB\"\n2011\n\"REG\"\n\"JAX\"\n0\n210\n413\n2214\n12\n11\n40\n-293\n5\n3\n3216\n1135\n110\n-101.764242\n0\n48\n98\n0\n8\n1\n17\n-14.178523\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n1\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n3\n10\n0\n0\n0\n3\n26\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n116.36\n116.36\n-8.846946\n0.0\n0.0\n0.803466\nnull\n0.0\n-0.246403\n\n\n\"00-0033899\"\n\"D.Kizer\"\n\"DeShone Kizer\"\n\"QB\"\n\"QB\"\n2017\n\"REG\"\n\"CLE\"\n0\n255\n476\n2894\n11\n22\n38\n-226\n6\n5\n4272\n1440\n130\n-112.868852\n0\n77\n419\n5\n3\n1\n34\n18.41577\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n2\n5\n0\n0\n0\n3\n15\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n175.66\n175.66\n-5.950583\n0.0\n0.0\n0.722045\nnull\n0.0\n-0.237119\n\n\n\"00-0040676\"\n\"C.Ward\"\n\"Cam Ward\"\n\"QB\"\n\"QB\"\n2025\n\"REG\"\n\"TEN\"\n0\n320\n537\n3117\n15\n7\n55\n-410\n9\n7\n3887\n1513\n151\n-113.529241\n0\n37\n148\n1\n1\n0\n15\n7.221071\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n2\n0\n0\n0\n1\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n177.48\n177.48\n-3.848776\n0.0\n0.0\n0.84424\nnull\n0.0\n-0.211414\n\n\n\"00-0031407\"\n\"B.Bortles\"\n\"Blake Bortles\"\n\"QB\"\n\"QB\"\n2014\n\"REG\"\n\"JAX\"\n0\n280\n475\n2908\n11\n17\n55\n-345\n4\n0\n3326\n1620\n132\n-113.703585\n1\n56\n419\n0\n3\n1\n30\n14.894275\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n2\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n3\n4\n0\n0\n0\n6\n35\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n168.22\n168.22\n-7.378702\n0.0\n0.0\n0.961041\nnull\n0.0\n-0.239376\n\n\n\"00-0020608\"\n\"D.Carr\"\n\"David Carr\"\n\"QB\"\n\"QB\"\n2002\n\"REG\"\n\"HOU\"\n0\n233\n444\n2592\n9\n15\n76\n-411\n8\n3\n211\n2592\n117\n-132.459271\n2\n59\n282\n3\n13\n4\n28\n-8.950429\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n2\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n12\n20\n0\n0\n0\n12\n89\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n145.88\n145.88\nnull\n0.0\nNaN\n5.264255\nnull\nNaN\n-0.298332\n\n\n\"00-0034343\"\n\"J.Rosen\"\n\"Josh Rosen\"\n\"QB\"\n\"QB\"\n2018\n\"REG\"\n\"ARI\"\n0\n217\n393\n2278\n11\n14\n45\n-320\n7\n5\n3262\n977\n112\n-150.632712\n1\n23\n138\n0\n3\n0\n10\n3.882554\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n1\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n7\n8\n0\n0\n0\n1\n8\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n112.92\n112.92\n-8.322272\n0.0\n0.0\n0.748037\nnull\n0.0\n-0.383289\n\n\n\"00-0039150\"\n\"B.Young\"\n\"Bryce Young\"\n\"QB\"\n\"QB\"\n2023\n\"REG\"\n\"CAR\"\n0\n315\n527\n2877\n11\n10\n62\n-477\n9\n6\n4009\n1300\n135\n-159.273442\n1\n39\n253\n0\n2\n0\n20\n22.6693\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n4\n4\n0\n0\n0\n2\n25\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0\n0\n0\n0\n0\n156.38\n156.38\n-1.251331\n0.0\n0.0\n0.799165\nnull\n0.0\n-0.302227\n\n\n\n\n\n\n\nqb_stats[\"season\"].unique().to_list()\n\n[2002,\n 2003,\n 2004,\n 2005,\n 2006,\n 2007,\n 2008,\n 2009,\n 2010,\n 2011,\n 2012,\n 2013,\n 2014,\n 2015,\n 2016,\n 2017,\n 2018,\n 2019,\n 2020,\n 2021,\n 2022,\n 2023,\n 2024,\n 2025]"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "chicken",
    "section": "",
    "text": "I’m chicken. I write a newsletter and maintain the chickenstats python package"
  },
  {
    "objectID": "readme.html",
    "href": "readme.html",
    "title": "chickenstats-blog",
    "section": "",
    "text": "Welcome to the blog for chickenstats. Here you can find examples for the chickenstats library and the code used for the chicken and stats newsletter\n\nProjects\nFollow the links below to the different projects in the chickenstats portfolio\n\n\nchickenstats\n\n\nchickenstats-xg\n\n\nchickenstats-api\n\n\nchicken and stats\n\n\n\n\nBlog\nRead posts for the respective topics\n\n\nNashville Predators\n\n\n\nTennessee Titans\n\n\n\nTennessee Volunteers\n\n\n\n\n\nAbout\n\n\n\n\n\n\n\n\n\nAbout me\nI’m chicken."
  },
  {
    "objectID": "blog/index.html",
    "href": "blog/index.html",
    "title": "chickenstats blog",
    "section": "",
    "text": "Rink maps\n\n\n\ntutorials\n\n\n\nScrape play-by-play data and plot shot maps with chickenstats and hockey-rink\n\n\n\nchicken\n\n\nFeb 18, 2026\n\n\n\n\n\n\n\n\n\n\n\n\n\nSimulating today’s hockey games\n\n\n\ntutorials\n\n\n\nRun monte carlo simulations using the expected goals model to predict the winners of today’s games\n\n\n\nchicken\n\n\nJan 27, 2026\n\n\n\n\n\n\n\n\n\n\n\n\n\n4Nations Face Off\n\n\n\ntutorials\n\n\n\nAnalyze forward line performance at the 4Nations Face off\n\n\n\nchicken\n\n\nDec 31, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nGoals saved above expected\n\n\n\ntutorials\n\n\n\nScrape play-by-play data and analyze goalies’ goals saved above expected\n\n\n\nchicken\n\n\nDec 31, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nLollipop chart\n\n\n\ntutorials\n\n\n\nScrape play-by-play data and plot shot events as a lollipop chart, with the length of the stem indicating xG values\n\n\n\nchicken\n\n\nDec 31, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nNetwork charts\n\n\n\ntutorials\n\n\n\nScrape play-by-play data and analyze line combinations with network graphs\n\n\n\nchicken\n\n\nDec 31, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nHow does Cam Ward stack up?\n\n\n\ntennessee titans\n\n\n\nHow does Cam Ward compare to this year’s rookies and historical Titans QBs\n\n\n\nchicken\n\n\nDec 26, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\n2025 after 15 games\n\n\n\nnashville predators\n\n\n\nRecap of the first 15 games of the Predators’ 2025 season\n\n\n\nchicken\n\n\nNov 2, 2025\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "blog/posts/nashville_predators/checking_in_2025/index.html#housekeeping",
    "href": "blog/posts/nashville_predators/checking_in_2025/index.html#housekeeping",
    "title": "2025 after 15 games",
    "section": "Housekeeping",
    "text": "Housekeeping\n\nImport dependencies and set options\n\n# chickenstats library and utilities\nfrom chickenstats.chicken_nhl import Scraper, Season\nfrom chickenstats.chicken_nhl.info import NHL_COLORS\nfrom chickenstats.chicken_nhl.helpers import charts_directory\n\n# plotting library and utilities\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\n\n# miscellaneous utilities\nfrom pathlib import Path\n\n\n# set pandas options so that there are no columns abbreviated\npd.set_option(\"display.max_columns\", None)\n\n\n\nCreate directory for charts\n\ncharts_directory()\n\n\n\nchickenstats matplotlib styles\n\nplt.style.use(\"chickenstats\")  # this is available when you import chickenstats.utilities"
  },
  {
    "objectID": "blog/posts/nashville_predators/checking_in_2025/index.html#scraping-and-prepping-data",
    "href": "blog/posts/nashville_predators/checking_in_2025/index.html#scraping-and-prepping-data",
    "title": "2025 after 15 games",
    "section": "Scraping and prepping data",
    "text": "Scraping and prepping data\n\nScraping schedule and game IDs\n\nseason = Season(2025)\n\n\nschedule = season.schedule()\n\n\n\n\n\n\n\n\ncondition = schedule.game_state == \"OFF\"\n\ngame_ids = schedule.loc[condition].game_id.tolist()\n\nlatest_date = schedule.loc[condition].game_date.iloc[-1]\n\n\n\nScraping play-by-play data\n\nscraper = Scraper(game_ids)\n\n\nplay_by_play = scraper.play_by_play\n\n\n\n\n\n\n\n\n\nPrepping the stats dataframes\n\ngame_stats = scraper.stats\n\n\n\n\n\n\n\n\nscraper.prep_stats(level=\"season\")\nseason_stats = scraper.stats"
  },
  {
    "objectID": "blog/posts/nashville_predators/checking_in_2025/index.html#plotting-data",
    "href": "blog/posts/nashville_predators/checking_in_2025/index.html#plotting-data",
    "title": "2025 after 15 games",
    "section": "Plotting data",
    "text": "Plotting data\n\nFilter conditions and data to plot\n\n# Setting filter conditions and filtering data\nteam = \"NSH\"\ntoi_min = 5\nstrength_states = [\"5v5\"]\npositions = [\"F\", \"C\", \"L\", \"R\", \"L/R\", \"R/L\", \"C/R\", \"C/L\"]\n\nconds = np.logical_and.reduce(\n    [\n        season_stats.strength_state.isin(strength_states),\n        season_stats.position.isin(positions),\n        season_stats.toi &gt;= toi_min,\n    ]\n)\nplot_stats = season_stats.loc[conds].sort_values(by=\"xgf_percent\", ascending=False).reset_index(drop=True)\n\n\n\nSetting plot colors based on chosen team\n\ncolors = NHL_COLORS[team]\n\n\n\nPlotting individual xGF and xGA values\n\n# Setting overall figures\nfig, ax = plt.subplots(dpi=650, figsize=(8, 5))\n\n# Aesthetics, likes the tight layout and despining axes\nfig.tight_layout()\nsns.despine()\n\n# Getting the averages and drawing the average lines\nxga_mean = plot_stats.xga_p60.mean()\nxgf_mean = plot_stats.xgf_p60.mean()\n\nax.axvline(x=xga_mean, zorder=-1, alpha=0.5)\nax.axhline(y=xgf_mean, zorder=-1, alpha=0.5)\n\n# Setting the size norm so bubbles are consistent across figures\nsize_norm = (plot_stats.toi.min(), plot_stats.toi.max())\n\n# Filtering data and plotting the non-selected teams first\nconds = plot_stats.team != team\nplot_data = plot_stats.loc[conds]\n\n# They all get gray colors\nfacecolor = colors[\"MISS\"]\nedgecolor = colors[\"MISS\"]\n\n# Plotting the non-selected teams' data\nsns.scatterplot(\n    data=plot_data,\n    x=\"xga_p60\",\n    y=\"xgf_p60\",\n    size=\"toi\",\n    sizes=(20, 150),\n    size_norm=size_norm,\n    lw=1.5,\n    facecolor=facecolor,\n    edgecolor=edgecolor,\n    alpha=0.5,\n    legend=True,\n)\n\n# Filtering the data and plotting the selected team\nconds = plot_stats.team == team\nplot_data = plot_stats.loc[conds]\n\n# Setting the colors\nfacecolor = colors[\"GOAL\"]\nedgecolor = colors[\"SHOT\"]\n\n# Plotting the selected teams' data\nsns.scatterplot(\n    data=plot_data,\n    x=\"xga_p60\",\n    y=\"xgf_p60\",\n    size=\"toi\",\n    sizes=(20, 150),\n    size_norm=size_norm,\n    lw=1.5,\n    facecolor=facecolor,\n    edgecolor=edgecolor,\n    alpha=0.8,\n    legend=False,\n)\n\n# Iterating through the dataframe to label the bubbles\nfor row, player in plot_data.iterrows():\n    # Setting x and y positions that are slightly offset from the data they point to\n    x_position = player.xga_p60 + 0.25\n    y_position = player.xgf_p60 - 0.25\n\n    # Annotation options\n    arrow_props = {\"arrowstyle\": \"simple\", \"linewidth\": 0.25, \"color\": \"tab:gray\"}\n\n    # Plotting the annotation\n    ax.annotate(\n        text=f\"{player.player}\",\n        xy=(player.xga_p60, player.xgf_p60),\n        xytext=(x_position, y_position),\n        fontsize=6,\n        bbox={\"facecolor\": \"white\", \"alpha\": 0.5, \"edgecolor\": \"white\", \"pad\": 0},\n        arrowprops=arrow_props,\n    )\n\n# Setting axis lables\nax.axes.set_xlabel(\"xGA per 60 minutes\")\nax.axes.set_ylabel(\"xGF per 60 minutes\")\n\n# Setting figure suptitle and subtitle\nfig_suptitle = \"Predators forwards are generating and allowing all kinds of 5v5 offense\"\nfig.suptitle(fig_suptitle, x=0.01, y=1.08, fontsize=11, fontweight=\"bold\", horizontalalignment=\"left\")\n\nsubtitle = f\"NHL on-ice chances created and allowed | &gt;{toi_min} min. TOI at 5v5 | 2024-25 season, as of {latest_date}\"\nfig.text(s=subtitle, x=0.01, y=1.02, fontsize=10, horizontalalignment=\"left\")\n\n# Attribution\nattribution = \"Data & xG model @chickenandstats | Viz @chickenandstats\"\nfig.text(s=attribution, x=0.99, y=-0.05, fontsize=8, horizontalalignment=\"right\", style=\"italic\")\n\n# Save figure\nsavepath = Path(f\"./charts/5v5_xgf_xga_{team}.png\")\nfig.savefig(savepath, transparent=False, bbox_inches=\"tight\")\n\n\n\n\n\n\n\n\n\n\nxGF and GF\n\n# Setting overall figures\nfig, ax = plt.subplots(dpi=650, figsize=(8, 5))\n\n# Aesthetics, likes the tight tight layout and despining axes\nfig.tight_layout()\nsns.despine()\n\n# Getting the averages and drawing the average lines\ngf_mean = plot_stats.gf_p60.mean()\nxgf_mean = plot_stats.xgf_p60.mean()\n\nax.axhline(y=gf_mean, zorder=-1, alpha=0.5)\nax.axvline(x=xgf_mean, zorder=-1, alpha=0.5)\n\n# Setting the size norm so bubbles are consistent across figures\nsize_norm = (plot_stats.toi.min(), plot_stats.toi.max())\n\n# Getting plot colors based on team\ncolors = NHL_COLORS[team]\n\n# Filtering data and plotting the non-selected teams first\nconds = plot_stats.team != team\nplot_data = plot_stats.loc[conds]\n\n# They all get gray colors\nfacecolor = colors[\"MISS\"]\nedgecolor = colors[\"MISS\"]\n\n# Plotting the non-selected teams' data\nsns.scatterplot(\n    data=plot_data,\n    x=\"xgf_p60\",\n    y=\"gf_p60\",\n    size=\"toi\",\n    sizes=(20, 150),\n    size_norm=size_norm,\n    lw=1.5,\n    facecolor=facecolor,\n    edgecolor=edgecolor,\n    alpha=0.5,\n    legend=True,\n)\n\n# Filtering and plotting the selected teams' data\nconds = plot_stats.team == team\nplot_data = plot_stats.loc[conds]\n\n# Setting the colors\nfacecolor = colors[\"GOAL\"]\nedgecolor = colors[\"SHOT\"]\n\n# Plotting the selected team's data\nsns.scatterplot(\n    data=plot_data,\n    x=\"xgf_p60\",\n    y=\"gf_p60\",\n    size=\"toi\",\n    sizes=(20, 150),\n    size_norm=size_norm,\n    lw=1.5,\n    facecolor=facecolor,\n    edgecolor=edgecolor,\n    alpha=0.8,\n    legend=False,\n)\n\n# Iterating through the dataframe to label the bubbles\nfor row, player in plot_data.iterrows():\n    # Setting x and y positions that are slightly offset from the data they point to\n    x_position = player.xgf_p60 + 0.25\n    y_position = player.gf_p60 - 0.25\n\n    # Annotation options\n    arrow_props = {\"arrowstyle\": \"simple\", \"linewidth\": 0.25, \"color\": \"tab:gray\"}\n\n    # Plotting the annotation\n    ax.annotate(\n        text=f\"{player.player}\",\n        xy=(player.xgf_p60, player.gf_p60),\n        xytext=(x_position, y_position),\n        fontsize=6,\n        bbox={\"facecolor\": \"white\", \"alpha\": 0.5, \"edgecolor\": \"white\", \"pad\": 0},\n        arrowprops=arrow_props,\n    )\n\n# Setting x and y axes labels\nax.axes.set_xlabel(\"GF per 60 minutes\")\nax.axes.set_ylabel(\"xGF per 60 minutes\")\n\n# Figure suptitle and subtitle\nfig_suptitle = \"Top Predators forwards are converting on limited 5v5 chances\"\nfig.suptitle(fig_suptitle, x=0.01, y=1.08, fontsize=11, fontweight=\"bold\", horizontalalignment=\"left\")\n\nsubtitle = f\"NHL individual chances created and goals scored | &gt;{toi_min} min. TOI at 5v5 | 2024-25 season, as of {latest_date}\"\nfig.text(s=subtitle, x=0.01, y=1.02, fontsize=10, horizontalalignment=\"left\")\n\n# Figure attribution\nattribution = \"Data & xG model @chickenandstats | Viz @chickenandstats\"\nfig.text(s=attribution, x=0.99, y=-0.05, fontsize=8, horizontalalignment=\"right\", style=\"italic\")\n\n# Save figure\nsavepath = Path(f\"./charts/5v5_xgf_gf_{team}.png\")\nfig.savefig(savepath, transparent=False, bbox_inches=\"tight\")"
  },
  {
    "objectID": "blog/posts/tutorials/gsax/index.html",
    "href": "blog/posts/tutorials/gsax/index.html",
    "title": "Goals saved above expected",
    "section": "",
    "text": "Use the chickenstats library to scrape play-by-play data and analyze goalies’ goals saved above expected.\nParts of this tutorial are optional and will be clearly marked as such. For help, or any questions, please don’t hesitate to reach out to chicken@chickenandstats.com or @chickenandstats.com on Blue Sky."
  },
  {
    "objectID": "blog/posts/tutorials/gsax/index.html#intro",
    "href": "blog/posts/tutorials/gsax/index.html#intro",
    "title": "Goals saved above expected",
    "section": "",
    "text": "Use the chickenstats library to scrape play-by-play data and analyze goalies’ goals saved above expected.\nParts of this tutorial are optional and will be clearly marked as such. For help, or any questions, please don’t hesitate to reach out to chicken@chickenandstats.com or @chickenandstats.com on Blue Sky."
  },
  {
    "objectID": "blog/posts/tutorials/gsax/index.html#housekeeping",
    "href": "blog/posts/tutorials/gsax/index.html#housekeeping",
    "title": "Goals saved above expected",
    "section": "Housekeeping",
    "text": "Housekeeping\n\nImport dependencies\nImport the dependencies we’ll need for the guide\n\nimport matplotlib.patheffects as mpe\nimport matplotlib.pyplot as plt\nimport matplotlib.ticker as ticker\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom matplotlib.lines import Line2D\n\nfrom chickenstats.chicken_nhl import Scraper, Season\nfrom chickenstats.chicken_nhl._helpers import charts_directory\nfrom chickenstats.chicken_nhl.team import NHL_COLORS\n\n\n\nPandas options\nSet different pandas options. This cell is optional\n\npd.set_option(\"display.max_columns\", None)\npd.set_option(\"display.max_rows\", 100)\n\n\n\nFolder structure\n\ncharts_directory()\n\n\n\nChickenstats matplotlib style\nchickenstats.utilities includes a custom style package - this activates it. This cell is also optional\n\nplt.style.use(\"chickenstats\")"
  },
  {
    "objectID": "blog/posts/tutorials/gsax/index.html#scrape-data",
    "href": "blog/posts/tutorials/gsax/index.html#scrape-data",
    "title": "Goals saved above expected",
    "section": "Scrape data",
    "text": "Scrape data\n\nSchedule\nScrape the schedule using the Season object\n\nseason = Season(2025, backend=\"pandas\")\n\n\nschedule = season.schedule()\n\n\n\n\n\n\n\n\n\nStandings and team names\nScrape the standings and create team name dictionaries to use later\n\nstandings = season.standings.copy(deep=True)\n\n\nteam_names = standings.sort_values(by=\"team_name\").team_name.str.upper().tolist()\nteam_codes = standings.sort_values(by=\"team_name\").team.str.upper().tolist()\nteam_names_dict = dict(zip(team_codes, team_names, strict=False))\n\n\n\nGame IDs\nCreate a list of game IDs to scrape\n\nconds = schedule.game_state == \"OFF\"\n\ngame_ids = schedule.loc[conds].game_id.unique().tolist()\nlatest_date = schedule.loc[conds].game_date.max()\n\n\n\nPlay-by-play\nScrape play-by-play data using the Scraper object\n\nscraper = Scraper(game_ids, backend=\"pandas\")\n\n\npbp = scraper.play_by_play\n\n\n\n\n\n\n\n\n\nStats\nAggregate statistics to season and game level\n\nscraper.prep_stats(level=\"season\")\nseason_stats = scraper.stats.copy(deep=True)\n\n\nscraper.prep_stats(level=\"game\")\ngame_stats = scraper.stats.copy(deep=True)\n\n\n\nGoalie dataframes\nFilter the dataframes for goalies and add goals saved above expected stats\n\ndef prep_goalie_df(data: pd.DataFrame, strengths: bool) -&gt; pd.DataFrame:\n    \"\"\"Prep goalie dataframes for later analysis.\n\n    Parameters:\n        data (pd.DataFrame):\n            Pandas dataframe of individual statistics scraped using `chickenstats` library\n        strengths (bool):\n            If False, aggregates data to all strengths states. If True, data are aggregated\n            to strength state level\n\n    \"\"\"\n    df = data.copy(deep=True)\n\n    df = df.loc[df.position == \"G\"].reset_index(drop=True)\n\n    if not strengths:\n        group_cols = [\n            \"season\",\n            \"session\",\n            \"game_id\",\n            \"game_date\",\n            \"player\",\n            \"eh_id\",\n            \"api_id\",\n            \"position\",\n            \"team\",\n            \"opp_team\",\n        ]\n\n        group_cols = [x for x in group_cols if x in df.columns]\n\n        agg_stats = {\n            x: \"sum\"\n            for x in df.columns\n            if (x not in group_cols) and (x != \"strength_state\") and (\"percent\" not in x) and (\"p60\" not in x)\n        }\n\n        df = df.groupby(group_cols, as_index=False).agg(agg_stats)\n\n    df[\"gsax\"] = df.xga - df.ga\n    df[\"gsax_p60\"] = df.gsax / df.toi * 60\n\n    return df\n\n\ngoalies_game = prep_goalie_df(data=game_stats, strengths=True)\n\n\ngoalies_game_all_sit = prep_goalie_df(data=game_stats, strengths=False)\n\n\ngoalies_season = prep_goalie_df(data=season_stats, strengths=True)\n\n\ngoalies_season_all_sit = prep_goalie_df(data=season_stats, strengths=False)"
  },
  {
    "objectID": "blog/posts/tutorials/gsax/index.html#gsax-line-charts",
    "href": "blog/posts/tutorials/gsax/index.html#gsax-line-charts",
    "title": "Goals saved above expected",
    "section": "GSaX line charts",
    "text": "GSaX line charts\n\nPrepping data\nCalculating cumlative stats\n\ndef calc_cumulative_stats(data: pd.DataFrame) -&gt; pd.DataFrame:\n    \"\"\"Calculate cumulative TOI and xG against.\n\n    Parameters:\n        data (pd.DataFrame):\n            Pandas dataframe of statistics aggregated from the `chickenstats` library and\n            prepped for goalie analysis\n    \"\"\"\n    df = data.copy(deep=True).sort_values(by=\"game_date\")\n\n    group_list = [\"season\", \"session\", \"player\", \"eh_id\", \"api_id\", \"team\"]\n\n    df[\"cum_gp\"] = df.groupby(group_list)[\"game_id\"].transform(\"cumcount\") + 1\n\n    df[\"cum_toi\"] = df.groupby(group_list)[\"toi\"].transform(\"cumsum\")\n\n    df[\"cum_gsax\"] = df.groupby(group_list)[\"gsax\"].transform(\"cumsum\")\n\n    return df\n\n\ngoalies_game_all_sit = calc_cumulative_stats(data=goalies_game_all_sit)\n\n\n\nPlot line chart function\nFunction to plot cumulative GSaX and TOI for a given goalie\n\ndef plot_line_chart(\n    data: pd.DataFrame,\n    goalie: pd.Series,\n    ax: plt.axes,\n    session: str | None = None,\n    ax_title: str | None = None,\n    legend_label: str | None = None,\n    x_label: bool = False,\n    y_label: bool = False,\n):\n    \"\"\"Function to plot a seaborn line chart of cumulative time-on-ice and goals scored above expected.\n\n    Parameters:\n        data (pd.DataFrame):\n            Pandas dataframe of game-level goalie data to plot\n        goalie (pd.Series):\n            Row of data from season-level goalie data\n        ax (plt.axes):\n            The matplotlib axes to return after plotting the chart\n        session (list):\n            Select regular season (\"R\") or playoffs (\"P\"), if None, defaults to regular season or \"R\"\n        ax_title (str | None):\n            Customize ax title, or, if None, use the goalie's name\n        legend_label (str | None):\n            Customize the legend label, or, if None, list the cumulative GSaX and TOI\n        x_label (bool):\n            Whether to print or hide the x-axis label\n        y_label (bool):\n            Whether to print or hide the y-axis label\n\n    \"\"\"\n    if not session:\n        session = \"R\"\n\n    condition = data.session == session\n    plot_df = data.loc[condition].copy()\n\n    color_palette = np.where(\n        plot_df.api_id == goalie.api_id, NHL_COLORS[goalie.team][\"SHOT\"], NHL_COLORS[goalie.team][\"MISS\"]\n    )\n\n    color_palette = dict(zip(plot_df.player, color_palette, strict=False))\n\n    NHL_COLORS[goalie.team][\"MISS\"]\n    line_width = 3\n\n    conds = plot_df.player != goalie.player\n\n    sns.lineplot(\n        x=\"cum_toi\", y=\"cum_gsax\", data=plot_df[conds], hue=\"player\", palette=color_palette, ax=ax, lw=line_width\n    )\n\n    conds = plot_df.player == goalie.player\n    NHL_COLORS[goalie.team][\"SHOT\"]\n    line_width = 6\n    path_effect_ec = NHL_COLORS[goalie.team][\"GOAL\"]\n\n    path_effect = [mpe.Stroke(foreground=path_effect_ec, alpha=1, linewidth=7), mpe.Normal()]\n\n    sns.lineplot(\n        x=\"cum_toi\",\n        y=\"cum_gsax\",\n        data=plot_df[conds],\n        hue=\"player\",\n        palette=color_palette,\n        ax=ax,\n        zorder=3,\n        lw=3.5,\n        path_effects=path_effect,\n    )\n\n    if ax_title == \"\":\n        ax_title = \"\"\n\n    elif not ax_title:\n        ax_title = goalie.player\n\n    ax.set_title(ax_title, size=18, weight=\"heavy\", pad=15)\n\n    if y_label:\n        ax.set_ylabel(\"Cumulative GSaX\", size=16, labelpad=15, weight=\"heavy\")\n\n    else:\n        ax.set_ylabel(\"\")\n        ax.yaxis.set_tick_params(which=\"both\", labelbottom=True)\n\n    if x_label:\n        ax.set_xlabel(\"Cumulative time-on-ice (minutes)\", size=16, labelpad=15, weight=\"heavy\")\n\n    else:\n        ax.set_xlabel(\"\")\n        ax.xaxis.set_tick_params(which=\"both\", labelbottom=True)\n\n    legend_elements = list()\n    color = NHL_COLORS[goalie.team][\"SHOT\"]\n\n    xG = round(goalie.gsax, 2)\n\n    toi_max = round(goalie.toi, 2)\n\n    if not legend_label:\n        legend_label = f\"{xG} GSaX in {toi_max} minutes\"\n\n    element = Line2D([0], [0], lw=3, label=legend_label, color=color, path_effects=path_effect)\n\n    legend_elements.append(element)\n\n    ax.legend(\n        handles=legend_elements,\n        loc=\"upper left\",\n        ncol=1,\n        fontsize=14,\n        title_fontsize=12,\n        facecolor=\"white\",\n        framealpha=1,\n        edgecolor=\"gray\",\n    ).set_zorder(-1)\n\n    ax.xaxis.set_tick_params(labelsize=16)\n    ax.yaxis.set_tick_params(labelsize=16)\n\n    return ax\n\n\n\nJuuse Saros\nPlot single goalie’s goals saved above expected and time-on-ice\n\nselected_goalie = \"JUUSE.SAROS\"\nconds = goalies_season_all_sit.eh_id == selected_goalie\n\nfig_size = (8, 5)\n\nfig, ax = plt.subplots(figsize=fig_size, dpi=650)\n\nfor idx, goalie in goalies_season_all_sit.loc[conds].iterrows():\n    plot_df = goalies_game_all_sit.copy()\n\n    plot_line_chart(data=plot_df, goalie=goalie, ax=ax, ax_title=\"\", x_label=True, y_label=True)\n\n\ntitle = \"Saros is having an NHL-average year\"\nfig.suptitle(title, ha=\"center\", va=\"center\", y=1.027, size=16, weight=\"heavy\")\n\nsubtitle = f\"Cumulative GSaX & TOI, all situations | 2025-26 season, as of {latest_date}\"\nfig.text(s=subtitle, ha=\"center\", va=\"center\", x=0.5, y=0.98, size=12)\n\n\n# Attribution\nattribution = \"Data & xG model @chickenandstats.com | Viz @chickenandstats.com\"\nfig.text(s=attribution, x=0.95, y=-0.095, fontsize=8, horizontalalignment=\"right\", style=\"italic\")\n\nfig.savefig(\"./charts/saros_gsax.png\", dpi=650, bbox_inches=\"tight\", facecolor=\"white\")\n\n\n\n\n\n\n\n\n\n\nTop-6 goalies\nCreate the top goalies dataframe to iterate through for plotting\n\ntop_goalies = goalies_season_all_sit.sort_values(by=\"gsax\", ascending=False).head(6).reset_index(drop=True)\n\n\n\nPlot cumulative GSaX and TOI\nCumulative time-on-ice and goals saved above expected for top-6 goalies in NHL\n\n## setting figure size\n\nfig_size = (15, 15)\n\nfig, axes = plt.subplots(3, 2, figsize=fig_size, dpi=650, sharex=True, sharey=True)\n\nfig.tight_layout(pad=5)\n\naxes = axes.reshape(-1)\n\nfor idx, top_goalie in top_goalies.iterrows():\n    ax = axes[idx]\n\n    x_label = idx &gt;= 4\n\n    y_label = idx in [0, 2, 4]\n\n    plot_df = goalies_game_all_sit.copy()\n\n    plot_line_chart(data=plot_df, goalie=top_goalie, ax=ax, x_label=x_label, y_label=y_label)\n\n\ntitle = \"Top-6 goaltenders by cumulative goals saved above expected\"\nfig.suptitle(title, ha=\"center\", va=\"center\", y=1.027, size=24, weight=\"heavy\")\n\nsubtitle = f\"Cumulative GSaX & cumulative TOI, all situations | 2025-26 season, as of {latest_date}\"\nfig.text(s=subtitle, ha=\"center\", va=\"center\", x=0.5, y=1.001, size=18)\n\n\n# Attribution\nattribution = \"Data & xG model @chickenandstats.com | Viz @chickenandstats.com\"\nfig.text(s=attribution, x=0.99, y=-0.0125, fontsize=12, horizontalalignment=\"right\", style=\"italic\")\n\nfig.savefig(\"./charts/top_6_gsax.png\", dpi=650, bbox_inches=\"tight\", facecolor=\"white\")"
  },
  {
    "objectID": "blog/posts/tutorials/gsax/index.html#gsax-and-time-between-games",
    "href": "blog/posts/tutorials/gsax/index.html#gsax-and-time-between-games",
    "title": "Goals saved above expected",
    "section": "GSaX and time between games",
    "text": "GSaX and time between games\n\nPrepping data\nGetting game winners and calculating time between games with the schedule object\n\ndef prep_hours_since(data: pd.DataFrame, schedule: pd.DataFrame, strengths: list = None) -&gt; pd.DataFrame:\n    \"\"\"Function to prep dataframe of gsax and hours since for an individual goalie.\n\n    Parameters:\n        data (pd.DataFrame):\n            Pandas dataframe of goalie stats from `chickenstats` library\n        strengths (list):\n            List of strength states to filter the dataframe\n\n    \"\"\"\n    if strengths is None:\n        strengths = [\"5v5\"]\n    df = data.copy()\n\n    winners = np.where(schedule.home_score &gt; schedule.away_score, schedule.home_team, schedule.away_team)\n    winners_map = dict(zip(schedule.game_id.astype(str), winners, strict=False))\n\n    game_date_dt_local = pd.to_datetime(schedule.game_date_dt_local, utc=True)\n    game_date_map = dict(zip(schedule.game_id.astype(str), game_date_dt_local, strict=False))\n\n    df[\"game_date_dt_local\"] = df.game_id.map(game_date_map)\n    df[\"win\"] = df.game_id.map(winners_map)\n    df.win = np.where(df.team == df.win, 1, 0)\n\n    conds = df.strength_state.isin(strengths)\n\n    df = df.loc[conds].reset_index(drop=True)\n\n    group_list = [\"season\", \"session\", \"team\", \"player\", \"eh_id\"]\n\n    df[\"hours_since\"] = df.groupby(group_list).game_date_dt_local.transform(lambda x: x - x.shift(1)).astype(\n        \"timedelta64[s]\"\n    ) / pd.Timedelta(hours=1)\n\n    conds = np.logical_and.reduce([df.hours_since &gt; 0, df.hours_since &lt;= 175, df.toi &gt;= 10])\n\n    df = df.loc[conds].reset_index(drop=True)\n\n    return df\n\n\n\nPlotting function\nPlot individual goalie GSaX / 60 and time since last game\n\ndef plot_hours_since(\n    data: pd.DataFrame,\n    goalie: pd.Series,\n    ax: plt.axes,\n    ax_title: str | None = None,\n    legend_label: str | None = None,\n    x_label: bool = False,\n    y_label: bool = False,\n):\n    \"\"\"Function to plot a seaborn line chart of cumulative time-on-ice and goals scored above expected.\n\n    Parameters:\n        data (pd.DataFrame):\n            Pandas dataframe of game-level goalie data to plot\n        goalie (pd.Series):\n            Row of data from season-level goalie data\n        ax (plt.axes):\n            The matplotlib axes to return after plotting the chart\n        ax_title (str | None):\n            Customize ax title, or, if None, use the goalie's name\n        x_label (bool):\n            Whether to print or hide the x-axis label\n        y_label (bool):\n            Whether to print or hide the y-axis label\n\n    \"\"\"\n    sns.despine(right=False, top=False, ax=ax)\n\n    df = data.copy()\n\n    min_size = df.fa_p60.min()\n    max_size = df.fa_p60.max()\n    df.fa_p60.mean()\n    size_norm = (min_size, max_size)\n    sizes = (10, 500)\n\n    alpha = 0.65\n    line_width = 1.3\n\n    colors = NHL_COLORS[goalie.team]\n\n    conds = df.eh_id != goalie.eh_id\n\n    sns.scatterplot(\n        x=\"hours_since\",\n        y=\"gsax_p60\",\n        data=df[conds],\n        color=colors[\"MISS\"],\n        size=\"fa_p60\",\n        size_norm=size_norm,\n        sizes=sizes,\n        alpha=alpha,\n        edgecolor=\"white\",\n        linewidth=line_width,\n        legend=\"full\",\n        ax=ax,\n    )\n\n    color_palette = {0: colors[\"SHOT\"], 1: colors[\"GOAL\"]}\n\n    for result, color in color_palette.items():\n        conds = df.eh_id == goalie.eh_id\n\n        edge_color = \"white\" if result == 0 else colors[\"SHOT\"]\n\n        sns.scatterplot(\n            x=\"hours_since\",\n            y=\"gsax_p60\",\n            data=df[conds],\n            hue=\"win\",\n            palette=color_palette,\n            size=\"fa_p60\",\n            size_norm=size_norm,\n            sizes=sizes,\n            alpha=alpha,\n            edgecolor=edge_color,\n            linewidth=line_width,\n            legend=False,\n            ax=ax,\n        )\n\n    legend_elements = []\n\n    legend_element_labels = [\"Win\", \"Loss\", \"Other goalies\"]\n\n    for label in legend_element_labels:\n        if label == \"Win\":\n            color = colors[\"GOAL\"]\n            edge_color = colors[\"SHOT\"]\n\n        if label == \"Loss\":\n            color = colors[\"SHOT\"]\n            edge_color = \"white\"\n\n        if label == \"Other goalies\":\n            color = colors[\"MISS\"]\n            edge_color = \"white\"\n\n        element = Line2D(\n            [0], [0], lw=0, label=label, markersize=14, marker=\"o\", color=color, mec=edge_color, alpha=alpha\n        )\n\n        legend_elements.append(element)\n\n    legend = ax.legend(\n        handles=legend_elements,\n        loc=\"lower left\",\n        ncol=1,\n        fontsize=12,\n        title_fontsize=16,\n        facecolor=\"white\",\n        framealpha=1,\n        edgecolor=\"gray\",\n    )\n\n    ax.add_artist(legend).set_zorder(-1)\n\n    if not ax_title and ax_title != \"\":\n        ax_title = goalie.player\n\n    if ax_title:\n        ax.set_title(ax_title, size=18, weight=\"heavy\", pad=15)\n\n    if x_label:\n        ax.set_xlabel(\"Hours since last game\", size=18, labelpad=15, weight=\"heavy\")\n\n    else:\n        ax.set_xlabel(\"\", size=18, weight=\"heavy\")\n        ax.xaxis.set_tick_params(which=\"both\", labelbottom=True)\n\n    if y_label:\n        ax.set_ylabel(\"GSaX / 60\", size=18, labelpad=15, weight=\"heavy\")\n\n    else:\n        ax.set_ylabel(\"\")\n        ax.yaxis.set_tick_params(which=\"both\", labelleft=True)\n\n    ax.xaxis.set_tick_params(labelsize=14)\n    ax.yaxis.set_tick_params(labelsize=14)\n\n    ax.yaxis.set_major_locator(ticker.MultipleLocator(2))\n    ax.yaxis.set_minor_locator(ticker.MultipleLocator(1))\n\n    return ax\n\n\n\nData\nPrepping the data for plotting the next two charts\n\nhours_since_data = prep_hours_since(data=goalies_game, schedule=schedule)\n\n\nhours_since_data.shape\n\n(1152, 240)\n\n\n\n\nPlotting Juuse Saros\nYou can also change to plot to whichever goalie you prefer\n\ngoalie = \"JUUSE.SAROS\"\nstrengths = [\"5v5\"]\n\nfig_size = (8, 8)\n\nfig, ax = plt.subplots(figsize=fig_size, dpi=650)\nfig.tight_layout()\nsns.despine(right=False, top=False)\n\ngoalie_df = goalies_season.loc[\n    np.logical_and(goalies_season.strength_state.isin(strengths), goalies_season.eh_id == goalie)\n]\n\nfor idx, goalie in goalie_df.iterrows():\n    ax = plot_hours_since(data=hours_since_data, goalie=goalie, ax=ax, ax_title=\"\", x_label=True, y_label=True)\n\ntitle = \"Saros's worst games after long breaks\"\n\nfig.suptitle(title, ha=\"center\", va=\"center\", y=1.045, size=16, weight=\"heavy\")\n\nsubtitle = f\"GSaX / 60 & hours since last game (bubbles sized for FA / 60) | 2025-26 season, as of {latest_date}\"\nfig.text(s=subtitle, ha=\"center\", va=\"center\", x=0.5, y=1.015, size=12)\n\nattribution = \"Data & xG model @chickenandstats | Viz @chickenandstats\"\nfig.text(s=attribution, ha=\"right\", va=\"center\", y=-0.1, x=0.95, size=10, style=\"italic\")\n\nfig.savefig(\"./charts/saros_gsax_hours_since.png\", dpi=650, bbox_inches=\"tight\", facecolor=\"white\")\n\n\n\n\n\n\n\n\n\n\nElite goalies\nPlotting performance and hours since last game for top-6 goalies\n\n## setting figure size\n\nfig_size = (15, 15)\n\nfig, axes = plt.subplots(3, 2, figsize=fig_size, dpi=650)\n\nfig.tight_layout(pad=5)\n\naxes = axes.reshape(-1)\n\nfor idx, top_goalie in top_goalies.iterrows():\n    ax = axes[idx]\n\n    x_label = idx &gt;= 4\n\n    y_label = idx in [0, 2, 4]\n\n    ax = plot_hours_since(data=hours_since_data, goalie=top_goalie, ax=ax, x_label=x_label, y_label=y_label)\n\n\ntitle = \"Top-6 goaltenders by cumulative goals saved above expected\"\nfig.suptitle(title, ha=\"center\", va=\"center\", y=1.027, size=24, weight=\"heavy\")\n\nsubtitle = f\"GSaX / 60 and hours since last game (bubbles sized for FA / 60), 5v5 | 2025-26 season, as of {latest_date}\"\nfig.text(s=subtitle, ha=\"center\", va=\"center\", x=0.5, y=1.001, size=18)\n\n\n# Attribution\nattribution = \"Data & xG model @chickenandstats.com | Viz @chickenandstats.com\"\nfig.text(s=attribution, x=0.99, y=-0.0125, fontsize=12, horizontalalignment=\"right\", style=\"italic\")\n\nfig.savefig(\"./charts/top_6_gsax_hours_since.png\", dpi=650, bbox_inches=\"tight\", facecolor=\"white\")"
  },
  {
    "objectID": "blog/posts/tutorials/four_nations/index.html#housekeeping",
    "href": "blog/posts/tutorials/four_nations/index.html#housekeeping",
    "title": "4Nations Face Off",
    "section": "Housekeeping",
    "text": "Housekeeping\n\nImport dependencies\nImport the dependencies we’ll need for the guide\n\nimport datetime as dt\n\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom matplotlib.offsetbox import OffsetImage, AnnotationBbox\n\nfrom chickenstats.chicken_nhl import Scraper, Season\nfrom chickenstats.chicken_nhl.team import INTERNATIONAL_COLORS, Team\nfrom chickenstats.chicken_nhl._helpers import charts_directory\n\nfrom pathlib import Path\n\n\nfrom bokeh.plotting import figure, output_file, output_notebook, show, save\nfrom bokeh.models import HoverTool, ColumnDataSource, Title, Div, Span\nfrom bokeh.layouts import gridplot, column\nfrom bokeh.models import Range1d\n\n\n\nPandas options\nSet different pandas options. This cell is optional\n\npd.set_option(\"display.max_columns\", None)\npd.set_option(\"display.max_rows\", 100)\n\n\n\nFolder structure\n\ncharts_directory()\n\n\n\nChickenstats matplotlib style\nchickenstats.utilities includes a custom style package - this activates it. This cell is also optional\n\nplt.style.use(\"chickenstats\")"
  },
  {
    "objectID": "blog/posts/tutorials/four_nations/index.html#scrape-data",
    "href": "blog/posts/tutorials/four_nations/index.html#scrape-data",
    "title": "4Nations Face Off",
    "section": "Scrape data",
    "text": "Scrape data\n\nSchedule\nScrape the schedule using the Season object\n\nseason = Season(2024, backend=\"pandas\")\n\n\nschedule = season.schedule(sessions=\"FO\")\n\n\n\n\n\n\n\n\n\nGame IDs\nCreate a list of game IDs to scrape\n\nconds = schedule.game_state.isin([\"OFF\", \"FINAL\"])\n\ngame_ids = schedule.loc[conds].game_id.unique().tolist()\n\nlatest_date = schedule.loc[conds].game_date.max()\n\n\n\nPlay-by-play\nScrape play-by-play data using the Scraper object\n\nscraper = Scraper(game_ids, backend=\"pandas\")\n\n\npbp = scraper.play_by_play\n\n\n\n\n\n\n\n\n\nStats\nAggregate statistics to season and game level\n\nscraper.prep_stats(level=\"season\")\nseason_stats = scraper.stats\n\n\n\n\n\n\n\n\nscraper.prep_stats(level=\"game\")\ngame_stats = scraper.stats\n\n\n\n\n\n\n\n\nscraper.prep_lines(level=\"season\")\nlines = scraper.lines\n\n\n\n\n\n\n\n\nscraper.prep_team_stats(level=\"season\")\nteam_stats = scraper.team_stats"
  },
  {
    "objectID": "blog/posts/tutorials/four_nations/index.html#matplotlib",
    "href": "blog/posts/tutorials/four_nations/index.html#matplotlib",
    "title": "4Nations Face Off",
    "section": "Matplotlib",
    "text": "Matplotlib\n\nstrength_state = \"5v5\"\ntoi_min = 5\n\n# Setting filter conditions and filtering data\nconds = np.logical_and(lines.strength_state == strength_state, lines.toi &gt;= toi_min)\nplot_lines = lines.loc[conds].sort_values(by=\"xgf_percent\", ascending=False).reset_index(drop=True)\n\n# Setting overall figures\nfig, axes = plt.subplots(nrows=2, ncols=2, dpi=650, figsize=(8, 6))\n\nfig.tight_layout(pad=2.5)\n\naxes = axes.reshape(-1)\n\n# Getting the averages and drawing the average lines\nxga_mean = plot_lines.xga_p60.mean()\nxgf_mean = plot_lines.xgf_p60.mean()\n\n# Setting the size norm so bubbles are consistent across figures\nsize_norm = (plot_lines.toi.min(), plot_lines.toi.max())\n\n# Getting the teams and standings data to iterate through\nteams = [\"CAN\", \"FIN\", \"SWE\", \"USA\"]\nteam_names = [\"CANADA\", \"FINLAND\", \"SWEDEN\", \"UNITED STATES\"]\nteam_names = dict(zip(teams, team_names, strict=False))\n\n# Iterating through the standings data\nfor _idx, team in enumerate(teams):\n    # Setting the team    # Setting the axis\n    ax = axes[_idx]\n\n    team_info = Team(team)\n\n    team_name = team_info.team_name\n    colors = team_info.colors\n\n    team_stats_plot = team_stats.loc[\n        np.logical_and(team_stats.strength_state == strength_state, team_stats.team == team)\n    ]\n\n    # Average lines\n    ax.axvline(x=xga_mean, zorder=-1, alpha=0.5)\n    ax.axhline(y=xgf_mean, zorder=-1, alpha=0.5)\n\n    # Filtering data and plotting the non-selected teams first\n    conds = plot_lines.team != team\n    plot_data = plot_lines.loc[conds]\n\n    # They all get gray colors\n    facecolor = colors[\"MISS\"]\n    edgecolor = \"white\"  # colors[\"MISS\"]\n\n    # Plotting the non-selected teams' data\n    sns.scatterplot(\n        data=plot_data,\n        x=\"xga_p60\",\n        y=\"xgf_p60\",\n        size=\"toi\",\n        sizes=(20, 150),\n        size_norm=size_norm,\n        lw=1.5,\n        facecolor=facecolor,\n        edgecolor=edgecolor,\n        alpha=0.5,\n        legend=False,\n        ax=ax,\n    )\n\n    # Filtering and plotting the selected team's data\n    conds = plot_lines.team == team\n    plot_data = plot_lines.loc[conds]\n\n    # Setting the colors\n    facecolor = colors[\"GOAL\"]\n    edgecolor = colors[\"SHOT\"]\n\n    # Plotting the selected team's data\n    sns.scatterplot(\n        data=plot_data,\n        x=\"xga_p60\",\n        y=\"xgf_p60\",\n        size=\"toi\",\n        sizes=(20, 150),\n        size_norm=size_norm,\n        lw=1.5,\n        facecolor=facecolor,\n        edgecolor=edgecolor,\n        alpha=0.8,\n        legend=False,\n        ax=ax,\n    )\n\n    # Setting x and y axes labels\n    x_labels = [2, 3]\n\n    if _idx in x_labels:\n        ax.axes.set_xlabel(\"xGA per 60 minutes\", fontsize=7)\n    else:\n        ax.axes.set_xlabel(\"\")\n\n    y_labels = [0, 2]\n\n    if _idx in y_labels:\n        ax.axes.set_ylabel(\"xGF per 60 minutes\", fontsize=7)\n    else:\n        ax.axes.set_ylabel(\"\")\n\n    # Setting tick params font size\n    ax.tick_params(axis=\"both\", which=\"major\", labelsize=7)\n\n    gf = team_stats_plot.gf.iloc[0]\n    xgf = round(team_stats_plot.xgf.iloc[0], 2)\n    ga = team_stats_plot.ga.iloc[0]\n    xga = round(team_stats_plot.xga.iloc[0], 2)\n    toi = round(team_stats_plot.toi.iloc[0], 2)\n\n    # Setting the ax title\n    ax_title = f\"{team_name} | {gf} GF ({xgf} xGF) - {ga} GA ({xga} xGA) | {toi} TOI\"\n    ax.set_title(ax_title, fontsize=7, x=-0.085, y=1.03, horizontalalignment=\"left\")\n\n    logo = team_info.logo\n\n    imagebox = OffsetImage(logo, zoom=0.15, alpha=0.15, zorder=-10)\n    imagebox.image.axes = ax\n\n    ab = AnnotationBbox(imagebox, (0.5, 0.5), xycoords=\"axes fraction\", bboxprops={\"lw\": 0}, alpha=0, zorder=-10)\n\n    ax.add_artist(ab)\n\n# Figure suptitle and subtitle\nfig_suptitle = \"Forward line combinations' chances created vs. chances allowed\"\nfig.suptitle(fig_suptitle, x=0.01, y=1.085, fontsize=11, fontweight=\"bold\", horizontalalignment=\"left\")\n\nsubtitle = f\"4 Nations Face-Off | &gt;{toi_min} min. TOI at 5v5 (size indicates TOI) | {latest_date}\"\nfig.text(s=subtitle, x=0.01, y=1.0315, fontsize=10, horizontalalignment=\"left\")\n\n# Attribution\nattribution = \"Data & xG model @chickenandstats.com | Viz @chickenandstats.com\"\nfig.text(s=attribution, x=0.99, y=-0.03, fontsize=8, horizontalalignment=\"right\", style=\"italic\")\n\nsavepath = Path(\"./charts/5v5_4n_fo_forwards.png\")\nfig.savefig(savepath, transparent=False, bbox_inches=\"tight\")"
  },
  {
    "objectID": "blog/posts/tutorials/four_nations/index.html#bokeh",
    "href": "blog/posts/tutorials/four_nations/index.html#bokeh",
    "title": "4Nations Face Off",
    "section": "Bokeh",
    "text": "Bokeh\n\nteam = \"USA\"\nteam_name = \"UNITED STATES\"\nstrength_state = \"5v5\"\ndevice_type = \"desktop\"\ndata = lines.copy()\ntoi_min = 5\ndisplay_plot = True\n\noutput_file_str = f\"{team.lower()}_5v5_{device_type}.html\"\n\nplot_attributes = {\n    \"desktop\": {\n        \"size_multiplier\": 15,\n        \"major_label_font_size\": \"9pt\",\n        \"axis_label_font_size\": \"10pt\",\n        \"title_font_size\": \"18pt\",\n        \"subtitle_font_size\": \"14pt\",\n        \"stats_font_size\": \"10pt\",\n        \"stats_y_value\": 0.95,\n        \"player_name_font_size\": \"10pt\",\n        \"ncols\": 4,\n        \"height\": 240,  # 240,\n    },\n    \"mobile\": {\n        \"size_multiplier\": 8,\n        \"major_label_font_size\": \"7pt\",\n        \"axis_label_font_size\": \"8pt\",\n        \"title_font_size\": \"14pt\",\n        \"subtitle_font_size\": \"11pt\",\n        \"stats_font_size\": \"8pt\",\n        \"stats_y_value\": 0.95,\n        \"player_name_font_size\": \"10pt\",\n        \"ncols\": 1,\n        \"height\": 240,  # 240,\n    },\n}\n\nplot_attributes = plot_attributes[device_type]\nplot_colors = {\"dark_gray\": \"#696969\", \"light_gray\": \"#D3D3D3\", \"medium_gray\": \"#808080\"}\n\n# Setting filter conditions and filtering data\nconditions = np.logical_and(lines.strength_state == strength_state, lines.toi &gt;= toi_min)\nplot_lines = lines.loc[conditions].sort_values(by=\"xgf_percent\", ascending=False).reset_index(drop=True)\n\nx_range = Range1d(plot_lines.xga_p60.min() - 1, plot_lines.xga_p60.max() + 1)\ny_range = Range1d(plot_lines.xgf_p60.min() - 1, plot_lines.xgf_p60.max() + 1)\n\n# Getting the averages and drawing the average lines\nxga_mean = plot_lines.xga_p60.mean()\nxgf_mean = plot_lines.xgf_p60.mean()\n\n# Setting the size norm so bubbles are consistent across figures\nsize_norm = (plot_lines.toi.min(), plot_lines.toi.max())\n\n# Getting the teams and standings data to iterate through\nteams = [\"CAN\", \"FIN\", \"SWE\", \"USA\"]\nteam_names = [\"CANADA\", \"FINLAND\", \"SWEDEN\", \"UNITED STATES\"]\nteam_names = dict(zip(teams, team_names, strict=False))\n\nplot_list = []\n\nif display_plot:\n    output_notebook()\n\nelse:\n    output_file(output_file_str)\n\n# Iterating through the standings data\nfor _idx, team in enumerate(teams):\n    team_name = team_names[team]\n    team_stats_plot = team_stats.loc[\n        np.logical_and(team_stats.strength_state == strength_state, team_stats.team == team)\n    ]\n\n    colors = INTERNATIONAL_COLORS[team]\n\n    condition = plot_lines.team == team\n\n    plot_data = plot_lines.loc[condition].copy()\n\n    # plot = prep_stats(data = plot, strengths = strengths)\n\n    plot_data[\"edgecolors\"] = colors[\"SHOT\"]\n    plot_data[\"colors\"] = colors[\"GOAL\"]\n    plot_data[\"toi_size\"] = plot_data.toi\n\n    source = plot_data.copy()\n\n    source = ColumnDataSource(source)\n\n    TOOLS = \"hover,crosshair,pan,wheel_zoom,zoom_in,zoom_out,box_zoom,undo,redo,reset,tap,box_select,poly_select,lasso_select\"\n\n    p = figure(tools=TOOLS, x_range=x_range, y_range=y_range)\n\n    vline = Span(\n        location=xga_mean, dimension=\"height\", line_color=plot_colors[\"light_gray\"], line_width=2, level=\"underlay\"\n    )\n    hline = Span(\n        location=xgf_mean, dimension=\"width\", line_color=plot_colors[\"light_gray\"], line_width=2, level=\"underlay\"\n    )\n\n    p.add_layout(vline)\n    p.add_layout(hline)\n\n    test = p.scatter(\n        x=\"xga_p60\",\n        y=\"xgf_p60\",\n        size=\"toi\",\n        source=source,\n        color=\"colors\",\n        alpha=0.65,\n        line_color=\"edgecolors\",\n        line_width=2.5,\n    )\n\n    condition = plot_lines.team != team\n\n    plot_data = plot_lines.loc[condition].copy()\n\n    # plot = prep_stats(data = plot, strengths = strengths)\n\n    plot_data[\"edgecolors\"] = \"white\"\n    plot_data[\"colors\"] = colors[\"MISS\"]\n    plot_data[\"toi_size\"] = plot_data.toi\n\n    source = plot_data.copy()\n\n    source = ColumnDataSource(source)\n\n    p.scatter(\n        x=\"xga_p60\",\n        y=\"xgf_p60\",\n        size=\"toi\",\n        source=source,\n        color=\"colors\",\n        alpha=0.65,\n        line_color=\"edgecolors\",\n        line_width=2.5,\n        level=\"underlay\",\n    )\n\n    gf = team_stats_plot.gf.iloc[0]\n    xgf = round(team_stats_plot.xgf.iloc[0], 2)\n    ga = team_stats_plot.ga.iloc[0]\n    xga = round(team_stats_plot.xga.iloc[0], 2)\n    toi = round(team_stats_plot.toi.iloc[0], 2)\n\n    # Setting the ax title\n    subtitle = f\"{team_name} | {gf} GF ({xgf} xGF) - {ga} GA ({xga} xGA) | {toi} TOI\"\n\n    p.add_layout(\n        Title(\n            text=subtitle,\n            text_font_size=plot_attributes[\"player_name_font_size\"],\n            text_font_style=\"bold\",\n            text_color=plot_colors[\"dark_gray\"],\n            vertical_align=\"middle\",\n            align=\"left\",\n            text_line_height=1,\n        ),\n        \"above\",\n    )\n\n    p.outline_line_width = 0\n    p.grid.grid_line_color = None\n    p.axis.minor_tick_line_color = None\n    p.axis.major_tick_line_color = plot_colors[\"dark_gray\"]\n    p.axis.major_tick_out = 3\n    p.axis.major_tick_line_width = 2.5\n    # p.axis.ticker = [0, 0.25, 0.5, 0.75, 1]\n    # p.axis.major_label_overrides = {x: f\"{round(x * 100)}\" for x in [0, 0.25, 0.5, 0.75, 1]}\n\n    p.axis.major_label_text_font_size = plot_attributes[\"major_label_font_size\"]\n    p.axis.axis_label_text_font_size = plot_attributes[\"axis_label_font_size\"]\n    p.axis.axis_line_color = plot_colors[\"dark_gray\"]\n    p.axis.axis_line_width = 2\n\n    p.yaxis.axis_label = \"xGF per 60 minutes\"\n\n    p.xaxis.axis_label = \"xGA per 60 minutes\"\n\n    hover = p.select(dict(type=HoverTool))\n\n    hover.tooltips = [\n        (\"LINE\", \"@forwards\"),\n        (\"TEAM\", \"@team\"),\n        (\"TOI\", \"@toi{0.0}\"),\n        (\"GOALS\", \"@gf\"),\n        (\"xGF%\", \"@xgf_percent{0.0%}\"),\n        (\"xGF\", \"@xgf{0.0}\"),\n        (\"xGA\", \"@xga{0.0}\"),\n        (\"xGF/60\", \"@xgf_p60{0.0}\"),\n        (\"xGA/60\", \"@xga_p60{0.0}\"),\n    ]\n    hover.mode = \"mouse\"\n    hover.name = \"tooltips\"\n    hover.renderers = [test]\n\n    plot_list.append(p)\n\ngrid = gridplot(\n    plot_list,\n    ncols=2,\n    toolbar_location=\"right\",\n    height=300,  # plot_attributes[\"height\"],\n    sizing_mode=\"stretch_width\",\n)\n\ntitle_str = \"Forward line combinations' chances created vs. chances allowed\"\n\ntitle = Div(\n    text=title_str,\n    styles={\"font-size\": plot_attributes[\"title_font_size\"], \"color\": plot_colors[\"dark_gray\"], \"font-weight\": \"bold\"},\n    margin=(0, 0, 0, 10),\n)\n\ntodays_date = dt.datetime.now().strftime(\"%Y-%m-%d\")\nsubtitle_str = f\"4 Nations Face-Off | &gt;{toi_min} min. TOI at 5v5 (size indicates TOI) | {todays_date}\"\n\nsubtitle = Div(\n    text=subtitle_str,\n    styles={\n        \"font-size\": plot_attributes[\"subtitle_font_size\"],\n        \"color\": plot_colors[\"medium_gray\"],\n        \"font-weight\": \"light\",\n    },\n    margin=(-5, 0, 10, 13),\n    background=\"white\",\n)\n\nattribution = \"Data & xG model @chickenandstats.com | Viz @chickenandstats.com\"\n\nfooter = Div(\n    text=attribution, styles={\"font-size\": \"10pt\", \"color\": plot_colors[\"medium_gray\"], \"font-weight\": \"light\"}\n)\n# margin=(0, 0, 0, 0))\n\n\nchart = column(title, subtitle, grid, footer, sizing_mode=\"scale_width\", background=\"white\")\n\nif display_plot is True:\n    show(chart, background_fill_color=\"white\")\n\nelse:\n    save(chart)\n\n    \n    \n        \n        Loading BokehJS ..."
  },
  {
    "objectID": "blog/posts/tutorials/monte_carlo/index.html",
    "href": "blog/posts/tutorials/monte_carlo/index.html",
    "title": "Simulating today’s hockey games",
    "section": "",
    "text": "Use the chickenstats library to scrape play-by-play data, aggregate to the team level, then run monte carlo simulations to predict the winners of today’s games.\nParts of this tutorial are optional and will be clearly marked as such. For help, or any questions, please don’t hesitate to reach out to chicken@chickenandstats.com or @chickenandstats.com on Blue Sky."
  },
  {
    "objectID": "blog/posts/tutorials/monte_carlo/index.html#intro",
    "href": "blog/posts/tutorials/monte_carlo/index.html#intro",
    "title": "Simulating today’s hockey games",
    "section": "",
    "text": "Use the chickenstats library to scrape play-by-play data, aggregate to the team level, then run monte carlo simulations to predict the winners of today’s games.\nParts of this tutorial are optional and will be clearly marked as such. For help, or any questions, please don’t hesitate to reach out to chicken@chickenandstats.com or @chickenandstats.com on Blue Sky."
  },
  {
    "objectID": "blog/posts/tutorials/monte_carlo/index.html#housekeeping",
    "href": "blog/posts/tutorials/monte_carlo/index.html#housekeeping",
    "title": "Simulating today’s hockey games",
    "section": "Housekeeping",
    "text": "Housekeeping\n\nImport dependencies\nImport the dependencies we’ll need for the guide\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport polars as pl\n\nfrom pathlib import Path\nimport datetime as dt\n\n\nfrom chickenstats.chicken_nhl import Scraper, Season\nfrom chickenstats.chicken_nhl._helpers import charts_directory\nfrom chickenstats.chicken_nhl.team import NHL_COLORS\n\nfrom monte_carlo import (\n    aggregate_strength_states,\n    prep_nhl_stats,\n    prep_team_stats,\n    prep_todays_games,\n    simulate_game,\n    predict_game,\n    predict_games,\n    process_winners,\n    assess_predictions,\n)\n\n\n\nPolars options\nSet different polars options. This cell is optional\n\npl.Config.set_tbl_cols(-1)\n\npolars.config.Config\n\n\n\n\nFolder structure\n\ncharts_directory()\n\n\n\nChickenstats matplotlib style\nchickenstats.utilities includes a custom style package - this activates it. This cell is also optional\n\nplt.style.use(\"chickenstats\")"
  },
  {
    "objectID": "blog/posts/tutorials/monte_carlo/index.html#scrape-data",
    "href": "blog/posts/tutorials/monte_carlo/index.html#scrape-data",
    "title": "Simulating today’s hockey games",
    "section": "Scrape data",
    "text": "Scrape data\n\nSchedule\nScrape the schedule using the Season object\n\nseason = Season(2025, backend=\"polars\")\n\n\nschedule = season.schedule()\n\n\n\n\n\n\n\n\n\nStandings and team names\nScrape the standings and create team name dictionaries to use later\n\nstandings = season.standings\n\n\nstandings.head(5)\n\n\nshape: (5, 57)\n\n\n\nseason\ndate\nteam\nteam_name\nconference\ndivision\ngames_played\npoints\npoints_pct\nwins\nregulation_wins\nshootout_wins\nlosses\not_losses\nshootout_losses\nties\nwin_pct\nregulation_win_pct\nstreak_code\nstreak_count\ngoals_for\ngoals_against\ngoals_for_pct\ngoal_differential\ngoal_differential_pct\nhome_games_played\nhome_points\nhome_goals_for\nhome_goals_against\nhome_goal_differential\nhome_wins\nhome_losses\nhome_ot_losses\nhome_ties\nhome_regulation_wins\nroad_games_played\nroad_points\nroad_goals_for\nroad_goals_against\nroad_goal_differential\nroad_wins\nroad_losses\nroad_ot_losses\nroad_ties\nroad_regulation_wins\nl10_points\nl10_goals_for\nl10_goals_against\nl10_goal_differential\nl10_wins\nl10_losses\nl10_ot_losses\nl10_ties\nl10_regulation_wins\nteam_logo\nwildcard_sequence\nwaivers_sequence\n\n\ni64\nstr\nstr\nstr\nstr\nstr\ni64\ni64\nf64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\nf64\nf64\nstr\ni64\ni64\ni64\nf64\ni64\nf64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\nstr\ni64\ni64\n\n\n\n\n20252026\n\"2026-02-05\"\n\"COL\"\n\"Colorado Avalanche\"\n\"Western\"\n\"Central\"\n55\n83\n0.754545\n37\n34\n1\n9\n9\nnull\n0\n0.672727\n0.618182\n\"W\"\n1\n212\n138\n3.854545\n74\n1.345455\n28\n46\n117\n66\n51\n21\n3\n4\n0\n21\n27\n37\n95\n72\n23\n16\n6\n5\n0\n13\n9\n30\n35\n-5\n4\n5\n1\n0\n4\n\"https://assets.nhle.com/logos/…\n0\n32\n\n\n20252026\n\"2026-02-05\"\n\"CAR\"\n\"Carolina Hurricanes\"\n\"Eastern\"\n\"Metropolitan\"\n57\n78\n0.684211\n36\n26\n4\n15\n6\nnull\n0\n0.631579\n0.45614\n\"W\"\n3\n197\n163\n3.45614\n34\n0.596491\n31\n44\n118\n94\n24\n21\n8\n2\n0\n15\n26\n34\n79\n69\n10\n15\n7\n4\n0\n11\n18\n39\n21\n18\n8\n0\n2\n0\n7\n\"https://assets.nhle.com/logos/…\n0\n30\n\n\n20252026\n\"2026-02-05\"\n\"MIN\"\n\"Minnesota Wild\"\n\"Western\"\n\"Central\"\n58\n78\n0.672414\n34\n21\n4\n14\n10\nnull\n0\n0.586207\n0.362069\n\"W\"\n5\n196\n169\n3.37931\n27\n0.465517\n30\n41\n97\n91\n6\n17\n6\n7\n0\n9\n28\n37\n99\n78\n21\n17\n8\n3\n0\n12\n17\n46\n33\n13\n8\n1\n1\n0\n3\n\"https://assets.nhle.com/logos/…\n0\n28\n\n\n20252026\n\"2026-02-05\"\n\"DAL\"\n\"Dallas Stars\"\n\"Western\"\n\"Central\"\n57\n77\n0.675439\n34\n28\n4\n14\n9\nnull\n0\n0.596491\n0.491228\n\"W\"\n6\n193\n160\n3.385965\n33\n0.578947\n26\n35\n85\n72\n13\n16\n7\n3\n0\n13\n31\n42\n108\n88\n20\n18\n7\n6\n0\n15\n14\n32\n27\n5\n7\n3\n0\n0\n5\n\"https://assets.nhle.com/logos/…\n0\n29\n\n\n20252026\n\"2026-02-05\"\n\"TBL\"\n\"Tampa Bay Lightning\"\n\"Eastern\"\n\"Atlantic\"\n54\n76\n0.703704\n36\n27\n4\n14\n4\nnull\n0\n0.666667\n0.5\n\"W\"\n4\n193\n139\n3.574074\n54\n1.0\n26\n34\n85\n70\n15\n17\n9\n0\n0\n11\n28\n42\n108\n69\n39\n19\n5\n4\n0\n16\n17\n35\n24\n11\n8\n1\n1\n0\n4\n\"https://assets.nhle.com/logos/…\n0\n31\n\n\n\n\n\n\n\nteam_names = standings.sort(by=\"team_name\")[\"team_name\"].str.to_uppercase().to_list()\nteam_codes = standings.sort(by=\"team_name\")[\"team\"].str.to_uppercase().to_list()\nteam_names_dict = dict(zip(team_codes, team_names, strict=False))\n\nhome_teams = dict(zip(schedule[\"game_id\"].to_list(), schedule[\"home_team\"].to_list(), strict=False))\n\n\n\nGame IDs\nCreate a list of game IDs to scrape\n\nconds = pl.col(\"game_state\") == \"OFF\"\n\ngame_ids = schedule.filter(conds)[\"game_id\"].unique().to_list()\n\n\n\nLatest date\nImportant! If you don’t set this, it will just pull from the last completed game\n\nconds = pl.col(\"game_state\") == \"OFF\"\n\ndt_format = \"%Y-%m-%d\"\nlatest_date_dt = schedule.filter(conds)[\"game_date\"].str.to_datetime(format=dt_format).max()  # In YYYY-MM-DD format\nlatest_date = latest_date_dt.strftime(dt_format)\n\nlatest_date = \"2026-01-24\"\nlatest_date_dt = dt.date(year=int(latest_date[:4]), month=int(latest_date[5:7]), day=int(latest_date[8:10]))\n\n\n\nChecking to see if you’ve already scraped the data\nCheck to see if you’ve already scraped, so you’re only getting the game_ids that you need\n\ndata_directory = Path.cwd() / \"data\"\nstats_file = data_directory / \"team_stats.csv\"\n\nif not data_directory.exists():\n    data_directory.mkdir()\n\nif stats_file.exists():\n    team_stats = pl.read_csv(source=stats_file, infer_schema_length=2000)\n\n    saved_game_ids = team_stats[\"game_id\"].to_list()\n    game_ids = [x for x in game_ids if x not in saved_game_ids]\n\n\nif game_ids:\n    scraper = Scraper(game_ids, backend=\"polars\")\n\n    pbp = scraper.play_by_play\n    scraped_team_stats = scraper.team_stats\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCombine scraped and saved data\nCombine the scraped data and the saved data, then save the new file, but only if there are game_ids\n\nif game_ids:\n    team_stats = pl.concat(\n        [team_stats.with_columns(pl.col(\"bsf_adj_percent\").cast(pl.Float64)), scraped_team_stats], strict=False\n    )  # Quick, don't ask\n    team_stats.write_csv(stats_file)\n\n\nteam_stats.head(5)\n\n\nshape: (5, 141)\n\n\n\nseason\nsession\ngame_id\ngame_date\nteam\nopp_team\nstrength_state\ntoi\ngf\nga\ngf_adj\nga_adj\nhdgf\nhdga\nxgf\nxga\nxgf_adj\nxga_adj\nsf\nsa\nsf_adj\nsa_adj\nhdsf\nhdsa\nff\nfa\nff_adj\nfa_adj\nhdff\nhdfa\ncf\nca\ncf_adj\nca_adj\nbsf\nbsa\nbsf_adj\nbsa_adj\nmsf\nmsa\nmsf_adj\nmsa_adj\nhdmsf\nhdmsa\nteammate_block\nhf\nht\ngive\ntake\nozf\nnzf\ndzf\nfow\nfol\nozfw\nozfl\nnzfw\nnzfl\ndzfw\ndzfl\npent0\npent2\npent4\npent5\npent10\npend0\npend2\npend4\npend5\npend10\ngf_p60\nga_p60\ngf_adj_p60\nga_adj_p60\nhdgf_p60\nhdga_p60\nxgf_p60\nxga_p60\nxgf_adj_p60\nxga_adj_p60\nsf_p60\nsa_p60\nsf_adj_p60\nsa_adj_p60\nhdsf_p60\nhdsa_p60\nff_p60\nfa_p60\nff_adj_p60\nfa_adj_p60\nhdff_p60\nhdfa_p60\ncf_p60\nca_p60\ncf_adj_p60\nca_adj_p60\nbsf_p60\nbsa_p60\nbsf_adj_p60\nbsa_adj_p60\nmsf_p60\nmsa_p60\nmsf_adj_p60\nmsa_adj_p60\nhdmsf_p60\nhdmsa_p60\nteammate_block_p60\nhf_p60\nht_p60\ngive_p60\ntake_p60\npent0_p60\npent2_p60\npent4_p60\npent5_p60\npent10_p60\npend0_p60\npend2_p60\npend4_p60\npend5_p60\npend10_p60\ngf_percent\ngf_adj_percent\nhdgf_percent\nxgf_percent\nxgf_adj_percent\nsf_percent\nsf_adj_percent\nhdsf_percent\nff_percent\nff_adj_percent\nhdff_percent\ncf_percent\ncf_adj_percent\nbsf_percent\nbsf_adj_percent\nmsf_percent\nmsf_adj_percent\nhdmsf_percent\nhf_percent\ntake_percent\n\n\ni64\nstr\ni64\nstr\nstr\nstr\nstr\nf64\ni64\ni64\nf64\nf64\ni64\ni64\nf64\nf64\nf64\nf64\ni64\ni64\nf64\nf64\ni64\ni64\ni64\ni64\nf64\nf64\ni64\ni64\ni64\ni64\nf64\nf64\ni64\ni64\nf64\nf64\ni64\ni64\nf64\nf64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\n\n\n\n\n20252026\n\"R\"\n2025020813\n\"2026-01-24\"\n\"CAR\"\n\"OTT\"\n\"5v4\"\n5.5\n0\n0\n0.0\n0.0\n0\n0\n0.266756\n0.175814\n0.311799\n0.153621\n1\n1\n1.200956\n1.200956\n1\n0\n1\n2\n1.205802\n2.411605\n1\n0\n1\n2\n1.205802\n2.411605\n0\n0\n0.0\n0.0\n0\n1\n0.0\n0.854207\n0\n0\n0\n1\n0\n1\n0\n0\n2\n3\n0\n5\n0\n0\n0\n2\n0\n3\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n2.910065\n1.917967\n3.40144\n1.67587\n10.909091\n10.909091\n13.101342\n13.101342\n10.909091\n0.0\n10.909091\n21.818182\n13.154208\n26.308416\n10.909091\n0.0\n10.909091\n21.818182\n13.154208\n26.308416\n0.0\n0.0\n0.0\n0.0\n0.0\n10.909091\n0.0\n9.31862\n0.0\n0.0\n0.0\n10.909091\n0.0\n10.909091\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n10.909091\n0.0\n0.0\n0.0\nNaN\nNaN\nNaN\n0.602743\n0.66993\n0.5\n0.5\n1.0\n0.333333\n0.333333\n1.0\n0.333333\n0.333333\nNaN\nNaN\n0.0\n0.0\nNaN\n1.0\n0.0\n\n\n20252026\n\"R\"\n2025020103\n\"2025-10-21\"\n\"FLA\"\n\"BOS\"\n\"4v5\"\n9.3\n0\n1\n0.0\n0.868644\n0\n1\n0.337972\n0.40907\n0.388038\n0.357434\n2\n3\n1.78708\n2.569967\n0\n1\n3\n6\n2.6342\n5.125241\n0\n2\n3\n9\n2.6342\n5.125241\n0\n3\n0.0\n0.0\n1\n3\n1.205802\n2.56262\n0\n1\n0\n3\n1\n1\n0\n5\n1\n3\n3\n6\n0\n5\n0\n1\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n6.451613\n0.0\n5.604155\n0.0\n6.451613\n2.180462\n2.639159\n2.503471\n2.306027\n12.903226\n19.354839\n11.529549\n16.580431\n0.0\n6.451613\n19.354839\n38.709677\n16.994839\n33.066069\n0.0\n12.903226\n19.354839\n58.064516\n16.994839\n33.066069\n0.0\n19.354839\n0.0\n0.0\n6.451613\n19.354839\n7.77937\n16.533035\n0.0\n6.451613\n0.0\n19.354839\n6.451613\n6.451613\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.452414\n0.520526\n0.4\n0.410159\n0.0\n0.333333\n0.339483\n0.0\n0.25\n0.339483\n0.0\nNaN\n0.25\n0.319975\n0.0\n0.75\n0.0\n\n\n20252026\n\"R\"\n2025020849\n\"2026-01-29\"\n\"NYR\"\n\"NYI\"\n\"5v4\"\n5.366667\n1\n0\n0.868644\n0.0\n0\n0\n0.217852\n0.0\n0.190353\n0.0\n2\n0\n1.713311\n0.0\n0\n0\n2\n0\n1.708414\n0.0\n0\n0\n4\n0\n1.708414\n0.0\n2\n0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n3\n2\n0\n2\n1\n4\n3\n4\n2\n0\n1\n0\n0\n4\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n11.180124\n0.0\n9.711549\n0.0\n0.0\n0.0\n2.435613\n0.0\n2.128175\n0.0\n22.360248\n0.0\n19.155032\n0.0\n0.0\n0.0\n22.360248\n0.0\n19.100276\n0.0\n0.0\n0.0\n44.720497\n0.0\n19.100276\n0.0\n22.360248\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n33.540373\n22.360248\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\n1.0\nNaN\n1.0\n1.0\n1.0\n1.0\nNaN\n1.0\n1.0\nNaN\n1.0\n1.0\n1.0\nNaN\nNaN\nNaN\nNaN\n0.0\n0.0\n\n\n20252026\n\"R\"\n2025020247\n\"2025-11-09\"\n\"OTT\"\n\"UTA\"\n\"5vE\"\n2.766667\n0\n0\n0.0\n0.0\n0\n0\n0.594731\n0.609058\n0.594731\n0.609058\n0\n4\n0.0\n4.0\n0\n3\n1\n8\n1.0\n8.0\n0\n3\n2\n9\n1.0\n8.0\n1\n1\n0.0\n0.0\n1\n4\n1.0\n4.0\n0\n0\n0\n0\n1\n0\n0\n2\n0\n2\n2\n2\n0\n2\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n12.897772\n13.208493\n12.897772\n13.208493\n0.0\n86.746988\n0.0\n86.746988\n0.0\n65.060241\n21.686747\n173.493976\n21.686747\n173.493976\n0.0\n65.060241\n43.373494\n195.180723\n21.686747\n173.493976\n21.686747\n21.686747\n0.0\n0.0\n21.686747\n86.746988\n21.686747\n86.746988\n0.0\n0.0\n0.0\n0.0\n21.686747\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\nNaN\nNaN\nNaN\n0.494049\n0.494049\n0.0\n0.0\n0.0\n0.111111\n0.111111\n0.0\n0.181818\n0.111111\n0.5\nNaN\n0.2\n0.2\nNaN\n0.0\nNaN\n\n\n20252026\n\"R\"\n2025020092\n\"2025-10-19\"\n\"UTA\"\n\"BOS\"\n\"5vE\"\n1.183333\n0\n0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n2\n1\n0.0\n0.0\n2\n1\n0.0\n0.0\n0\n0\n0.0\n0.0\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n101.408451\n50.704225\n0.0\n0.0\n101.408451\n50.704225\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n50.704225\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n0.666667\nNaN\n0.666667\nNaN\nNaN\nNaN\nNaN\n1.0\nNaN"
  },
  {
    "objectID": "blog/posts/tutorials/monte_carlo/index.html#munge-the-data",
    "href": "blog/posts/tutorials/monte_carlo/index.html#munge-the-data",
    "title": "Simulating today’s hockey games",
    "section": "Munge the data",
    "text": "Munge the data\nCleaning the data and prepping for analysis\n\nAdd Home games to the data set\nCheck to see if team is the home team, adding a dummy column\n\nhome_map = dict(zip(schedule[\"game_id\"], schedule[\"home_team\"], strict=False))\n\nteam_stats = team_stats.with_columns(\n    is_home=pl.when(pl.col(\"game_id\").replace_strict(home_map, return_dtype=str) == pl.col(\"team\"))\n    .then(pl.lit(1))\n    .otherwise(pl.lit(0))\n)\n\n\n\nAggregate strength state\nAdd a column to aggregate strength states (e.g., powerplay for 5v4, 5v3, and 4v3)\n\nteam_stats = aggregate_strength_states(team_stats)\n\n\n\nPrep overall NHL stats\nFunction to calculate the goals scored and allowed above the expected goals model, at the overall NHL season level, adjusted for score and venue\n\nnhl_stats = prep_nhl_stats(team_stats)\n\n\nnhl_stats.head(5)\n\n\nshape: (5, 81)\n\n\n\nseason\nsession\nis_home\nstrength_state2\ntoi\ngf\nga\ngf_adj\nga_adj\nhdgf\nhdga\nxgf\nxga\nxgf_adj\nxga_adj\nsf\nsa\nsf_adj\nsa_adj\nhdsf\nhdsa\nff\nfa\nff_adj\nfa_adj\nhdff\nhdfa\ncf\nca\ncf_adj\nca_adj\nbsf\nbsa\nbsf_adj\nbsa_adj\nmsf\nmsa\nmsf_adj\nmsa_adj\nhdmsf\nhdmsa\nteammate_block\nhf\nht\ngive\ntake\nozf\nnzf\ndzf\nfow\nfol\nozfw\nozfl\nnzfw\nnzfl\ndzfw\ndzfl\npent0\npent2\npent4\npent5\npent10\npend0\npend2\npend4\npend5\npend10\ngame_id\ng_score_ax\ng_save_ax\ntoi_gp\ngf_p60\nga_p60\ngf_adj_p60\nga_adj_p60\nxgf_p60\nxga_p60\nxgf_adj_p60\nxga_adj_p60\ng_score_ax_p60\ng_save_ax_p60\n\n\ni64\nstr\ni32\nstr\nf64\ni64\ni64\nf64\nf64\ni64\ni64\nf64\nf64\nf64\nf64\ni64\ni64\nf64\nf64\ni64\ni64\ni64\ni64\nf64\nf64\ni64\ni64\ni64\ni64\nf64\nf64\ni64\ni64\nf64\nf64\ni64\ni64\nf64\nf64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\nu32\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\n\n\n\n\n20252026\n\"R\"\n0\n\"Ev5\"\n536.35\n57\n166\n57.0\n166.0\n20\n37\n69.020614\n179.961909\n69.020614\n179.961909\n494\n166\n494.0\n166.0\n159\n37\n794\n307\n794.0\n306.0\n228\n37\n1150\n418\n794.0\n306.0\n318\n111\n0.0\n0.0\n300\n141\n300.0\n140.0\n69\n0\n38\n67\n94\n109\n24\n262\n29\n211\n274\n228\n262\n0\n12\n17\n0\n211\n0\n23\n0\n3\n6\n0\n332\n4\n2\n2\n483\n-12.020614\n13.961909\n1.110455\n6.376433\n18.569964\n6.376433\n18.569964\n7.721146\n20.131844\n7.721146\n20.131844\n-1.344713\n1.56188\n\n\n20252026\n\"R\"\n0\n\"3vE\"\n2.5\n0\n0\n0.0\n0.0\n0\n0\n0.0\n1.110907\n0.0\n1.110907\n0\n6\n0.0\n6.0\n0\n2\n0\n8\n0.0\n8.0\n0\n2\n0\n9\n0.0\n8.0\n0\n1\n0.0\n0.0\n0\n2\n0.0\n2.0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n2\n2\n1\n0\n1\n0\n0\n2\n0\n0\n6\n0\n0\n0\n0\n0\n0\n0\n0\n9\n0.0\n1.110907\n0.277778\n0.0\n0.0\n0.0\n0.0\n0.0\n26.661775\n0.0\n26.661775\n0.0\n26.661775\n\n\n20252026\n\"R\"\n0\n\"Ev4\"\n40.0\n9\n10\n9.0\n10.0\n3\n2\n8.10169\n7.612753\n8.10169\n7.612753\n45\n10\n45.0\n10.0\n7\n2\n78\n15\n78.0\n15.0\n12\n2\n111\n22\n78.0\n15.0\n28\n7\n0.0\n0.0\n33\n5\n33.0\n5.0\n5\n0\n5\n1\n4\n5\n2\n34\n1\n13\n34\n14\n34\n0\n0\n1\n0\n13\n0\n2\n0\n0\n0\n0\n8\n0\n0\n0\n53\n0.89831\n-2.387247\n0.754717\n13.5\n15.0\n13.5\n15.0\n12.152535\n11.419129\n12.152535\n11.419129\n1.347465\n-3.580871\n\n\n20252026\n\"R\"\n0\n\"powerplay\"\n4105.033333\n514\n49\n555.923431\n51.608182\n222\n26\n632.442075\n50.900359\n685.593593\n47.745515\n3541\n625\n3757.638052\n659.030873\n1103\n119\n5362\n793\n5728.852631\n842.420465\n1592\n150\n6988\n891\n5728.852631\n842.420465\n1463\n98\n0.0\n0.0\n1821\n168\n1945.086182\n158.628621\n489\n31\n163\n179\n517\n823\n174\n1943\n624\n1732\n2334\n1965\n1888\n55\n347\n277\n99\n1633\n4\n154\n0\n2\n1\n0\n87\n4\n2\n1\n883\n-129.670162\n-3.862667\n4.648962\n7.512728\n0.716194\n8.12549\n0.754316\n9.243902\n0.74397\n10.020775\n0.697858\n-1.895285\n-0.056458\n\n\n20252026\n\"R\"\n1\n\"ILLEGAL\"\n1.9\n0\n0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0.0\n0.0\n0\n2\n0.0\n0.0\n0\n0\n0\n2\n0.0\n0.0\n0\n0\n0\n2\n0.0\n0.0\n0\n0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0\n0\n0\n2\n0\n1\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n4\n0\n0\n0\n0\n13\n0\n0\n0\n19\n0.0\n0.0\n0.1\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n\n\n\n\n\n\nPrep team stats\nFunction to prep and aggregate team stats to match up with the schedule for predicting the game’s values\n\nteam_stats_agg = prep_team_stats(team_stats=team_stats, nhl_stats=nhl_stats, latest_date=latest_date)\n\n\nteam_stats_agg.head(5)\n\n\nshape: (5, 98)\n\n\n\nseason\nsession\nteam\nis_home\nstrength_state2\ntoi\ngf\nga\ngf_adj\nga_adj\nhdgf\nhdga\nxgf\nxga\nxgf_adj\nxga_adj\nsf\nsa\nsf_adj\nsa_adj\nhdsf\nhdsa\nff\nfa\nff_adj\nfa_adj\nhdff\nhdfa\ncf\nca\ncf_adj\nca_adj\nbsf\nbsa\nbsf_adj\nbsa_adj\nmsf\nmsa\nmsf_adj\nmsa_adj\nhdmsf\nhdmsa\nteammate_block\nhf\nht\ngive\ntake\nozf\nnzf\ndzf\nfow\nfol\nozfw\nozfl\nnzfw\nnzfl\ndzfw\ndzfl\npent0\npent2\npent4\npent5\npent10\npend0\npend2\npend4\npend5\npend10\ngame_id\ng_score_ax\ng_save_ax\ntoi_gp\ngf_p60\nga_p60\ngf_adj_p60\nga_adj_p60\nxgf_p60\nxga_p60\nxgf_adj_p60\nxga_adj_p60\ng_score_ax_p60\ng_save_ax_p60\nmean_xgf_p60\nmean_xga_p60\nmean_xgf_adj_p60\nmean_xga_adj_p60\nmean_gf_p60\nmean_ga_p60\nmean_gf_adj_p60\nmean_ga_adj_p60\nmean_g_score_ax_p60\nmean_g_save_ax_p60\nmean_toi_gp\noff_strength\ndef_strength\ntoi_comparison\nscoring_strength\ngoalie_strength\n\n\ni64\nstr\nstr\ni32\nstr\nf64\ni64\ni64\nf64\nf64\ni64\ni64\nf64\nf64\nf64\nf64\ni64\ni64\nf64\nf64\ni64\ni64\ni64\ni64\nf64\nf64\ni64\ni64\ni64\ni64\nf64\nf64\ni64\ni64\nf64\nf64\ni64\ni64\nf64\nf64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\ni64\nu32\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\n\n\n\n\n20252026\n\"R\"\n\"CBJ\"\n1\n\"4vE\"\n0.866667\n1\n0\n1.0\n0.0\n0\n0\n0.61581\n0.049193\n0.61581\n0.049193\n1\n1\n1.0\n1.0\n0\n0\n1\n1\n1.0\n1.0\n0\n0\n1\n1\n1.0\n1.0\n0\n0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0.38419\n0.049193\n0.866667\n69.230769\n0.0\n69.230769\n0.0\n42.63297\n3.405685\n42.63297\n3.405685\n26.5978\n3.405685\n11.419129\n12.152535\n11.419129\n12.152535\n15.0\n13.5\n15.0\n13.5\n3.580871\n-1.347465\n0.754717\n3.733469\n0.280245\n1.148333\n7.427746\n-2.527476\n\n\n20252026\n\"R\"\n\"NSH\"\n1\n\"4vE\"\n1.766667\n0\n1\n0.0\n1.0\n0\n0\n0.0\n0.13276\n0.0\n0.13276\n0\n2\n0.0\n2.0\n0\n0\n0\n4\n0.0\n4.0\n0\n0\n0\n4\n0.0\n4.0\n0\n0\n0.0\n0.0\n0\n2\n0.0\n2.0\n0\n0\n0\n0\n0\n0\n0\n2\n0\n0\n0\n2\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n2\n0.0\n-0.86724\n0.883333\n0.0\n33.962264\n0.0\n33.962264\n0.0\n4.508823\n0.0\n4.508823\n0.0\n-29.453441\n11.419129\n12.152535\n11.419129\n12.152535\n15.0\n13.5\n15.0\n13.5\n3.580871\n-1.347465\n0.754717\n0.0\n0.371019\n1.170417\n0.0\n21.858415\n\n\n20252026\n\"R\"\n\"DAL\"\n0\n\"ILLEGAL\"\n0.383333\n0\n0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n3\n0.0\n0.0\n0.127778\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.1\nNaN\nNaN\n1.277778\nNaN\nNaN\n\n\n20252026\n\"R\"\n\"PHI\"\n0\n\"ILLEGAL\"\n0.083333\n0\n0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0.0\n0.0\n1\n0\n0.0\n0.0\n0\n0\n1\n0\n0.0\n0.0\n0\n0\n1\n0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0\n0\n0.0\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0.0\n0.0\n0.083333\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.1\nNaN\nNaN\n0.833333\nNaN\nNaN\n\n\n20252026\n\"R\"\n\"NJD\"\n0\n\"shorthanded\"\n120.933333\n2\n16\n1.737288\n15.06796\n0\n6\n1.977491\n20.020203\n2.213706\n18.863242\n17\n116\n16.053371\n110.466815\n6\n33\n24\n171\n22.643352\n162.09692\n6\n52\n27\n213\n22.643352\n162.09692\n3\n42\n0.0\n0.0\n7\n55\n7.463236\n52.44747\n0\n19\n0\n13\n7\n19\n11\n73\n18\n58\n64\n85\n2\n71\n6\n12\n56\n2\n0\n5\n0\n0\n0\n0\n6\n0\n0\n0\n26\n-0.476418\n3.795282\n4.651282\n0.992282\n7.938258\n0.86194\n7.475834\n0.981115\n9.932846\n1.098311\n9.35883\n-0.236371\n1.882996\n0.755118\n9.38011\n0.826901\n8.675806\n0.892854\n7.649225\n0.836282\n7.069986\n0.009381\n1.60582\n5.064586\n1.328225\n1.078727\n0.918393\n-25.197613\n1.172607\n\n\n\n\n\n\n\n\nPrep today’s games\nFunction to prepare today’s games\n\ntodays_games = prep_todays_games(schedule=schedule, team_stats=team_stats, nhl_stats=nhl_stats, latest_date=latest_date)\n\n\ntodays_games.head(5)\n\n\nshape: (5, 128)\n\n\n\nseason\nsession\ngame_id\ngame_date\nstart_time\ngame_state\nhome_team\nhome_team_id\nhome_score\naway_team\naway_team_id\naway_score\nvenue\nvenue_timezone\nneutral_site\ngame_date_dt_utc\ntv_broadcasts\nhome_logo\nhome_logo_dark\naway_logo\naway_logo_dark\nhome_5v5_off_strength\nhome_5v5_def_strength\nhome_5v5_scoring_strength\nhome_5v5_goalie_strength\nhome_5v5_toi_comparison\nhome_powerplay_off_strength\nhome_powerplay_scoring_strength\nhome_powerplay_toi_comparison\nhome_shorthanded_def_strength\nhome_shorthanded_goalie_strength\nhome_shorthanded_toi_comparison\naway_5v5_off_strength\naway_5v5_def_strength\naway_5v5_scoring_strength\naway_5v5_goalie_strength\naway_5v5_toi_comparison\naway_powerplay_off_strength\naway_powerplay_scoring_strength\naway_powerplay_toi_comparison\naway_shorthanded_def_strength\naway_shorthanded_goalie_strength\naway_shorthanded_toi_comparison\nmean_home_5v5_xgf_p60\nmean_home_5v5_xga_p60\nmean_home_5v5_xgf_adj_p60\nmean_home_5v5_xga_adj_p60\nmean_home_5v5_gf_p60\nmean_home_5v5_ga_p60\nmean_home_5v5_gf_adj_p60\nmean_home_5v5_ga_adj_p60\nmean_home_5v5_g_score_ax_p60\nmean_home_5v5_g_save_ax_p60\nmean_home_5v5_toi_gp\nmean_home_powerplay_xgf_p60\nmean_home_powerplay_xga_p60\nmean_home_powerplay_xgf_adj_p60\nmean_home_powerplay_xga_adj_p60\nmean_home_powerplay_gf_p60\nmean_home_powerplay_ga_p60\nmean_home_powerplay_gf_adj_p60\nmean_home_powerplay_ga_adj_p60\nmean_home_powerplay_g_score_ax_p60\nmean_home_powerplay_g_save_ax_p60\nmean_home_powerplay_toi_gp\nmean_home_shorthanded_xgf_p60\nmean_home_shorthanded_xga_p60\nmean_home_shorthanded_xgf_adj_p60\nmean_home_shorthanded_xga_adj_p60\nmean_home_shorthanded_gf_p60\nmean_home_shorthanded_ga_p60\nmean_home_shorthanded_gf_adj_p60\nmean_home_shorthanded_ga_adj_p60\nmean_home_shorthanded_g_score_ax_p60\nmean_home_shorthanded_g_save_ax_p60\nmean_home_shorthanded_toi_gp\nmean_away_5v5_xgf_p60\nmean_away_5v5_xga_p60\nmean_away_5v5_xgf_adj_p60\nmean_away_5v5_xga_adj_p60\nmean_away_5v5_gf_p60\nmean_away_5v5_ga_p60\nmean_away_5v5_gf_adj_p60\nmean_away_5v5_ga_adj_p60\nmean_away_5v5_g_score_ax_p60\nmean_away_5v5_g_save_ax_p60\nmean_away_5v5_toi_gp\nmean_away_powerplay_xgf_p60\nmean_away_powerplay_xga_p60\nmean_away_powerplay_xgf_adj_p60\nmean_away_powerplay_xga_adj_p60\nmean_away_powerplay_gf_p60\nmean_away_powerplay_ga_p60\nmean_away_powerplay_gf_adj_p60\nmean_away_powerplay_ga_adj_p60\nmean_away_powerplay_g_score_ax_p60\nmean_away_powerplay_g_save_ax_p60\nmean_away_powerplay_toi_gp\nmean_away_shorthanded_xgf_p60\nmean_away_shorthanded_xga_p60\nmean_away_shorthanded_xgf_adj_p60\nmean_away_shorthanded_xga_adj_p60\nmean_away_shorthanded_gf_p60\nmean_away_shorthanded_ga_p60\nmean_away_shorthanded_gf_adj_p60\nmean_away_shorthanded_ga_adj_p60\nmean_away_shorthanded_g_score_ax_p60\nmean_away_shorthanded_g_save_ax_p60\nmean_away_shorthanded_toi_gp\npredicted_home_5v5_toi\npredicted_home_powerplay_toi\npredicted_home_shorthanded_toi\npredicted_home_5v5_xgf_p60\npredicted_home_5v5_xga_p60\npredicted_home_5v5_gf_p60\npredicted_home_5v5_ga_p60\npredicted_home_powerplay_xgf_p60\npredicted_home_powerplay_gf_p60\npredicted_home_shorthanded_xga_p60\npredicted_home_shorthanded_ga_p60\npredicted_away_5v5_xgf_p60\npredicted_away_5v5_xga_p60\npredicted_away_5v5_gf_p60\npredicted_away_5v5_ga_p60\npredicted_away_powerplay_xgf_p60\npredicted_away_powerplay_gf_p60\npredicted_away_shorthanded_xga_p60\npredicted_away_shorthanded_ga_p60\n\n\ni64\ni64\ni64\nstr\nstr\nstr\nstr\ni64\ni64\nstr\ni64\ni64\nstr\nstr\ni64\ndatetime[μs, UTC]\nlist[struct[5]]\nstr\nstr\nstr\nstr\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\n\n\n\n\n20252026\n2\n2025020810\n\"2026-01-24\"\n\"13:00\"\n\"OFF\"\n\"NYI\"\n2\n0\n\"BUF\"\n7\n5\n\"UBS ARENA\"\n\"America/New_York\"\n0\n2026-01-24 18:00:00 UTC\n[{282,\"N\",\"CA\",\"SN\",107}, {28,\"A\",\"US\",\"MSG-B\",392}, {409,\"H\",\"US\",\"MSGSN\",411}]\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n1.032099\n1.098022\n1.215772\n2.5018\n0.998547\n1.019476\n1.519422\n1.078344\n1.166022\n2.812028\n0.972322\n1.013831\n0.959593\n1.192254\n0.226348\n1.002412\n1.015596\n2.379345\n1.059298\n0.962996\n1.663244\n0.847453\n2.941164\n2.728581\n2.816787\n2.851487\n2.533148\n2.485146\n2.43756\n2.566546\n-0.379227\n0.28494\n48.501035\n9.38011\n0.755118\n8.675806\n0.826901\n7.649225\n0.892854\n7.069986\n0.836282\n-1.60582\n-0.009381\n5.064586\n0.74397\n9.243902\n0.697858\n10.020775\n0.686962\n7.512728\n0.754316\n8.12549\n0.056458\n1.895285\n4.648962\n2.728581\n2.941164\n2.851487\n2.816787\n2.483774\n2.535891\n2.566546\n2.43756\n-0.28494\n0.379227\n48.501035\n9.243902\n0.74397\n10.020775\n0.697858\n7.512728\n0.716194\n8.12549\n0.754316\n-1.895285\n-0.056458\n4.648962\n0.755118\n9.38011\n0.826901\n8.675806\n0.892854\n7.649225\n0.836282\n7.069986\n0.009381\n1.60582\n5.064586\n48.547351\n4.628251\n4.788336\n2.789734\n3.174302\n0.664344\n8.522113\n8.51749\n17.541011\n11.866671\n64.38049\n3.174302\n2.789734\n8.522113\n0.664344\n11.866671\n64.38049\n8.51749\n17.541011\n\n\n20252026\n2\n2025020811\n\"2026-01-24\"\n\"12:30\"\n\"OFF\"\n\"NSH\"\n18\n2\n\"UTA\"\n68\n5\n\"BRIDGESTONE ARENA\"\n\"US/Central\"\n0\n2026-01-24 18:30:00 UTC\n[{282,\"N\",\"CA\",\"SN\",107}, {284,\"N\",\"CA\",\"SN1\",113}, … {558,\"A\",\"US\",\"Utah16\",381}]\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n1.029662\n0.983516\n2.188479\n-0.431273\n0.978291\n0.817146\n0.418178\n0.987613\n0.86872\n2.024623\n1.145351\n1.072654\n0.912573\n1.046681\n0.277726\n1.004538\n0.78517\n0.944735\n1.00629\n0.908922\n1.070264\n1.009018\n2.941164\n2.728581\n2.816787\n2.851487\n2.533148\n2.485146\n2.43756\n2.566546\n-0.379227\n0.28494\n48.501035\n9.38011\n0.755118\n8.675806\n0.826901\n7.649225\n0.892854\n7.069986\n0.836282\n-1.60582\n-0.009381\n5.064586\n0.74397\n9.243902\n0.697858\n10.020775\n0.686962\n7.512728\n0.754316\n8.12549\n0.056458\n1.895285\n4.648962\n2.728581\n2.941164\n2.851487\n2.816787\n2.483774\n2.535891\n2.566546\n2.43756\n-0.28494\n0.379227\n48.501035\n9.243902\n0.74397\n10.020775\n0.697858\n7.512728\n0.716194\n8.12549\n0.754316\n-1.895285\n-0.056458\n4.648962\n0.755118\n9.38011\n0.826901\n8.675806\n0.892854\n7.649225\n0.836282\n7.069986\n0.009381\n1.60582\n5.064586\n47.663489\n5.046957\n5.358185\n2.646771\n3.008242\n1.392119\n-1.22224\n6.443714\n2.350161\n6.835096\n10.601006\n3.008242\n2.646771\n-1.22224\n1.392119\n6.835096\n10.601006\n6.443714\n2.350161\n\n\n20252026\n2\n2025020812\n\"2026-01-24\"\n\"19:00\"\n\"OFF\"\n\"BOS\"\n6\n4\n\"MTL\"\n8\n3\n\"TD GARDEN\"\n\"US/Eastern\"\n0\n2026-01-25 00:00:00 UTC\n[{287,\"N\",\"CA\",\"SNE\",30}, {288,\"N\",\"CA\",\"SNO\",31}, … {31,\"H\",\"US\",\"NESN\",405}]\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n0.985353\n1.063828\n0.149162\n2.623023\n0.977731\n0.945022\n-0.130636\n1.008577\n1.088831\n1.718694\n1.165002\n0.888426\n0.943972\n-0.718902\n1.236217\n0.976611\n1.072128\n-0.141762\n1.132869\n1.026001\n0.702074\n1.108745\n2.941164\n2.728581\n2.816787\n2.851487\n2.533148\n2.485146\n2.43756\n2.566546\n-0.379227\n0.28494\n48.501035\n9.38011\n0.755118\n8.675806\n0.826901\n7.649225\n0.892854\n7.069986\n0.836282\n-1.60582\n-0.009381\n5.064586\n0.74397\n9.243902\n0.697858\n10.020775\n0.686962\n7.512728\n0.754316\n8.12549\n0.056458\n1.895285\n4.648962\n2.728581\n2.941164\n2.851487\n2.816787\n2.483774\n2.535891\n2.566546\n2.43756\n-0.28494\n0.379227\n48.501035\n9.243902\n0.74397\n10.020775\n0.697858\n7.512728\n0.716194\n8.12549\n0.754316\n-1.895285\n-0.056458\n4.648962\n0.755118\n9.38011\n0.826901\n8.675806\n0.892854\n7.649225\n0.836282\n7.069986\n0.009381\n1.60582\n5.064586\n46.31188\n5.663496\n6.135677\n2.620023\n2.695034\n0.418081\n-4.574184\n8.412006\n-0.628717\n11.697909\n-2.311086\n2.695034\n2.620023\n-4.574184\n0.418081\n11.697909\n-2.311086\n8.412006\n-0.628717\n\n\n20252026\n2\n2025020813\n\"2026-01-24\"\n\"19:00\"\n\"OFF\"\n\"OTT\"\n9\n1\n\"CAR\"\n12\n4\n\"CANADIAN TIRE CENTRE\"\n\"US/Eastern\"\n0\n2026-01-25 00:00:00 UTC\n[{284,\"N\",\"CA\",\"SN1\",113}, {286,\"N\",\"CA\",\"CITY\",137}, {561,\"A\",\"US\",\"FDSNSO\",202}]\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n0.991645\n0.818598\n1.545365\n-0.907254\n0.968379\n0.89586\n-0.503662\n1.15124\n0.725061\n-0.22982\n1.058032\n1.198828\n0.966861\n2.877418\n1.415492\n0.993524\n0.968843\n1.812915\n1.140039\n0.713705\n0.434465\n1.074454\n2.941164\n2.728581\n2.816787\n2.851487\n2.533148\n2.485146\n2.43756\n2.566546\n-0.379227\n0.28494\n48.501035\n9.38011\n0.755118\n8.675806\n0.826901\n7.649225\n0.892854\n7.069986\n0.836282\n-1.60582\n-0.009381\n5.064586\n0.74397\n9.243902\n0.697858\n10.020775\n0.686962\n7.512728\n0.754316\n8.12549\n0.056458\n1.895285\n4.648962\n2.728581\n2.941164\n2.851487\n2.816787\n2.483774\n2.535891\n2.566546\n2.43756\n-0.28494\n0.379227\n48.501035\n9.243902\n0.74397\n10.020775\n0.697858\n7.512728\n0.716194\n8.12549\n0.754316\n-1.895285\n-0.056458\n4.648962\n0.755118\n9.38011\n0.826901\n8.675806\n0.892854\n7.649225\n0.836282\n7.069986\n0.009381\n1.60582\n5.064586\n46.663215\n6.264666\n5.607569\n2.700687\n2.798327\n5.112274\n-6.57519\n5.547136\n-0.989171\n7.039295\n-2.378168\n2.798327\n2.700687\n-6.57519\n5.112274\n7.039295\n-2.378168\n5.547136\n-0.989171\n\n\n20252026\n2\n2025020814\n\"2026-01-24\"\n\"19:00\"\n\"OFF\"\n\"CBJ\"\n29\n8\n\"TBL\"\n14\n5\n\"NATIONWIDE ARENA\"\n\"US/Eastern\"\n0\n2026-01-25 00:00:00 UTC\n[{581,\"A\",\"US\",\"The Spot\",211}, {565,\"H\",\"US\",\"FDSNOH\",286}]\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n\"https://assets.nhle.com/logos/…\n1.010127\n1.054735\n0.755682\n2.576822\n1.030619\n1.068771\n2.476875\n0.822706\n1.036681\n-0.315558\n0.956388\n1.185417\n0.853779\n0.201814\n1.910094\n0.965921\n0.948375\n0.145274\n1.09516\n0.959875\n2.335107\n1.097917\n2.941164\n2.728581\n2.816787\n2.851487\n2.533148\n2.485146\n2.43756\n2.566546\n-0.379227\n0.28494\n48.501035\n9.38011\n0.755118\n8.675806\n0.826901\n7.649225\n0.892854\n7.069986\n0.836282\n-1.60582\n-0.009381\n5.064586\n0.74397\n9.243902\n0.697858\n10.020775\n0.686962\n7.512728\n0.754316\n8.12549\n0.056458\n1.895285\n4.648962\n2.728581\n2.941164\n2.851487\n2.816787\n2.483774\n2.535891\n2.566546\n2.43756\n-0.28494\n0.379227\n48.501035\n9.243902\n0.74397\n10.020775\n0.697858\n7.512728\n0.716194\n8.12549\n0.754316\n-1.895285\n-0.056458\n4.648962\n0.755118\n9.38011\n0.826901\n8.675806\n0.892854\n7.649225\n0.836282\n7.069986\n0.009381\n1.60582\n5.064586\n48.282614\n4.574653\n4.869315\n2.429269\n3.565215\n3.034386\n1.668781\n8.900392\n41.949684\n9.852042\n-0.36622\n3.565215\n2.429269\n1.668781\n3.034386\n9.852042\n-0.36622\n8.900392\n41.949684"
  },
  {
    "objectID": "blog/posts/tutorials/monte_carlo/index.html#simulating-the-actual-games",
    "href": "blog/posts/tutorials/monte_carlo/index.html#simulating-the-actual-games",
    "title": "Simulating today’s hockey games",
    "section": "Simulating the actual games",
    "text": "Simulating the actual games\nFunctions to simulate the games\n\nRandom float\nGenerate a random floating number between 0 and 1\ndef random_float() -&gt; float: “““Generate a random floating number between 0 and 1.”“” random_generator = np.random.default_rng()\n# return random_generator.triangular(left=0.0, mode=0.5, right=1.0)\nreturn random_generator.random()\n\n\nSimulating an individual game\nPredicts various game values, based on a poissoin distribution\n\ngame = todays_games.filter((pl.col(\"away_team\") == \"NSH\") | (pl.col(\"home_team\") == \"NSH\")).to_dicts()[0]\n\n\npl.DataFrame(simulate_game(game))  # Showing it as a dataframe just to make it easy\n\n\nshape: (1, 26)\n\n\n\ngame_id\nhome_team\naway_team\npredicted_home_5v5_toi\npredicted_home_powerplay_toi\npredicted_home_shorthanded_toi\npredicted_away_5v5_toi\npredicted_away_powerplay_toi\npredicted_away_shorthanded_toi\npredicted_home_5v5_gf_p60\npredicted_home_5v5_xgf_p60\npredicted_home_powerplay_gf_p60\npredicted_home_powerplay_xgf_p60\npredicted_home_5v5_goals\npredicted_home_powerplay_goals\npredicted_home_total_goals\npredicted_away_5v5_gf_p60\npredicted_away_5v5_xgf_p60\npredicted_away_powerplay_gf_p60\npredicted_away_powerplay_xgf_p60\npredicted_away_5v5_goals\npredicted_away_powerplay_goals\npredicted_away_total_goals\nhome_win\naway_win\ndraw\n\n\ni64\nstr\nstr\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\ni64\ni64\ni64\n\n\n\n\n2025020811\n\"NSH\"\n\"UTA\"\n43.0\n2.0\n8.0\n43.0\n8.0\n2.0\n3.0\n3.0\n1.0\n13.0\n2.15\n0.433333\n2.583333\nNaN\n1.0\n18.0\n5.0\n0.716667\n0.666667\n1.383333\n1\n0\n0\n\n\n\n\n\n\n\n\nPredict an entire game\nPredict an entire game based on n number of simulations\n\npredicted_game = predict_game(game, 100)\n\n\n\n\n\n\n\n\npredicted_game.head(5)\n\n\nshape: (5, 26)\n\n\n\ngame_id\nhome_team\naway_team\npredicted_home_5v5_toi\npredicted_home_powerplay_toi\npredicted_home_shorthanded_toi\npredicted_away_5v5_toi\npredicted_away_powerplay_toi\npredicted_away_shorthanded_toi\npredicted_home_5v5_gf_p60\npredicted_home_5v5_xgf_p60\npredicted_home_powerplay_gf_p60\npredicted_home_powerplay_xgf_p60\npredicted_home_5v5_goals\npredicted_home_powerplay_goals\npredicted_home_total_goals\npredicted_away_5v5_gf_p60\npredicted_away_5v5_xgf_p60\npredicted_away_powerplay_gf_p60\npredicted_away_powerplay_xgf_p60\npredicted_away_5v5_goals\npredicted_away_powerplay_goals\npredicted_away_total_goals\nhome_win\naway_win\ndraw\n\n\ni64\nstr\nstr\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\ni64\ni64\ni64\n\n\n\n\n2025020811\n\"NSH\"\n\"UTA\"\n49.6\n4.0\n6.4\n49.6\n6.4\n4.0\n0.0\n3.0\n2.0\n8.0\n2.48\n0.533333\n3.013333\nNaN\n1.0\n14.0\n4.0\n0.826667\n0.426667\n1.253333\n1\n0\n0\n\n\n2025020811\n\"NSH\"\n\"UTA\"\n36.0\n3.0\n4.0\n36.0\n4.0\n3.0\n2.0\n1.0\n1.0\n4.0\n0.6\n0.2\n0.8\nNaN\n2.0\n13.0\n6.0\n1.2\n0.4\n1.6\n0\n1\n0\n\n\n2025020811\n\"NSH\"\n\"UTA\"\n44.262295\n7.868852\n7.868852\n44.262295\n7.868852\n7.868852\n1.0\n1.0\n2.0\n9.0\n0.737705\n1.180328\n1.918033\nNaN\n5.0\n12.0\n1.0\n3.688525\n0.131148\n3.819672\n0\n1\n0\n\n\n2025020811\n\"NSH\"\n\"UTA\"\n49.52381\n5.714286\n4.761905\n49.52381\n4.761905\n5.714286\n1.0\n3.0\n1.0\n6.0\n2.47619\n0.571429\n3.047619\nNaN\n5.0\n10.0\n8.0\n4.126984\n0.634921\n4.761905\n0\n1\n0\n\n\n2025020811\n\"NSH\"\n\"UTA\"\n44.0\n6.0\n9.0\n44.0\n9.0\n6.0\n0.0\n1.0\n4.0\n9.0\n0.733333\n0.9\n1.633333\nNaN\n6.0\n11.0\n4.0\n4.4\n0.6\n5.0\n0\n1\n0\n\n\n\n\n\n\n\n\nSimulating multiple games\nSimulating multiple games at once\n\npredictions = predict_games(predict_game, todays_games, total_simulations=1_000, n_workers=1, disable_progress_bar=True)\n\n\npredictions.head(5)\n\n\nshape: (5, 26)\n\n\n\ngame_id\nhome_team\naway_team\npredicted_home_5v5_toi\npredicted_home_powerplay_toi\npredicted_home_shorthanded_toi\npredicted_away_5v5_toi\npredicted_away_powerplay_toi\npredicted_away_shorthanded_toi\npredicted_home_5v5_gf_p60\npredicted_home_5v5_xgf_p60\npredicted_home_powerplay_gf_p60\npredicted_home_powerplay_xgf_p60\npredicted_home_5v5_goals\npredicted_home_powerplay_goals\npredicted_home_total_goals\npredicted_away_5v5_gf_p60\npredicted_away_5v5_xgf_p60\npredicted_away_powerplay_gf_p60\npredicted_away_powerplay_xgf_p60\npredicted_away_5v5_goals\npredicted_away_powerplay_goals\npredicted_away_total_goals\nhome_win\naway_win\ndraw\n\n\ni64\nstr\nstr\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\ni64\ni64\ni64\n\n\n\n\n2025020810\n\"NYI\"\n\"BUF\"\n52.5\n2.5\n5.0\n52.5\n5.0\n2.5\n0.0\n2.0\n16.0\n12.0\n1.75\n0.5\n2.25\n7.0\n4.0\n55.0\n12.0\n3.5\n1.0\n4.5\n0\n1\n0\n\n\n2025020810\n\"NYI\"\n\"BUF\"\n52.131148\n1.967213\n5.901639\n52.131148\n5.901639\n1.967213\n0.0\n3.0\n22.0\n10.0\n2.606557\n0.327869\n2.934426\n9.0\n4.0\n59.0\n6.0\n3.47541\n0.590164\n4.065574\n0\n1\n0\n\n\n2025020810\n\"NYI\"\n\"BUF\"\n52.5\n4.6875\n2.8125\n52.5\n2.8125\n4.6875\n0.0\n5.0\n19.0\n9.0\n4.375\n0.703125\n5.078125\n9.0\n5.0\n59.0\n15.0\n4.375\n0.703125\n5.078125\n0\n0\n1\n\n\n2025020810\n\"NYI\"\n\"BUF\"\n33.0\n10.0\n2.0\n33.0\n2.0\n10.0\n0.0\n1.0\n22.0\n13.0\n0.55\n2.166667\n2.716667\n9.0\n3.0\n66.0\n20.0\n1.65\n0.666667\n2.316667\n1\n0\n0\n\n\n2025020810\n\"NYI\"\n\"BUF\"\n40.0\n1.0\n0.0\n40.0\n0.0\n1.0\n1.0\n4.0\n11.0\n5.0\n2.666667\n0.083333\n2.75\n8.0\n5.0\n59.0\n16.0\n3.333333\n0.0\n3.333333\n0\n1\n0"
  },
  {
    "objectID": "blog/posts/tutorials/monte_carlo/index.html#assessing-results",
    "href": "blog/posts/tutorials/monte_carlo/index.html#assessing-results",
    "title": "Simulating today’s hockey games",
    "section": "Assessing results",
    "text": "Assessing results\nCheck to see if the simulation is accurate\n\nProcess winners\nAggregate the predictions to “predict” a winner\n\npredicted_winners = process_winners(predictions)\n\n\npredicted_winners\n\n\nshape: (9, 26)\n\n\n\ngame_id\nhome_team\naway_team\npredicted_winner\npredicted_home_win\npredicted_away_win\npredicted_draw\npredicted_home_win_percent\npredicted_away_win_percent\npredicted_draw_percent\npredicted_home_5v5_goals_mean\npredicted_home_powerplay_goals_mean\npredicted_home_total_goals_mean\npredicted_home_5v5_xgf_p60_mean\npredicted_home_powerplay_xgf_p60_mean\npredicted_home_5v5_toi_mean\npredicted_home_powerplay_toi_mean\npredicted_home_shorthanded_toi_mean\npredicted_away_5v5_goals_mean\npredicted_away_powerplay_goals_mean\npredicted_away_total_goals_mean\npredicted_away_5v5_xgf_p60_mean\npredicted_away_powerplay_xgf_p60_mean\npredicted_away_5v5_toi_mean\npredicted_away_powerplay_toi_mean\npredicted_away_shorthanded_toi_mean\n\n\ni64\nstr\nstr\nstr\ni64\ni64\ni64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\n\n\n\n\n2025020817\n\"MIN\"\n\"FLA\"\n\"FLA\"\n461\n536\n3\n0.461\n0.536\n0.003\n2.075311\n0.739172\n2.814484\n2.773\n6.988\n44.898838\n6.308386\n4.402776\n2.113866\n0.868102\n2.981968\n2.826\n11.836\n44.898838\n4.402776\n6.308386\n\n\n2025020814\n\"CBJ\"\n\"TBL\"\n\"TBL\"\n306\n690\n4\n0.306\n0.69\n0.004\n1.906553\n0.669293\n2.575845\n2.45\n9.007\n46.679519\n4.449252\n4.628229\n2.824785\n0.760766\n3.585551\n3.629\n9.881\n46.679519\n4.628229\n4.449252\n\n\n2025020813\n\"OTT\"\n\"CAR\"\n\"CAR\"\n459\n537\n4\n0.459\n0.537\n0.004\n1.976862\n0.557561\n2.534423\n2.65\n5.609\n44.872112\n5.927584\n5.440304\n2.062832\n0.643848\n2.70668\n2.756\n7.065\n44.872112\n5.440304\n5.927584\n\n\n2025020812\n\"BOS\"\n\"MTL\"\n\"MTL\"\n397\n600\n3\n0.397\n0.6\n0.003\n1.894879\n0.762433\n2.657312\n2.557\n8.452\n44.568994\n5.414241\n6.037765\n1.968763\n1.177527\n3.14629\n2.643\n11.672\n44.568994\n6.037765\n5.414241\n\n\n2025020811\n\"NSH\"\n\"UTA\"\n\"UTA\"\n433\n564\n3\n0.433\n0.564\n0.003\n2.00005\n0.517972\n2.518022\n2.606\n6.436\n46.140582\n4.837774\n5.105645\n2.318929\n0.587029\n2.905959\n3.018\n6.945\n46.140582\n5.105645\n4.837774\n\n\n2025020810\n\"NYI\"\n\"BUF\"\n\"BUF\"\n372\n623\n5\n0.372\n0.623\n0.005\n2.113746\n0.624885\n2.738631\n2.711\n8.495\n46.857121\n4.435936\n4.562943\n2.491938\n0.903787\n3.395725\n3.19\n11.983\n46.857121\n4.562943\n4.435936\n\n\n2025020818\n\"EDM\"\n\"WSH\"\n\"EDM\"\n500\n499\n1\n0.5\n0.499\n0.001\n2.303046\n1.020846\n3.323892\n2.984\n12.598\n46.357211\n4.832619\n4.49217\n2.356921\n0.908569\n3.265491\n3.058\n12.179\n46.357211\n4.49217\n4.832619\n\n\n2025020816\n\"STL\"\n\"LAK\"\n\"LAK\"\n378\n613\n9\n0.378\n0.613\n0.009\n1.787255\n0.412386\n2.199641\n2.244\n5.351\n47.567413\n4.592821\n4.259765\n1.969469\n0.647448\n2.616917\n2.494\n9.101\n47.567413\n4.259765\n4.592821\n\n\n2025020815\n\"WPG\"\n\"DET\"\n\"DET\"\n361\n633\n6\n0.361\n0.633\n0.006\n2.177507\n0.577372\n2.754879\n2.81\n8.746\n46.495734\n3.938766\n5.2035\n2.535959\n0.955715\n3.491675\n3.274\n11.014\n46.495734\n5.2035\n3.938766\n\n\n\n\n\n\n\n\nAssessing predictions\nChecking to see if the predictions were correct\n\nassessed_predictions = assess_predictions(predicted_winners, schedule)\n\n\nassessed_predictions\n\n\nshape: (9, 28)\n\n\n\ngame_id\nhome_team\naway_team\npredicted_winner\nactual_winner\nprediction_correct\npredicted_home_win\npredicted_away_win\npredicted_draw\npredicted_home_win_percent\npredicted_away_win_percent\npredicted_draw_percent\npredicted_home_5v5_goals_mean\npredicted_home_powerplay_goals_mean\npredicted_home_total_goals_mean\npredicted_home_5v5_xgf_p60_mean\npredicted_home_powerplay_xgf_p60_mean\npredicted_home_5v5_toi_mean\npredicted_home_powerplay_toi_mean\npredicted_home_shorthanded_toi_mean\npredicted_away_5v5_goals_mean\npredicted_away_powerplay_goals_mean\npredicted_away_total_goals_mean\npredicted_away_5v5_xgf_p60_mean\npredicted_away_powerplay_xgf_p60_mean\npredicted_away_5v5_toi_mean\npredicted_away_powerplay_toi_mean\npredicted_away_shorthanded_toi_mean\n\n\ni64\nstr\nstr\nstr\nstr\ni32\ni64\ni64\ni64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\n\n\n\n\n2025020817\n\"MIN\"\n\"FLA\"\n\"FLA\"\n\"FLA\"\n1\n461\n536\n3\n0.461\n0.536\n0.003\n2.075311\n0.739172\n2.814484\n2.773\n6.988\n44.898838\n6.308386\n4.402776\n2.113866\n0.868102\n2.981968\n2.826\n11.836\n44.898838\n4.402776\n6.308386\n\n\n2025020814\n\"CBJ\"\n\"TBL\"\n\"TBL\"\n\"CBJ\"\n0\n306\n690\n4\n0.306\n0.69\n0.004\n1.906553\n0.669293\n2.575845\n2.45\n9.007\n46.679519\n4.449252\n4.628229\n2.824785\n0.760766\n3.585551\n3.629\n9.881\n46.679519\n4.628229\n4.449252\n\n\n2025020813\n\"OTT\"\n\"CAR\"\n\"CAR\"\n\"CAR\"\n1\n459\n537\n4\n0.459\n0.537\n0.004\n1.976862\n0.557561\n2.534423\n2.65\n5.609\n44.872112\n5.927584\n5.440304\n2.062832\n0.643848\n2.70668\n2.756\n7.065\n44.872112\n5.440304\n5.927584\n\n\n2025020812\n\"BOS\"\n\"MTL\"\n\"MTL\"\n\"BOS\"\n0\n397\n600\n3\n0.397\n0.6\n0.003\n1.894879\n0.762433\n2.657312\n2.557\n8.452\n44.568994\n5.414241\n6.037765\n1.968763\n1.177527\n3.14629\n2.643\n11.672\n44.568994\n6.037765\n5.414241\n\n\n2025020811\n\"NSH\"\n\"UTA\"\n\"UTA\"\n\"UTA\"\n1\n433\n564\n3\n0.433\n0.564\n0.003\n2.00005\n0.517972\n2.518022\n2.606\n6.436\n46.140582\n4.837774\n5.105645\n2.318929\n0.587029\n2.905959\n3.018\n6.945\n46.140582\n5.105645\n4.837774\n\n\n2025020810\n\"NYI\"\n\"BUF\"\n\"BUF\"\n\"BUF\"\n1\n372\n623\n5\n0.372\n0.623\n0.005\n2.113746\n0.624885\n2.738631\n2.711\n8.495\n46.857121\n4.435936\n4.562943\n2.491938\n0.903787\n3.395725\n3.19\n11.983\n46.857121\n4.562943\n4.435936\n\n\n2025020818\n\"EDM\"\n\"WSH\"\n\"EDM\"\n\"EDM\"\n1\n500\n499\n1\n0.5\n0.499\n0.001\n2.303046\n1.020846\n3.323892\n2.984\n12.598\n46.357211\n4.832619\n4.49217\n2.356921\n0.908569\n3.265491\n3.058\n12.179\n46.357211\n4.49217\n4.832619\n\n\n2025020816\n\"STL\"\n\"LAK\"\n\"LAK\"\n\"LAK\"\n1\n378\n613\n9\n0.378\n0.613\n0.009\n1.787255\n0.412386\n2.199641\n2.244\n5.351\n47.567413\n4.592821\n4.259765\n1.969469\n0.647448\n2.616917\n2.494\n9.101\n47.567413\n4.259765\n4.592821\n\n\n2025020815\n\"WPG\"\n\"DET\"\n\"DET\"\n\"DET\"\n1\n361\n633\n6\n0.361\n0.633\n0.006\n2.177507\n0.577372\n2.754879\n2.81\n8.746\n46.495734\n3.938766\n5.2035\n2.535959\n0.955715\n3.491675\n3.274\n11.014\n46.495734\n5.2035\n3.938766"
  },
  {
    "objectID": "blog/posts/tutorials/monte_carlo/index.html#charts",
    "href": "blog/posts/tutorials/monte_carlo/index.html#charts",
    "title": "Simulating today’s hockey games",
    "section": "Charts",
    "text": "Charts\nPlotting the results of your simulations\n\nColor dictionary\nTaking the NHL colors and making a dictionary out of them\n\ncolor_dict = {\n    key: (value[\"GOAL\"] if value[\"GOAL\"] != \"#FFFFFF\" else value[\"SHOT\"]) for key, value in NHL_COLORS.items()\n}\n\n\n\nPlotting a single game\nPlotting the results for a single game\n\ndpi = 650\nfigsize = (8, 5)\nnrows = 1  # len(assessed_predictions[\"home_team\"].to_list())\nncols = 1\n\nfig, ax = plt.subplots(nrows=nrows, ncols=ncols, figsize=figsize, dpi=dpi, sharex=True, sharey=True)\n\nfor idx, game in enumerate(\n    assessed_predictions.filter((pl.col(\"away_team\") == \"NSH\") | (pl.col(\"home_team\") == \"NSH\"))\n    .sort(\"predicted_away_total_goals_mean\")\n    .to_dicts()\n):\n    # ax = axs[idx]\n\n    plot_predictions = predictions.filter(pl.col(\"game_id\") == game[\"game_id\"])\n\n    venues = [\"away\", \"home\"]\n\n    for venue in venues:\n        sns.kdeplot(\n            data=plot_predictions,\n            x=plot_predictions[f\"predicted_{venue}_total_goals\"],\n            bw_adjust=0.5,\n            clip_on=False,\n            fill=True,\n            alpha=0.1,\n            linewidth=1.5,\n            hue=plot_predictions[f\"{venue}_team\"],\n            palette=color_dict,\n            legend=False,\n            ax=ax,\n        )\n\n    sns.despine(left=True)\n\n    ax.set(yticks=[], ylabel=\"\", xlabel=\"predicted total goals\")\n\n    if idx != (nrows - 1):\n        ax.set(xticks=[])\n\n    # else:\n    #     ax.set(xlabel=\"predicted total goals\")\n\n    ax.set_title(f\"{game['home_team']} vs. {game['away_team']}\")\n\nfig.savefig(f\"./charts/{latest_date}_NSH.png\", dpi=650, bbox_inches=\"tight\", facecolor=\"white\")\n\n\n\n\n\n\n\n\n\n\nPlotting today’s games\nPlotting the predicted goals for all of today’s games\n\ndpi = 500\nfigsize = (4, 12)\nnrows = len(assessed_predictions[\"home_team\"].to_list())\nncols = 1\n\nfig, axs = plt.subplots(nrows=nrows, ncols=ncols, figsize=figsize, dpi=dpi, sharex=True, sharey=True)\n\nfor idx, game in enumerate(assessed_predictions.sort(\"predicted_home_total_goals_mean\").to_dicts()):\n    ax = axs[idx]\n\n    plot_predictions = predictions.filter(pl.col(\"game_id\") == game[\"game_id\"])\n\n    venues = [\"away\", \"home\"]\n\n    for venue in venues:\n        sns.kdeplot(\n            data=plot_predictions,\n            x=plot_predictions[f\"predicted_{venue}_total_goals\"],\n            bw_adjust=0.5,\n            clip_on=False,\n            fill=True,\n            alpha=0.1,\n            linewidth=1.5,\n            hue=plot_predictions[f\"{venue}_team\"],\n            palette=color_dict,\n            legend=False,\n            ax=ax,\n        )\n\n    sns.despine(left=True)\n\n    ax.set(yticks=[], ylabel=\"\")\n\n    if idx != (nrows - 1):\n        ax.set(xticks=[])\n\n    # else:\n    #     ax.set(xlabel=\"predicted total goals\")\n\n    ax.set_title(f\"{game['home_team']} vs. {game['away_team']}\", y=0.8)\n\nfig.savefig(f\"./charts/{latest_date}.png\", dpi=650, bbox_inches=\"tight\", facecolor=\"white\")"
  },
  {
    "objectID": "blog/posts/tutorials/monte_carlo/index.html#assessing-predictions-1",
    "href": "blog/posts/tutorials/monte_carlo/index.html#assessing-predictions-1",
    "title": "Simulating today’s hockey games",
    "section": "Assessing predictions",
    "text": "Assessing predictions\nSeeing how the season long predictions have been playing\n\nDownloading the data from GitHub\nDownloading the data from the chickenstats repository on GitHub\n\ncsv_url = \"https://raw.githubusercontent.com/chickenandstats/chickenstats-blog/refs/heads/main/nbs/blog/posts/tutorials/monte_carlo/results/predicted_winners.csv\"\n\nseason_predictions = pl.read_csv(csv_url)\n\n\nseason_predictions.head(10)\n\n\nshape: (10, 28)\n\n\n\ngame_id\nhome_team\naway_team\npredicted_winner\nactual_winner\nprediction_correct\npredicted_home_win\npredicted_away_win\npredicted_draw\npredicted_home_win_percent\npredicted_away_win_percent\npredicted_draw_percent\npredicted_home_5v5_goals_mean\npredicted_home_powerplay_goals_mean\npredicted_home_total_goals_mean\npredicted_home_5v5_xgf_p60_mean\npredicted_home_powerplay_xgf_p60_mean\npredicted_home_5v5_toi_mean\npredicted_home_powerplay_toi_mean\npredicted_home_shorthanded_toi_mean\npredicted_away_5v5_goals_mean\npredicted_away_powerplay_goals_mean\npredicted_away_total_goals_mean\npredicted_away_5v5_xgf_p60_mean\npredicted_away_powerplay_xgf_p60_mean\npredicted_away_5v5_toi_mean\npredicted_away_powerplay_toi_mean\npredicted_away_shorthanded_toi_mean\n\n\ni64\nstr\nstr\nstr\nstr\ni64\ni64\ni64\ni64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\nf64\n\n\n\n\n2025020695\n\"WPG\"\n\"LAK\"\n\"LAK\"\n\"WPG\"\n0\n4060\n5892\n48\n0.406\n0.5892\n0.0048\n1.956666\n0.641295\n2.597961\n2.5485\n7.1324\n46.105153\n5.400488\n4.396158\n2.202071\n0.824131\n3.026202\n2.8657\n11.2256\n46.105153\n4.396158\n5.400488\n\n\n2025020530\n\"DET\"\n\"UTA\"\n\"UTA\"\n\"UTA\"\n1\n4511\n5435\n54\n0.4511\n0.5435\n0.0054\n2.187779\n0.527668\n2.715447\n2.7515\n6.9293\n47.688887\n4.564279\n3.723834\n2.512217\n0.435366\n2.947583\n3.1607\n7.008\n47.688887\n3.723834\n4.564279\n\n\n2025020148\n\"PIT\"\n\"STL\"\n\"STL\"\n\"PIT\"\n0\n2056\n7903\n41\n0.2056\n0.7903\n0.0041\n1.962572\n1.252185\n3.214757\n2.782\n9.6232\n42.352182\n7.806185\n6.377632\n3.922311\n1.086998\n5.00931\n5.5547\n10.2336\n42.352182\n6.377632\n7.806185\n\n\n2025020593\n\"CAR\"\n\"DET\"\n\"DET\"\n\"CAR\"\n0\n4917\n5037\n46\n0.4917\n0.5037\n0.0046\n2.486878\n0.699148\n3.186026\n3.1919\n9.9487\n46.735572\n4.217244\n4.457284\n2.362811\n0.840152\n3.202963\n3.0351\n11.309\n46.735572\n4.457284\n4.217244\n\n\n2025020427\n\"OTT\"\n\"NYR\"\n\"NYR\"\n\"NYR\"\n1\n3814\n6144\n42\n0.3814\n0.6144\n0.0042\n1.583031\n0.48285\n2.065881\n1.9963\n6.3484\n47.649183\n4.570142\n3.926674\n1.909994\n0.669286\n2.57928\n2.4068\n10.228\n47.649183\n3.926674\n4.570142\n\n\n2025020712\n\"BOS\"\n\"PIT\"\n\"PIT\"\n\"BOS\"\n0\n3955\n5997\n48\n0.3955\n0.5997\n0.0048\n2.251294\n0.423561\n2.674854\n2.82\n5.8083\n47.907743\n4.377982\n3.811276\n2.579232\n0.621881\n3.201113\n3.2312\n9.8068\n47.907743\n3.811276\n4.377982\n\n\n2025020329\n\"ANA\"\n\"OTT\"\n\"OTT\"\n\"OTT\"\n1\n3673\n6274\n53\n0.3673\n0.6274\n0.0053\n1.782043\n0.533371\n2.315414\n2.3281\n8.1117\n45.880385\n3.939515\n5.5705\n2.322641\n0.583617\n2.906258\n3.0382\n6.2758\n45.880385\n5.5705\n3.939515\n\n\n2025020478\n\"UTA\"\n\"FLA\"\n\"UTA\"\n\"FLA\"\n0\n5255\n4681\n64\n0.5255\n0.4681\n0.0064\n2.160342\n0.722947\n2.883289\n3.0104\n7.2158\n43.032919\n5.999608\n6.071273\n1.920013\n0.8197\n2.739713\n2.6752\n8.1008\n43.032919\n6.071273\n5.999608\n\n\n2025020665\n\"CGY\"\n\"SEA\"\n\"CGY\"\n\"SEA\"\n0\n6768\n3177\n55\n0.6768\n0.3177\n0.0055\n2.404052\n0.712321\n3.116374\n3.0099\n9.7929\n47.894337\n4.372837\n3.531827\n1.704213\n0.540618\n2.244831\n2.1322\n9.1522\n47.894337\n3.531827\n4.372837\n\n\n2025020319\n\"TOR\"\n\"CBJ\"\n\"CBJ\"\n\"CBJ\"\n1\n2905\n7062\n33\n0.2905\n0.7062\n0.0033\n1.959842\n0.663825\n2.623667\n2.431\n10.4463\n48.388112\n3.816683\n3.615505\n2.558635\n1.188494\n3.747129\n3.1704\n19.7096\n48.388112\n3.615505\n3.816683"
  },
  {
    "objectID": "blog/posts/tutorials/monte_carlo/index.html#checking-the-results",
    "href": "blog/posts/tutorials/monte_carlo/index.html#checking-the-results",
    "title": "Simulating today’s hockey games",
    "section": "Checking the results",
    "text": "Checking the results\nLet’s see how the simulation does\n\nseason_predictions.select(\n    pl.col(\"prediction_correct\").sum().alias(\"correct_predictions\"),\n    pl.col(\"game_id\").n_unique().alias(\"total games\"),\n    (pl.col(\"prediction_correct\").sum() / pl.col(\"game_id\").n_unique()).alias(\"correct_prediction_percent\"),\n)\n\n# Kind of meh, TBH\n\n\nshape: (1, 3)\n\n\n\ncorrect_predictions\ntotal games\ncorrect_prediction_percent\n\n\ni64\nu32\nf64\n\n\n\n\n414\n796\n0.520101"
  }
]